---
ID: 76
post_title: 'RAP et les Jobs &#8211; Part 1'
author: lbertholet
post_date: 2010-01-26 15:00:00
post_excerpt: |
  <p>Le développement d'une application RAP (Rich Ajax Platform) se fait via les mêmes API que celles d'une application RCP (Rich Client Platform). Cependant derrière les signatures des méthodes se cachent des implémentations totalement différentes. Nous allons regarder dans ce billet les pièges à éviter lors de l'utilisation des Jobs dans RAP. D'autres <a href="/index.php?tag/rap">articles</a> sur cette technologie sont disponibles sur le <a href="/index.php?tag/rap">blog</a>.</p>
layout: post
permalink: http://blog.zenika-offres.com/?p=76
published: true
---
<p>Le développement d'une application RAP (Rich Ajax Platform) se fait via les mêmes API que celles d'une application RCP (Rich Client Platform). Cependant derrière les signatures des méthodes se cachent des implémentations totalement différentes. Nous allons regarder dans ce billet les pièges à éviter lors de l'utilisation des Jobs dans RAP. D'autres <a href="/index.php?tag/rap">articles</a> sur cette technologie sont disponibles sur le <a href="/index.php?tag/rap">blog</a>.</p>
<!--more-->
<p>Un job permet de décrire un bloc de code dont l'exécution peut être programmée dans un thread séparé.</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">final</span> Job job = <span style="color: #7F0055; font-weight: bold;">new</span> Job<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Mon Job&quot;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">  <span style="color: #7F0055; font-weight: bold;">protected</span> IStatus run<span style="color: #000000;">&#40;</span>IProgressMonitor monitor<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #808080; font-style: italic;">// code à exécuter</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #7F0055; font-weight: bold;">return</span> Status.<span style="color: #000000;">OK_STATUS</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">  <span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #808080; font-style: italic;">// priorité (par défaut Job.LONG)</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">job.<span style="color: #000000;">setPriority</span><span style="color: #000000;">&#40;</span>Job.<span style="color: #000000;">SHORT</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #808080; font-style: italic;">// lancement dès que possible</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">job.<span style="color: #000000;">schedule</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li></ol></pre> <p>Il est possible de lui ajouter des listeners qui seront notifiés lors de différents évènements comme, par exemple, la fin de son exécution. Ici, l'exécution du job est simplement programmé à nouveau.</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">job.<span style="color: #000000;">addJobChangeListener</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">new</span> JobChangeAdapter<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">  <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> done<span style="color: #000000;">&#40;</span>IJobChangeEvent event<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #7F0055;font-weight: bold;">if</span> <span style="color: #000000;">&#40;</span>event.<span style="color: #000000;">getResult</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">isOK</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>  <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">      <span style="color: #808080; font-style: italic;">// le job s'est terminé normalement</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">      job.<span style="color: #000000;">schedule</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">6000</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #000000;">&#125;</span> <span style="color: #7F0055;font-weight: bold;">else</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">      <span style="color: #808080; font-style: italic;">// un problème est survenu</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">  <span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span><span style="color: #000000;">&#41;</span>;</div></li></ol></pre> <p>En interne RAP gère le cycle de vie des Jobs d'une manière différente de RCP. En effet RAP utilise un singleton de JobManagerAdapter permettant, entre autres, de gérer les aspects propres aux sessions des utilisateurs. Pour cela, chaque job est stocké lors de son lancement dans une liste, variable de cette classe. Le singleton restant en mémoire tout au long du cycle de vie de l'application, il est très important de vérifier que cette référence disparaisse au moment opportun. Or lorsqu'un job est terminé, son retrait de cette liste n'est pas automatique&nbsp;; il dépend de sa propre implémentation.</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> done<span style="color: #000000;">&#40;</span> <span style="color: #7F0055; font-weight: bold;">final</span> IJobChangeEvent event <span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #7F0055; font-weight: bold;">final</span> ProgressManager<sp
an style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> manager = <span style="color: #7F0055; font-weight: bold;">new</span> ProgressManager<span style="color: #000000;">&#91;</span> <span style="color: #cc66cc;">1</span> <span style="color: #000000;">&#93;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    Display display = <span style="color: #7F0055; font-weight: bold;">null</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #7F0055; font-weight: bold;">synchronized</span><span style="color: #000000;">&#40;</span> lock <span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">      <span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        manager<span style="color: #000000;">&#91;</span> 0 <span style="color: #000000;">&#93;</span> = findProgressManager<span style="color: #000000;">&#40;</span> event.<span style="color: #000000;">getJob</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        display = <span style="color: #000000;">&#40;</span> Display <span style="color: #000000;">&#41;</span>jobs.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span> event.<span style="color: #000000;">getJob</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        <span style="color: #7F0055;font-weight: bold;">if</span><span style="color: #000000;">&#40;</span> display <span style="color: #000000;">!</span>= <span style="color: #7F0055; font-weight: bold;">null</span> <span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">          display.<span style="color: #000000;">asyncExec</span><span style="color: #000000;">&#40;</span> <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">Runnable</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">            <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> run<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">              Job job = event.<span style="color: #000000;">getJob</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">              <span style="color: #000000;">String</span> id = <span style="color: #000000;">String</span>.<span style="color: #000000;">valueOf</span><span style="color: #000000;">&#40;</span> job.<span style="color: #000000;">hashCode</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">              UICallBack.<span style="color: #000000;">deactivate</span><span style="color: #000000;">&#40;</span> id <span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">            <span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">          <span style="color: #000000;">&#125;</span> <span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        <span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">      <span style="color: #000000;">&#125;</span> <span style="color: #7F0055; font-weight: bold;">finally</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        Job job = event.<span style="color: #000000;">getJob</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        <span style="color: #7F0055;font-weight: bold;">if</span><span style="color: #000000;">&#40;</span> <span style="color: #000000;">!</span>job.<span style="color: #000000;">shouldSchedule</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">          jobs.<span style="color: #000000;">remove</span><span style="color: #000000;">&#40;</span> job <span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        <span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">      <span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #7F0055;font-weight: bold;">if</span><span style="color: #000000;">&#40;</span> display <span style="color: #000000;">!</span>= <span style="color: #7F0055; font-weight: bold;">null</span> <span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: norm
al; margin:0; padding:0; background:inherit;">      display.<span style="color: #000000;">asyncExec</span><span style="color: #000000;">&#40;</span> <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">Runnable</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> run<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">          manager<span style="color: #000000;">&#91;</span> 0 <span style="color: #000000;">&#93;</span>.<span style="color: #000000;">changeListener</span>.<span style="color: #000000;">done</span><span style="color: #000000;">&#40;</span> event <span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        <span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">      <span style="color: #000000;">&#125;</span> <span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">  <span style="color: #000000;">&#125;</span></div></li></ol></pre> <p>Comme vous pouvez le constater, le Job est retiré si et seulement si il n'est plus programmable, c'est à dire si la méthode shouldSchedule() répond faux. Or par défaut, son implémentation retourne systématiquement vrai. Pour un Job à exécution unique, il est alors important de bien penser à redéfinir cette méthode afin d'éviter les fuites mémoires. Par exemple en créant sa propre sous classe de Job redéfinissant les méthodes suivantes&nbsp;:</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">boolean</span> shouldSchedule;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">&nbsp;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    @Override</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #7F0055; font-weight: bold;">protected</span> <span style="color: #7F0055; font-weight: bold;">final</span> IStatus run<span style="color: #000000;">&#40;</span>IProgressMonitor monitor<span style="color: #000000;">&#41;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        shouldSchedule = <span style="color: #7F0055; font-weight: bold;">false</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        <span style="color: #7F0055; font-weight: bold;">return</span> doRun<span style="color: #000000;">&#40;</span>monitor<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">&nbsp;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #808080; font-style: italic;">/**</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #808080; font-style: italic;">&nbsp;    * Do the run action.</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #808080; font-style: italic;">&nbsp;    */</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #7F0055; font-weight: bold;">protected</span> <span style="color: #7F0055; font-weight: bold;">abstract</span> IStatus doRun<span style="color: #000000;">&#40;</span>IProgressMonitor monitor<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">&nbsp;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    @Override</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">boolean</span> shouldSchedule<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        <span style="color: #7F0055; font-weight: bold;">return</span> shouldSchedule;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #000000;">&#125;</span></div></li></ol></pre> <p>Pour un Job re-programmable, il peut également s'avérer très pertinent de mettre en place un système similaire afin d'optimiser la gestion de la mémoire de votre application. Ceci est plus particulièrement vrai pour une application devant supporter un grand nombre d'utilisateurs. Pour cela il suffit de continuer à utiliser la sous classe redéfinit précédemment et de lui ajouter les méthodes suivantes&nbsp;:</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">public</span> <sp
an style="color: #7F0055; font-weight: bold;">void</span> scheduleAgain<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        shouldSchedule = <span style="color: #7F0055; font-weight: bold;">true</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        schedule<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">&nbsp;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> scheduleAgain<span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">long</span> delay<span style="color: #000000;">&#41;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        shouldSchedule = <span style="color: #7F0055; font-weight: bold;">true</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        schedule<span style="color: #000000;">&#40;</span>delay<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">    <span style="color: #000000;">&#125;</span></div></li></ol></pre> <p>Il convient d'appeler ces méthodes scheduleAgain() ou scheduleAgain(long delay) en lieu et place de schedule() et schedule(long delay) sinon le Job ne s'exécutera pas la seconde fois.</p> <p>Pour terminer, l'équipe RAP a considéré ce comportement comme une anomalie qui sera résolue en version 1.3 prévue pour l'été 2010.</p>