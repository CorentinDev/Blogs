---
ID: 442
post_title: 'NFC III &#8211; Ecrire sur un Tag sur Android'
author: Guillaume Gerbaud
post_date: 2012-04-03 08:56:00
post_excerpt: |
  <p>Le troisième billet de cette série sera l'occasion de détailler l'écriture d'un Tag <a href="/index.php?tag/nfc">NFC</a> sur Android. Comme pour le billet précédent, mes propos seront illustrés grâce à l'application Zen Wifi NFC. Pour rappel, l'application Zen Wifi NFC permet de connecter automatiquement un appareil Android compatible NFC à un réseau Wifi, lors de la lecture d'un Tag spécifique. Les exemples de cet article concerneront donc l'écriture de notre Tag Wifi.</p>
layout: post
permalink: http://blog.zenika-offres.com/?p=442
published: true
slide_template:
  - ""
---
<p>Le troisième billet de cette série sera l'occasion de détailler l'écriture d'un Tag <a href="/index.php?tag/nfc">NFC</a> sur Android. Comme pour le billet précédent, mes propos seront illustrés grâce à l'application Zen Wifi NFC. Pour rappel, l'application Zen Wifi NFC permet de connecter automatiquement un appareil Android compatible NFC à un réseau Wifi, lors de la lecture d'un Tag spécifique. Les exemples de cet article concerneront donc l'écriture de notre Tag Wifi.</p>
<!--more-->
<h3>Tag Dispatch</h3> <p><br />
À l'instar de la lecture, l'écriture d'un Tag nécessite au préalable la détection de celui-ci. Dans <a href="/index.php?post/2012/03/20/NFC-Lecture-d-un-Tag-sur-Android">l'article précédent</a>, j'ai détaillé le mécanisme d'Android de dispatch par Intent, des Tag détectés, ainsi que le foreground dispatch, permettant de court-circuiter le précédent. <br /></p> <p>Bien que ce ne soit pas une obligation, dans 99% des cas d'usage, on utilisera le foreground dispatch pour l'écriture d'un Tag.</p> <h4>Zen Wifi NFC</h4> <p>Le Tag doit, bien sûr, supporter la technologie Ndef, c'est ce qu'on indique dans notre filtre. Par contre, nous ne filtrons pas sur le type de données ici, car peu importe les données présentes sur le Tag, nous allons les réécrire.<br />
De même, nous filtrons les Intent avec l'action <code>TECH_DISCOVERED</code> car il n'est pas nécessaire que le Tag contienne un message Ndef.<br />
<br /></p> <pre class="java code java" style="font-family:inherit">@Override <span style="color: #7F0055; font-weight: bold;">protected</span> <span style="color: #7F0055; font-weight: bold;">void</span> onResume<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	<span style="color: #7F0055; font-weight: bold;">super</span>.<span style="color: #000000;">onResume</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	PendingIntent pendingIntent = PendingIntent.<span style="color: #000000;">getActivity</span><span style="color: #000000;">&#40;</span>getApplicationContext<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, 0, 			<span style="color: #7F0055; font-weight: bold;">new</span> Intent<span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">this</span>, getClass<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">addFlags</span><span style="color: #000000;">&#40;</span>Intent.<span style="color: #000000;">FLAG_ACTIVITY_SINGLE_TOP</span><span style="color: #000000;">&#41;</span>, 0<span style="color: #000000;">&#41;</span>; &nbsp; 	IntentFilter ndef = <span style="color: #7F0055; font-weight: bold;">new</span> IntentFilter<span style="color: #000000;">&#40;</span>NfcAdapter.<span style="color: #000000;">ACTION_TECH_DISCOVERED</span><span style="color: #000000;">&#41;</span>; 	IntentFilter<span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> intentFiltersArray = <span style="color: #7F0055; font-weight: bold;">new</span> IntentFilter<span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> <span style="color: #000000;">&#123;</span>ndef<span style="color: #000000;">&#125;</span>; &nbsp; 	<span style="color: #000000;">String</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> techListsArray = <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">String</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> <span style="color: #000000;">&#123;</span><span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">String</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> <span style="color: #000000;">&#123;</span>Ndef.<span style="color: #7F0055; font-weight: bold;">class</span>.<span style="color: #000000;">getName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#125;</span><span style="color: #000000;">&#125;</span>; &nbsp; 	mNfcAdapter.<span style="color: #000000;">enableForegroundDispatch</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">this</span>, pendingIntent, intentFiltersArray, techListsArray<span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span></pre> <blockquote><p>NB&nbsp;: Notre application filtre les Tag qui supportent la technologie Ndef, ce qui signifie que les Tag sont formatés au format Ndef, mais ne détectera pas les Tag qui peuvent être formatés au format Ndef (mais qui, donc, ne le sont pas encore). Ces derniers indiquent supporter la technologie <a href="http://developer.android.com/reference/android/nfc/tech/NdefFormatable.html">NdefFormatable</a>. Il est tout à fait possible de formater le Tag avec Android mais <a href="http://code.google.com/p/android/issues/detail?id=22258">une anomalie</a> affecte certaines version d'ICS. En effet, sur ICS 4.0.2 (qui équipe actuellement les Galaxy Nexus) les Tags non formatés n'indiquent plus être NdefFormatable. Ce bug est corrigé sur ICS 4.0.3 (qui équipe actuellement la plupart des Nexus S). Pour simplifier, ici, on n'écrit que sur des Tags déjà formatés Ndef.</p></blockquote> <h2>Écriture du Tag</h2> <p><br />
Puisqu'on utilise le foreground dispatch et qu'on a demandé à Android de ne pas redémarrer l'Activity (flag <code>ACTIVITY_SINGLE_TOP</code>), une fois le Tag détecté, c'est la méthode <code>onNewIntent</code> qui est appelée. l'Intent en paramètre de cette méthode possède un extra <code>EXTRA_TAG</code> qui permet d'obtenir un objet <code>Tag</code>.<br />
<br /></p> <pre class="java code java" style="font-family:inherit">@Override <span style="color: #7F0055; font-weight: bold;">protected</span> <span style="color: #7F0055; font-weight: bold;">void</span> onNewIntent<span style="color: #000000;">&#40;</span>Intent intent<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	Tag tag = intent.<span style="color: #000000;">getParcelableExtra</span><span style="color: #000000;">&#40;</span>NfcAdapter.<span style="color: #000000;">EXTRA_TAG</span><span style="color: #000000;">&#41;</span>; 	<span style="color: #000000;">&#91;</span>...<span style="color: #000000;">&#93;</span> <span style="color: #000000;">&#125;</span></pre> <p>Pour pouvoir effectuer des I/O, nous devons obtenir une instance d'une implémentation de <code>TagTechnology</code>, qui sont les technologies qu'un Tag peut supporter (voir le package <a href="http://developer.android.com/reference/android/nfc/tech/package-summary.html">android.nfc.tech</a>). Chaque classe d'implémentation possède une méthode statique <code>get</code> qui prend un <code>Tag</code> en paramètre et qui renvoie une instance de cette classe d'implémentation si, et seulement si, la technologie est supportée par le Tag.</p> <h4>Zen Wifi NFC</h4> <p>Pour notre Tag Wifi, nous souhaitons donc utiliser la technologie Ndef. Cette classe possède une méthode <code>writeNdefMessage</code>, qui prend en paramètre un <code>NdefMessage</code>. Avant de pouvoir écrire le message, nous devons nous y connecter grâce à la méthode <code>connect</code>. De même, après l'écriture, nous appelons la méthode <code>close</code>.<br />
Ces 3 méthodes <ins>ne doivent pas</ins> être appelées depuis le Thread de l'UI. <br /></p> <pre class="java code java" style="font-family:inherit">@Override <span style="color: #7F0055; font-weight: bold;">protected</span> <span style="color: #7F0055; font-weight: bold;">void</span> onNewIntent<span style="color: #000000;">&#40;</span>Intent intent<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	Tag tag = intent.<span style="color: #000000;">getParcelableExtra</span><span style="color: #000000;">&#40;</span>NfcAdapter.<span style="color: #000000;">EXTRA_TAG</span><span style="color: #000000;">&#41;</span>; 	<span style="color: #7F0055; font-weight: bold;">final</span> Ndef ndef = Ndef.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span>tag<span style="color: #000000;">&#41;</span>; 	<span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">Thread</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">Runnable</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> &nbsp; 		@Override 		<span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> run<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 			<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span> 				ndef.<span style="color: #000000;">connect</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 				<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span> 					ndef.<span style="color: #000000;">writeNdefMessage</span><span style="color: #000000;">&#40;</span>getMessage<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 				<span style="color: #000000;">&#125;</span> 				<span style="color: #7F0055; font-weight: bold;">catch</span><span style="color: #000000;">&#40;</span>FormatException e<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 					Log.<span style="color: #000000;">e</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;NFC&quot;</span>, e.<span style="color: #000000;">getMessage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, e<span style="color: #000000;">&#41;</span>; 				<span style="color: #000000;">&#125;</span> 				ndef.<span style="color: #000000;">close</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 			<span style="color: #000000;">&#125;</span> 			<span style="color: #7F0055; font-weight: bold;">catch</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">IOException</span> e<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 				Log.<span style="color: #000000;">e</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;NFC&quot;</span>, e.<span style="color: #000000;">getMessage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, e<span style="color: #000000;">&#41;</span>; 			<span style="color: #000000;">&#125;</span> 		<span style="color: #000000;">&#125;</span> 	<span style="color: #000000;">&#125;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">start</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span></pre> <h3>Message Ndef</h3> <p><br />
Comme vu dans les articles précédents, un message Ndef est constitué de un ou plusieurs enregistrements. Sur Android, les messages Ndef sont représentés par la classe <code>NdefMessage</code> et les enregistrements par la classe <code>NdefRecord</code>, ainsi, naturellement, le constructeur de la classe <code>NdefMessage</code> utilise un tableau de <code>NdefRecord</code>.<br /></p> <p>Le constructeur de <code>NdefRecord</code> prend 4 paramètres&nbsp;: le TNF (Type Name Format), le type de la donnée, l'id de l'enregistrement et le payload. Les 3 derniers paramètres sont des tableaux de <code>byte</code>.<br />
L'étude des différents TNF définis par le NFC Forum sera l'objet d'un article à part entière.</p> <h4>Zen Wifi NFC</h4> <p>Pour notre Tag Wifi, nous utiliserons le TNF EXTERNAL TYPE, car nous utilisons notre propre type. Nous construisons le NdefRecord ainsi: <br /></p> <pre class="java code java" style="font-family:inherit"><span style="color: #7F0055; font-weight: bold;">private</span> NdefMessage getMessage<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> FormatException <span style="color: #000000;">&#123;</span> 	<span style="color: #000000;">&#91;</span>...<span style="color: #000000;">&#93;</span> 	NdefRecord record = <span style="color: #7F0055; font-weight: bold;">new</span> NdefRecord<span style="color: #000000;">&#40;</span>NdefRecord.<span style="color: #000000;">TNF_EXTERNAL_TYPE</span>, 							<span style="color: #888888;">&quot;zenika.com:zenwifi&quot;</span>.<span style="color: #000000;">getBytes</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #7F0055; font-weight: bold;">byte</span><span style="color: #000000;">&#91;</span>0<span style="color: #000000;">&#93;</span>, payload<span style="color: #000000;">&#41;</span>; &nbsp; 	NdefRecord<span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> records = <span style="color: #000000;">&#123;</span>record<span style="color: #000000;">&#125;</span>; 	NdefMessage msg = <span style="color: #7F0055; font-weight: bold;">new</span> NdefMessage<span style="color: #000000;">&#40;</span>records<span style="color: #000000;">&#41;</span>; 	<span style="color: #7F0055; font-weight: bold;">return</span> msg; <span style="color: #000000;">&#125;</span></pre> <p>Pour la construction du payload, on récupère le ssid et la passkey depuis 2 <code>EditText</code>. On ajoute les doubles quotes si nécessaire, puis on concatène et on récupère les octets. <br /></p> <pre class="java code java" style="font-family:inherit"><span style="color: #7F0055; font-weight: bold;">private</span> NdefMessage getMessage<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> FormatException <span style="color: #000000;">&#123;</span> 	StringBuilder payloadBuilder = <span style="color: #7F0055; font-weight: bold;">new</span> StringBuilder<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #000000;">String</span> ssid = mSSID.<span style="color: #000000;">getText</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">toString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	<span style="color: #7F0055;font-weight: bold;">if</span><span style="color: #000000;">&#40;</span>TextUtils.<span style="color: #000000;">isEmpty</span><span style="color: #000000;">&#40;</span>ssid<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throw</span> <span style="color: #7F0055; font-weight: bold;">new</span> FormatException<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;SSID is empty&quot;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #7F0055;font-weight: bold;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">!</span>ssid.<span style="color: #000000;">startsWith</span><span style="color: #000000;">&#40;</span>DOUBLE_QUOTE<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> payloadBuilder.<span style="color: #000000;">append</span><span style="color: #000000;">&#40;</span>DOUBLE_QUOTE<span style="color: #000000;">&#41;</span>; 	payloadBuilder.<span style="color: #000000;">append</span><span style="color: #000000;">&#40;</span>ssid<span style="color: #000000;">&#41;</span>; 	<span style="color: #7F0055;font-weight: bold;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">!</span>ssid.<span style="color: #000000;">endsWith</span><span style="color: #000000;">&#40;</span>DOUBLE_QUOTE<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> payloadBuilder.<span style="color: #000000;">append</span><span style="color: #000000;">&#40;</span>DOUBLE_QUOTE<span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #7F0055;font-weight: bold;">if</span><span style="color: #000000;">&#40;</span>payloadBuilder.<span style="color: #000000;">length</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&lt;</span>= <span style="color: #cc66cc;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throw</span> <span style="color: #7F0055; font-weight: bold;">new</span> FormatException<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;SSID is empty&quot;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #7F0055; font-weight: bold;">int</span> ssidSize = payloadBuilder.<span style="color: #000000;">length</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #000000;">String</span> pwd = mPSK.<span style="color: #000000;">getText</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">toString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	<span style="color: #7F0055;font-weight: bold;">if</span><span style="color: #000000;">&#40;</span>TextUtils.<span style="color: #000000;">isEmpty</span><span style="color: #000000;">&#40;</span>pwd<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throw</span> <span style="color: #7F0055; font-weight: bold;">new</span> FormatException<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Password is empty&quot;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #7F0055;font-weight: bold;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">!</span>pwd.<span style="color: #000000;">startsWith</span><span style="color: #000000;">&#40;</span>DOUBLE_QUOTE<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> payloadBuilder.<span style="color: #000000;">append</span><span style="color: #000000;">&#40;</span>DOUBLE_QUOTE<span style="color: #000000;">&#41;</span>; 	payloadBuilder.<span style="color: #000000;">append</span><span style="color: #000000;">&#40;</span>pwd<span style="color: #000000;">&#41;</span>; 	<span style="color: #7F0055;font-weight: bold;">if</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">!</span>pwd.<span style="color: #000000;">endsWith</span><span style="color: #000000;">&#40;</span>DOUBLE_QUOTE<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> payloadBuilder.<span style="color: #000000;">append</span><span style="color: #000000;">&#40;</span>DOUBLE_QUOTE<span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #7F0055;font-weight: bold;">if</span><span style="color: #000000;">&#40;</span>payloadBuilder.<span style="color: #000000;">length</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&lt;</span>= ssidSize + <span style="color: #cc66cc;">2</span><span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throw</span> <span style="color: #7F0055; font-weight: bold;">new</span> FormatException<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Password is empty&quot;</span><span
style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #7F0055; font-weight: bold;">byte</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> payload = payloadBuilder.<span style="color: #000000;">toString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">getBytes</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #000000;">&#91;</span>...<span style="color: #000000;">&#93;</span> 	<span style="color: #7F0055; font-weight: bold;">return</span> msg; <span style="color: #000000;">&#125;</span></pre> <h3>Android Application Record</h3> <p><br />
Nous pouvons désormais écrire sur un Tag nos identifiants de la box Wifi. L'application Zen Wifi NFC sera alors lancée dès qu'on scannera le Tag... à condition qu'elle soit installée sur l'appareil de l'utilisateur. En effet, si l'application n'est pas installée, rien ne se passera, ou alors une application générique qui lit tous les Tag sera lancée.<br /></p> <p>Il existe un moyen de contourner ce problème en ajoutant dans notre message un enregistrement qui indique précisément à Android quelle est l'application qui doit recevoir ce message. Android va alors tenter d'ouvrir ladite application, et si elle n'est pas installée, il lancera <del>l'Android Market</del> le Google Play Store pour que l'utilisateur installe l'application adéquate (à condition qu'elle soit publiée sur le Play Store).</p> <p>Cet enregistrement spécifique s'appelle un AAR (pour Android Application Record), et s'obtient de la manière suivante: <br /></p> <pre class="java code java" style="font-family:inherit">NdefRecord aar = NdefRecord.<span style="color: #000000;">createApplicationRecord</span><span style="color: #000000;">&#40;</span>context.<span style="color: #000000;">getPackageName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</pre> <p>Certains d'entre vous sont peut-être en train de se demander à quoi sert notre <code>intent-filter</code> mis en place dans l'article précédent dans le cas où on utilise un AAR&nbsp;? Le détail important est qu'un AAR identifie une application (en utilisant son nom de package, qui est son identifiant) alors qu'un <code>intent-filter</code> se place sur un composant (une Activity, ici). En effet, avec seulement un AAR, Android va lancer l'application par son point d'entrée (filtre <code>ACTION_MAIN</code> / <code>CATEGORY_LAUNCHER</code>), ce n'est pas nécessairement le composant chargé de lire le Tag.</p> <h3>Conclusion</h3> <p><br />
L'écriture sur un Tag sur Android se fait de manière similaire à la lecture, en 2 étapes&nbsp;: la gestion du dispatch et l'envoi du message. Le dispatch est, cependant, légèrement différend puisqu'on filtrera plus large (pas de restriction sur le type de la donnée contenue dans le tag le cas échéant), et on utilisera essentiellement le foreground dispatch.<br /></p> <p>Dans un prochain billet, nous étudierons les possibilités de faire du P2P avec Android, et notamment avec Beam.</p>