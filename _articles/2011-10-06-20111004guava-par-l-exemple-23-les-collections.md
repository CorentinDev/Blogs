---
ID: 104
post_title: 'Guava par l&#039;exemple (2/3) : les collections'
author: ocroisier
post_date: 2011-10-06 09:55:00
post_excerpt: |
  <p>Dans ce second article, je vous propose de découvrir les fonctionnalités de Guava relatives aux collections.<br />
  Nous nous intéresserons dans un premier temps aux Prédicats et aux Fonctions, puis nous découvrirons les nouvelles Collections proposées par Google.</p> <p>Cet article fait partie d'une série&nbsp;:</p> <ul> <li><a href="/index.php?post/2011/09/26/Guava-par-l-exemple-%281/3%29-%3A-les-classes-utilitaires">Guava&nbsp;: les classes utilitaires</a></li> <li><a href="/index.php?post/2011/10/04/Guava-par-l-exemple-%282/3%29-%3A-les-collections">Guava&nbsp;: les collections</a></li> <li><a href="/index.php?post/2011/10/13/Guava-par-l-exemple-%283/3%29-%3A-I/O">Guava&nbsp;: I/O</a></li> </ul>
layout: post
permalink: http://blog.zenika-offres.com/?p=104
published: true
---
<p>Dans ce second article, je vous propose de découvrir les fonctionnalités de Guava relatives aux collections.<br />
Nous nous intéresserons dans un premier temps aux Prédicats et aux Fonctions, puis nous découvrirons les nouvelles Collections proposées par Google.</p> <p>Cet article fait partie d'une série&nbsp;:</p> <ul> <li><a href="/index.php?post/2011/09/26/Guava-par-l-exemple-%281/3%29-%3A-les-classes-utilitaires">Guava&nbsp;: les classes utilitaires</a></li> <li><a href="/index.php?post/2011/10/04/Guava-par-l-exemple-%282/3%29-%3A-les-collections">Guava&nbsp;: les collections</a></li> <li><a href="/index.php?post/2011/10/13/Guava-par-l-exemple-%283/3%29-%3A-I/O">Guava&nbsp;: I/O</a></li> </ul>
<!--more-->
<h3>Fonctions et Prédicats</h3> <p>Guava propose les notions de Fonction (<code>Function&lt;T,R&gt;</code>) et de Prédicat (<code>Predicate&lt;T&gt;</code>).</p> <p>Ces deux concepts, empruntés au domaine de la programmation fonctionnelle, permettent d'encapsuler des algorithmes de transformation ou de vérification dans des objets réutilisables. Comme on le verra plus loin, ils expriment toute leur puissance lorsqu'ils sont utilisés pour filtrer ou transformer des collections d'objets&nbsp;; mais ils peuvent tout aussi bien être utilisés indépendamment.</p> <p>Voyons maintenant leurs caractéristiques&nbsp;:</p> <ul> <li>Une Fonction réalise une opération de <em>mapping</em> entre une donnée en entrée (de type T) et un résultat en sortie (de type R)&nbsp;: <code>Function&lt;T,R&gt;</code>. Son unique méthode <code>R apply(T input)</code> doit être redéfinie pour effectuer la transformation.</li> </ul> <pre class="java code java" style="font-family:inherit">@Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> lengthMapping<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> &nbsp; 	Function<span style="color: #000000;">&lt;</span>String, Integer<span style="color: #000000;">&gt;</span> lengthMapper = <span style="color: #7F0055; font-weight: bold;">new</span> Function<span style="color: #000000;">&lt;</span>String, Integer<span style="color: #000000;">&gt;</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 		<span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #000000;">Integer</span> apply<span style="color: #000000;">&#40;</span><span style="color: #000000;">String</span> s<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 			<span style="color: #7F0055; font-weight: bold;">return</span> s==<span style="color: #7F0055; font-weight: bold;">null</span> <span style="color: #000000;">?</span> 0 : s.<span style="color: #000000;">length</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 		<span style="color: #000000;">&#125;</span> 	<span style="color: #000000;">&#125;</span>; &nbsp; 	assertEquals<span style="color: #000000;">&#40;</span>0, <span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">int</span><span style="color: #000000;">&#41;</span> lengthMapper.<span style="color: #000000;">apply</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">null</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span>0, <span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">int</span><span style="color: #000000;">&#41;</span> lengthMapper.<span style="color: #000000;">apply</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">11</span>, <span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">int</span><span style="color: #000000;">&#41;</span> lengthMapper.<span style="color: #000000;">apply</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Hello World&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span> &nbsp; @Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> nameMapping<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> &nbsp; 	<span style="color: #7F0055; font-weight: bold;">class</span> Person <span style="color: #000000;">&#123;</span> 		<span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">final</span> <span style="color: #000000;">String</span> name; 		Person<span style="color: #000000;">&#40;</span><span style="color: #000000;">String</span> name<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 			<span style="color: #7F0055; font-weight: bold;">this</span>.<span style="color: #000000;">name</span> = name; 		<span style="color: #000000;">&#125;</span> 		<span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #000000;">String</span> getName<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span><span style="color: #7F0055; font-weight: bold;">return</span> name;<span style="color: #000000;">&#125;</span> 	<span style="color: #000000;">&#125;</span> &nbsp; 	Function<span style="color: #000000;">&lt;</span>Person, String<span style="color: #000000;">&gt;</span> nameMapper = <span style="color: #7F0055; font-weight: bold;">new</span> Function<span style="color: #000000;">&lt;</span>Person,String<span style="color: #000000;">&gt;</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 		<span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #000000;">String</span> apply<span style="color: #000000;">&#40;</span>Person c<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 			<span style="color: #7F0055; font-weight: bold;">return</span> c==<span style="color: #7F0055; font-weight: bold;">null</span> <span style="color: #000000;">?</span> <span style="color: #7F0055; font-weight: bold;">null</span> : c.<span style="color: #000000;">getName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 		<span style="color: #000000;">&#125;</span> 	<span style="color: #000000;">&#125;</span>; &nbsp; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">null</span>, nameMapper.<span style="color: #000000;">apply</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">null</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Joe Dalton&quot;</span>, nameMapper.<span style="color: #000000;">apply</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">new</span> Person<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Joe Dalton&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span></pre> <ul> <li>Un Prédicat permet d'effectuer une vérification sur un objet passé en entrée (de type T)&nbsp;: <code>Predicate&lt;T&gt;</code>. Sa méthode <code>boolean apply(T input)</code> nous permet d'effectuer la vérification souhaitée.</li> </ul> <pre class="java code java" style="font-family:inherit">@Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> emptyStringDetector<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> &nbsp; 	Predicate<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> nonEmptyStringPredicate = <span style="color: #7F0055; font-weight: bold;">new</span> Predicate<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 		<span style="color: #7F0055; font-
weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">boolean</span> apply<span style="color: #000000;">&#40;</span><span style="color: #000000;">String</span> s<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 			<span style="color: #7F0055; font-weight: bold;">return</span> s<span style="color: #000000;">!</span>=<span style="color: #7F0055; font-weight: bold;">null</span> <span style="color: #000000;">&amp;&amp;</span> s.<span style="color: #000000;">trim</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">length</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&gt;</span>0; 		<span style="color: #000000;">&#125;</span> 	<span style="color: #000000;">&#125;</span>; &nbsp; 	assertFalse<span style="color: #000000;">&#40;</span>nonEmptyStringPredicate.<span style="color: #000000;">apply</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">null</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertFalse<span style="color: #000000;">&#40;</span>nonEmptyStringPredicate.<span style="color: #000000;">apply</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>nonEmptyStringPredicate.<span style="color: #000000;">apply</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Hello World&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span> &nbsp; @Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> daltonDetector<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> &nbsp; 	<span style="color: #7F0055; font-weight: bold;">class</span> Person <span style="color: #000000;">&#123;</span> 		<span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">final</span> <span style="color: #000000;">String</span> firstName; 		<span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">final</span> <span style="color: #000000;">String</span> lastName; 		Person<span style="color: #000000;">&#40;</span><span style="color: #000000;">String</span> firstName, <span style="color: #000000;">String</span> lastName<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 			<span style="color: #7F0055; font-weight: bold;">this</span>.<span style="color: #000000;">firstName</span> = firstName; 			<span style="color: #7F0055; font-weight: bold;">this</span>.<span style="color: #000000;">lastName</span> = lastName; 		<span style="color: #000000;">&#125;</span> 		<span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #000000;">String</span> getFirstName<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span><span style="color: #7F0055; font-weight: bold;">return</span> firstName;<span style="color: #000000;">&#125;</span> 		<span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #000000;">String</span> getLastName<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span><span style="color: #7F0055; font-weight: bold;">return</span> lastName;<span style="color: #000000;">&#125;</span> 	<span style="color: #000000;">&#125;</span> &nbsp; 	Predicate<span style="color: #000000;">&lt;</span>Person<span style="color: #000000;">&gt;</span> daltonPredicate = <span style="color: #7F0055; font-weight: bold;">new</span> Predicate<span style="color: #000000;">&lt;</span>Person<span style="color: #000000;">&gt;</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 		<span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">boolean</span> apply<span style="color: #000000;">&#40;</span>Person p<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 			<span style="color: #7F0055; font-weight: bold;">return</span> p<span style="color: #000000;">!</span>=<span style="color: #7F0055; font-weight: bold;">null</span> <span style="color: #000000;">&amp;&amp;</span> <span style="color: #888888;">&quot;Dalton&quot;</span>.<span style="color: #000000;">equals</span><span style="color: #000000;">&#40;</span>p.<span style="color: #000000;">getLastName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 		<span style="color: #000000;">&#125;</span> 	<span style="color: #000000;">&#125;</span>; &nbsp; 	assertFalse<span style="color: #000000;">&#40;</span>daltonPredicate.<span style="color: #000000;">apply</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">null</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>daltonPredicate.<span style="color: #000000;">apply</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">new</span> Person<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Joe&quot;</span>, <span style="color: #888888;">&quot;Dalton&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertFalse<span style="color: #000000;">&#40;</span>daltonPredicate.<span style="color: #000000;">apply</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">new</span> Person<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Luke&quot;</span>, <span style="color: #888888;">&quot;Lucky&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span></pre> <p>Bonnes pratiques&nbsp;: Les Fonctions et Prédicats ne doivent avoir aucun effet secondaire dans l'application. En particulier, ils ne doivent pas modifier les objets qui leur sont passés en paramètre.</p> <p>Les classes <code>Predicates</code> et <code>Functions</code> permettent de composer (respectivement) des Prédicats et Fonctions selon la logique booléenne grâce aux méthodes <code>or</code>, <code>and</code>, <code>not</code>, et <code>compose</code>.</p> <h3>Collections2</h3> <p>La classe <code>Collections2</code> fournit justement les méthodes <code>filter</code> et <code>transform</code> qui utilisent respectivement les Prédicats et les Fonctions.</p> <ul> <li><code>filter</code> accepte une collection et un prédicat, et renvoie une nouvelle collection ne comprenant que les éléments vérifiant le prédicat.</li> <li><code>transform</code> applique une Fonction sur chaque élément de la collection passée en paramètre, et génère une nouvelle collection contenant les résultats de cette transformation. <br /><br />Cette méthode est pratique, par exemple, pour extraire un attribut d'un objet complexe.</li> </ul> <pre class="java code java" style="font-family:inherit"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">static</span> List<span style="color: #000000;">&lt;</span>Person<span style="color: #000000;">&gt;</span> people; &nbsp; @BeforeClass <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">static</span> <span style="color: #7F0055
; font-weight: bold;">void</span> initTests<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	people = <span style="color: #000000;">Arrays</span>.<span style="color: #000000;">asList</span><span style="color: #000000;">&#40;</span> 	  <span style="color: #7F0055; font-weight: bold;">new</span> Person<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Joe&quot;</span>, <span style="color: #888888;">&quot;Dalton&quot;</span><span style="color: #000000;">&#41;</span>, 	  <span style="color: #7F0055; font-weight: bold;">new</span> Person<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Jack&quot;</span>, <span style="color: #888888;">&quot;Dalton&quot;</span><span style="color: #000000;">&#41;</span>, 	  <span style="color: #7F0055; font-weight: bold;">new</span> Person<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;William&quot;</span>, <span style="color: #888888;">&quot;Dalton&quot;</span><span style="color: #000000;">&#41;</span>, 	  <span style="color: #7F0055; font-weight: bold;">new</span> Person<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Averell&quot;</span>, <span style="color: #888888;">&quot;Dalton&quot;</span><span style="color: #000000;">&#41;</span>, 	  <span style="color: #7F0055; font-weight: bold;">new</span> Person<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Luke&quot;</span>, <span style="color: #888888;">&quot;Lucky&quot;</span><span style="color: #000000;">&#41;</span>, 	  <span style="color: #7F0055; font-weight: bold;">new</span> Person<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Rantanplan&quot;</span>, <span style="color: #888888;">&quot;Dog&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span> &nbsp; @Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> filter<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> &nbsp; 	Predicate<span style="color: #000000;">&lt;</span>Person<span style="color: #000000;">&gt;</span> isDaltonPredicate = <span style="color: #7F0055; font-weight: bold;">new</span> Predicate<span style="color: #000000;">&lt;</span>Person<span style="color: #000000;">&gt;</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 		<span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">boolean</span> apply<span style="color: #000000;">&#40;</span>Person p<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 			<span style="color: #7F0055; font-weight: bold;">return</span> p <span style="color: #000000;">!</span>= <span style="color: #7F0055; font-weight: bold;">null</span> <span style="color: #000000;">&amp;&amp;</span> <span style="color: #888888;">&quot;Dalton&quot;</span>.<span style="color: #000000;">equals</span><span style="color: #000000;">&#40;</span>p.<span style="color: #000000;">getLastName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 		<span style="color: #000000;">&#125;</span> 	<span style="color: #000000;">&#125;</span>; &nbsp; 	Collection<span style="color: #000000;">&lt;</span>Person<span style="color: #000000;">&gt;</span> daltons = Collections2.<span style="color: #000000;">filter</span><span style="color: #000000;">&#40;</span>people, isDaltonPredicate<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">4</span>, daltons.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Joe&quot;</span>,daltons.<span style="color: #000000;">iterator</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">next</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">getFirstName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span> &nbsp; @Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> transform<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> &nbsp; 	Function<span style="color: #000000;">&lt;</span>Person, String<span style="color: #000000;">&gt;</span> personFullNameMapper = <span style="color: #7F0055; font-weight: bold;">new</span> Function<span style="color: #000000;">&lt;</span>Person, String<span style="color: #000000;">&gt;</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 		<span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #000000;">String</span> apply<span style="color: #000000;">&#40;</span>Person person<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 			<span style="color: #7F0055; font-weight: bold;">return</span> person == <span style="color: #7F0055; font-weight: bold;">null</span> <span style="color: #000000;">?</span> <span style="color: #7F0055; font-weight: bold;">null</span> : person.<span style="color: #000000;">getFirstName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>+<span style="color: #888888;">&quot; &quot;</span>+person.<span style="color: #000000;">getLastName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 		<span style="color: #000000;">&#125;</span> 	<span style="color: #000000;">&#125;</span>; &nbsp; 	Collection<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> peopleNames = Collections2.<span style="color: #000000;">transform</span><span style="color: #000000;">&#40;</span>people, personFullNameMapper<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">6</span>, peopleNames.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Joe Dalton&quot;</span>, peopleNames.<span style="color: #000000;">iterator</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">next</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span> &nbsp; <span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">static</span> <span style="color: #7F0055; font-weight: bold;">class</span> Person <span style="color: #000000;">&#123;</span> 	<span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">final</span> <span style="color: #000000;">String</span> firstName; 	<span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">final</span> <span style="color: #000000;">String</span> lastName; &nbsp; 	Person<span style="color: #000000;">&#40;</span><span style="color: #000000;">String</span> firstName, <span style="color: #000000;">String</span> lastName<span style="color: #00000
0;">&#41;</span> <span style="color: #000000;">&#123;</span> 		<span style="color: #7F0055; font-weight: bold;">this</span>.<span style="color: #000000;">firstName</span> = firstName; 		<span style="color: #7F0055; font-weight: bold;">this</span>.<span style="color: #000000;">lastName</span> = lastName; 	<span style="color: #000000;">&#125;</span> 	<span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #000000;">String</span> getFirstName<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span><span style="color: #7F0055; font-weight: bold;">return</span> firstName;<span style="color: #000000;">&#125;</span> 	<span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #000000;">String</span> getLastName<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span><span style="color: #7F0055; font-weight: bold;">return</span> lastName;<span style="color: #000000;">&#125;</span> <span style="color: #000000;">&#125;</span></pre> <h3>Lists, Sets, Maps</h3> <h4>Lists</h4> <p>La classe utilitaire <code>Lists</code> facilite le travail avec les listes, notamment&nbsp;:</p> <ul> <li>Leur instanciation, grâce à des méthodes <em>factory</em> tirant parti des capacités d'inférence de type du compilateur&nbsp;: <code>newArrayList</code> et <code>newLinkedList</code>. Notez qu'il y en aura moins besoin avec la notation "en diamant" de Java 7).</li> <li>Leur découpage en <em>partitions</em>, c'est-à-dire en sous-listes d'une certaine taille&nbsp;: <code>partition</code>.</li> <li>Leur transformation à l'aide de Fonctions (voir la section "Collections" ci-dessus).</li> </ul> <pre class="java code java" style="font-family:inherit">@Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> instanciation<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	Collection<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> someIterable = <span style="color: #7F0055; font-weight: bold;">new</span> HashSet<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	List<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> arrayList1 = Lists.<span style="color: #000000;">newArrayList</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	List<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> arrayList2 = Lists.<span style="color: #000000;">newArrayList</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Hello&quot;</span>, <span style="color: #888888;">&quot;World&quot;</span><span style="color: #000000;">&#41;</span>; 	List<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> arrayList3 = Lists.<span style="color: #000000;">newArrayList</span><span style="color: #000000;">&#40;</span>someIterable<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #000000;">ArrayList</span>.<span style="color: #7F0055; font-weight: bold;">class</span>, arrayList1.<span style="color: #000000;">getClass</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	List<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> linkedList1 = Lists.<span style="color: #000000;">newLinkedList</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	List<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> linkedList2 = Lists.<span style="color: #000000;">newLinkedList</span><span style="color: #000000;">&#40;</span>someIterable<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #000000;">LinkedList</span>.<span style="color: #7F0055; font-weight: bold;">class</span>, linkedList1.<span style="color: #000000;">getClass</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span> &nbsp; @Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> partition<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	List<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;</span> numbers = <span style="color: #000000;">Arrays</span>.<span style="color: #000000;">asList</span><span style="color: #000000;">&#40;</span>0,<span style="color: #cc66cc;">1</span>,<span style="color: #cc66cc;">2</span>,<span style="color: #cc66cc;">3</span>,<span style="color: #cc66cc;">4</span>,<span style="color: #cc66cc;">5</span>,<span style="color: #cc66cc;">6</span>,<span style="color: #cc66cc;">7</span>,<span style="color: #cc66cc;">8</span>,<span style="color: #cc66cc;">9</span><span style="color: #000000;">&#41;</span>; &nbsp; 	List<span style="color: #000000;">&lt;</span>List<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;&gt;</span> subLists = Lists.<span style="color: #000000;">partition</span><span style="color: #000000;">&#40;</span>numbers, <span style="color: #cc66cc;">4</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">3</span>, subLists.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #000000;">Arrays</span>.<span style="color: #000000;">asList</span><span style="color: #000000;">&#40;</span>0,<span style="color: #cc66cc;">1</span>,<span style="color: #cc66cc;">2</span>,<span style="color: #cc66cc;">3</span><span style="color: #000000;">&#41;</span>, subLists.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span>0<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #000000;">Arrays</span>.<span style="color: #000000;">asList</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">4</span>,<span style="color: #cc66cc;">5</span>,<span style="color: #cc66cc;">6</span>,<span style="color: #cc66cc;">7</span><span style="color: #000000;">&#41;</span>, subLists.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #000000;">Arrays</span>.<span style="color: #000000;">asList</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">8</span>,<span style="color: #cc66cc;">9</span><span style="color: #000000;">&#41;</span>, subLists.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span></pre> <h4>Sets</h4> <p>De manière équivalente à la classe <code>Lists</code>, la classe utilitaire <code>Sets</code> facilite le travail avec les sets, notamment&nbsp;:</p> <ul> <li>Leur instanciation, <code>newHashSet</code>, <code>newLinkedHashSet</code>, <code>newTreeSet</code>.</li> <li>L'application de fonctions ensemblistes&nbsp;: <code>cartesianProduct</code>, <cod
e>difference</code>, <code>intersection</code> et <code>union</code></li> <li>Leur filtrage à l'aide de Prédicats (voir la section "Collections" ci-dessus).</li> </ul> <pre class="java code java" style="font-family:inherit">@Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> instanciation<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	Collection<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> someIterable = <span style="color: #7F0055; font-weight: bold;">new</span> HashSet<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	Set<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> hashSet1 = Sets.<span style="color: #000000;">newHashSet</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	Set<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> hashSet2 = Sets.<span style="color: #000000;">newHashSet</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Hello&quot;</span>, <span style="color: #888888;">&quot;World&quot;</span><span style="color: #000000;">&#41;</span>; 	Set<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> hashSet3 = Sets.<span style="color: #000000;">newHashSet</span><span style="color: #000000;">&#40;</span>someIterable<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #000000;">HashSet</span>.<span style="color: #7F0055; font-weight: bold;">class</span>, hashSet1.<span style="color: #000000;">getClass</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	Set<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> linkedHashSet1 = Sets.<span style="color: #000000;">newLinkedHashSet</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	Set<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> linkedHashSet2 = Sets.<span style="color: #000000;">newLinkedHashSet</span><span style="color: #000000;">&#40;</span>someIterable<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span>LinkedHashSet.<span style="color: #7F0055; font-weight: bold;">class</span>, linkedHashSet1.<span style="color: #000000;">getClass</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	Set<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> treeSet1 = Sets.<span style="color: #000000;">newTreeSet</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	Set<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> treeSet2 = Sets.<span style="color: #000000;">newTreeSet</span><span style="color: #000000;">&#40;</span>someIterable<span style="color: #000000;">&#41;</span>; 	Set<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> treeSet3 = Sets.<span style="color: #000000;">newTreeSet</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">String</span>.<span style="color: #000000;">CASE_INSENSITIVE_ORDER</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #000000;">TreeSet</span>.<span style="color: #7F0055; font-weight: bold;">class</span>, treeSet1.<span style="color: #000000;">getClass</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span> &nbsp; @Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> ensembles<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	Set<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> chiffres = Sets.<span style="color: #000000;">newHashSet</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;1&quot;</span>, <span style="color: #888888;">&quot;2&quot;</span>, <span style="color: #888888;">&quot;3&quot;</span><span style="color: #000000;">&#41;</span>; 	Set<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> lettres = Sets.<span style="color: #000000;">newHashSet</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;A&quot;</span>, <span style="color: #888888;">&quot;B&quot;</span>, <span style="color: #888888;">&quot;C&quot;</span><span style="color: #000000;">&#41;</span>; 	Set<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> voyelles= Sets.<span style="color: #000000;">newHashSet</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;A&quot;</span>, <span style="color: #888888;">&quot;E&quot;</span>, <span style="color: #888888;">&quot;I&quot;</span>, <span style="color: #888888;">&quot;O&quot;</span>, <span style="color: #888888;">&quot;U&quot;</span>, <span style="color: #888888;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Produit cartésien : 3 x 3 possibilités</span> 	Set<span style="color: #000000;">&lt;</span>List<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;&gt;</span> combinations = Sets.<span style="color: #000000;">cartesianProduct</span><span style="color: #000000;">&#40;</span>chiffres, lettres<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">9</span>, combinations.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Différence : lettres - voyelles</span> 	Sets.<span style="color: #000000;">SetView</span><span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> difference = Sets.<span style="color: #000000;">difference</span><span style="color: #000000;">&#40;</span>lettres, voyelles<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">2</span>, difference.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>difference.<span style="color: #000000;">containsAll</span><span style="color: #000000;">&#40;</span>Sets.<span style="color: #000000;">newHashSet</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;B&quot;</span>, <span style="color: #888888;">&quot;C&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Intersection : éléments présents dans 'lettres' ET dans 'voyelles'</span> 	Sets.<span style="color: #000000;">SetView</span><span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> intersection = Sets.<span style="color: #000000;">intersection</span><span style="color: #000000;">&#40;</span>lettres, voyelles<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">1</span>, intersection.<span style="c
olor: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;A&quot;</span>, intersection.<span style="color: #000000;">iterator</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">next</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Union : lettres + voyelles</span> 	Sets.<span style="color: #000000;">SetView</span><span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> union = Sets.<span style="color: #000000;">union</span><span style="color: #000000;">&#40;</span>lettres, voyelles<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">8</span>, union.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>union.<span style="color: #000000;">containsAll</span><span style="color: #000000;">&#40;</span>Sets.<span style="color: #000000;">newHashSet</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;A&quot;</span>, <span style="color: #888888;">&quot;B&quot;</span>, <span style="color: #888888;">&quot;C&quot;</span>, <span style="color: #888888;">&quot;E&quot;</span>, <span style="color: #888888;">&quot;I&quot;</span>, <span style="color: #888888;">&quot;O&quot;</span>, <span style="color: #888888;">&quot;U&quot;</span>, <span style="color: #888888;">&quot;Y&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span></pre> <h4>Maps</h4> <p>Pour terminer, et sans surprise, la classe <code>Maps</code> s'occupe de simplifier la manipulation des <code>Map</code>, notamment&nbsp;:</p> <ul> <li>Leur instanciation&nbsp;: <code>newHashMap</code>, <code>newLinkedHashMap</code>, <code>newTreeMap</code> et <code>newConcurrentMap</code>.</li> <li>La transformation de <code>Properties</code> en <code>Map</code> avec la méthode <code>fromProperties</code>. Très pratique&nbsp;!</li> <li>La comparaison de deux <code>Map</code> grâce à la méthode <code>difference</code>, qui renvoie une structure complexe décrivant les entrées communes, les entrées différentes, celles qui n'apparaissent que dans l'une ou l'autre des <code>Map</code>.</li> <li>Le filtrage et la transformation des clés et/ou des valeurs à l'aide de Prédicats et de Fonctions.</li> </ul> <pre class="java code java" style="font-family:inherit">@Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> instanciation<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> &nbsp; 	Map<span style="color: #000000;">&lt;</span>String, String<span style="color: #000000;">&gt;</span> someIterable = <span style="color: #7F0055; font-weight: bold;">new</span> HashMap<span style="color: #000000;">&lt;</span>String, String<span style="color: #000000;">&gt;</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	Comparator<span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;</span> someComparator = <span style="color: #000000;">String</span>.<span style="color: #000000;">CASE_INSENSITIVE_ORDER</span>; &nbsp; 	Map<span style="color: #000000;">&lt;</span>String, String<span style="color: #000000;">&gt;</span> hashMap1 = Maps.<span style="color: #000000;">newHashMap</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	Map<span style="color: #000000;">&lt;</span>String, String<span style="color: #000000;">&gt;</span> hashMap2 = Maps.<span style="color: #000000;">newHashMap</span><span style="color: #000000;">&#40;</span>someIterable<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #000000;">HashMap</span>.<span style="color: #7F0055; font-weight: bold;">class</span>, hashMap1.<span style="color: #000000;">getClass</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	Map<span style="color: #000000;">&lt;</span>String, String<span style="color: #000000;">&gt;</span> linkedHashMap1 = Maps.<span style="color: #000000;">newLinkedHashMap</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	Map<span style="color: #000000;">&lt;</span>String, String<span style="color: #000000;">&gt;</span> linkedHashMap2 = Maps.<span style="color: #000000;">newLinkedHashMap</span><span style="color: #000000;">&#40;</span>someIterable<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span>LinkedHashMap.<span style="color: #7F0055; font-weight: bold;">class</span>, linkedHashMap1.<span style="color: #000000;">getClass</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	Map<span style="color: #000000;">&lt;</span>String, String<span style="color: #000000;">&gt;</span> treeMap1 = Maps.<span style="color: #000000;">newTreeMap</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	Map<span style="color: #000000;">&lt;</span>String, String<span style="color: #000000;">&gt;</span> treeMap2 = Maps.<span style="color: #000000;">newTreeMap</span><span style="color: #000000;">&#40;</span>someComparator<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #000000;">TreeMap</span>.<span style="color: #7F0055; font-weight: bold;">class</span>, treeMap1.<span style="color: #000000;">getClass</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	Map<span style="color: #000000;">&lt;</span>String, String<span style="color: #000000;">&gt;</span> concurrentMap = Maps.<span style="color: #000000;">newConcurrentMap</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span>ConcurrentHashMap.<span style="color: #7F0055; font-weight: bold;">class</span>, concurrentMap.<span style="color: #000000;">getClass</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span> &nbsp; @Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> fromProperties<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	<span style="color: #000000;">Properties</span> props = <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">Properties</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	props.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;message&quot;</span>,<span style="color: #888888;">&quot;Hello World&quot;</span><span style="color: #000000;">&#41;</span>; 	props.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;foo&quot;</span>, <span style="color: #888888;">&quot;bar&quot;</span><span style="color: #000000;">&#41;</span>; 	props.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #88
8888;">&quot;universalAnswer&quot;</span>, <span style="color: #888888;">&quot;42&quot;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	Map<span style="color: #000000;">&lt;</span>String,String<span style="color: #000000;">&gt;</span> map = Maps.<span style="color: #000000;">fromProperties</span><span style="color: #000000;">&#40;</span>props<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">3</span>, map.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;42&quot;</span>, map.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;universalAnswer&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span> &nbsp; @Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> difference<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	Map<span style="color: #000000;">&lt;</span>String, String<span style="color: #000000;">&gt;</span> map1 = Maps.<span style="color: #000000;">newHashMap</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	map1.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;A&quot;</span>,<span style="color: #888888;">&quot;A&quot;</span><span style="color: #000000;">&#41;</span>; 	map1.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;B&quot;</span>,<span style="color: #888888;">&quot;B&quot;</span><span style="color: #000000;">&#41;</span>; 	map1.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;C&quot;</span>,<span style="color: #888888;">&quot;C&quot;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	Map<span style="color: #000000;">&lt;</span>String, String<span style="color: #000000;">&gt;</span> map2 = Maps.<span style="color: #000000;">newHashMap</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	map2.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;B&quot;</span>,<span style="color: #888888;">&quot;-&quot;</span><span style="color: #000000;">&#41;</span>; 	map2.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;C&quot;</span>,<span style="color: #888888;">&quot;C&quot;</span><span style="color: #000000;">&#41;</span>; 	map2.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;D&quot;</span>,<span style="color: #888888;">&quot;D&quot;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	MapDifference<span style="color: #000000;">&lt;</span>String,String<span style="color: #000000;">&gt;</span> diff = Maps.<span style="color: #000000;">difference</span><span style="color: #000000;">&#40;</span>map1, map2<span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Clé et valeur communes</span> 	Map<span style="color: #000000;">&lt;</span>String, String<span style="color: #000000;">&gt;</span> commonEntries = diff.<span style="color: #000000;">entriesInCommon</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">1</span>, commonEntries.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>commonEntries.<span style="color: #000000;">containsKey</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;C&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Clé commune, valeur différente</span> 	Map<span style="color: #000000;">&lt;</span>String, MapDifference.<span style="color: #000000;">ValueDifference</span><span style="color: #000000;">&lt;</span>String<span style="color: #000000;">&gt;&gt;</span> differentEntries = diff.<span style="color: #000000;">entriesDiffering</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">1</span>, differentEntries.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;B&quot;</span>, differentEntries.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;B&quot;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">leftValue</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;-&quot;</span>, differentEntries.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;B&quot;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">rightValue</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Clés seulement à gauche</span> 	Map<span style="color: #000000;">&lt;</span>String, String<span style="color: #000000;">&gt;</span> leftEntries = diff.<span style="color: #000000;">entriesOnlyOnLeft</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">1</span>, leftEntries.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>leftEntries.<span style="color: #000000;">containsKey</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;A&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Clés seulement à droite</span> 	Map<span style="color: #000000;">&lt;</span>String, String<span style="color: #000000;">&gt;</span> rightEntries = diff.<span style="color: #000000;">entriesOnlyOnRight</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">1</span>, rightEntries.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>rightEntries.<span style="color: #000000;">containsKey</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;D&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span></pre> <h3>Iterables et Iterators</h3> <p>Il arrive que nous devions travailler avec des <code>Iterator</code> ou des objets implémentant <code>Iterable</code>, plutôt qu'ave
c des collections. Ces deux interfaces sont très pauvres, et sont pénibles à utiliser. Les classes utilitaires <code>Iterables</code> et <code>Iterators</code> permettent de retrouver la plupart des fonctionnalités présentes dans les Collections.</p> <p><code>Iterables</code> et <code>Iterators</code> agissent respectivement sur des objets implémentant <code>Iterable</code> (comme les collections), et sur les <code>Iterator</code> qu'ils renvoient, mais fournissent exactement les mêmes fonctionnalités.</p> <ul> <li>Les méthodes <code>all</code> et <code>any</code> déterminent respectivement si tous, ou au moins un élément vérifie(nt) un certain Prédicat&nbsp;;</li> <li>La recherche avec <code>contains</code>, <code>find</code> et <code>indexOf</code>&nbsp;;</li> <li>L'itération limitée (<code>limit</code>) ou illimitée (<code>cycle</code>) sur les éléments&nbsp;;</li> <li>La détermination de la taille de l'ensemble parcouru avec <code>isEmpty</code> et <code>size</code></li> </ul> <pre class="java code java" style="font-family:inherit"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">final</span> List<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;</span> nombres = <span style="color: #000000;">Arrays</span>.<span style="color: #000000;">asList</span><span style="color: #000000;">&#40;</span>0, <span style="color: #cc66cc;">1</span>, <span style="color: #cc66cc;">2</span>, <span style="color: #cc66cc;">3</span>, <span style="color: #cc66cc;">4</span>, <span style="color: #cc66cc;">5</span>, <span style="color: #cc66cc;">6</span>, <span style="color: #cc66cc;">7</span>, <span style="color: #cc66cc;">8</span>, <span style="color: #cc66cc;">9</span><span style="color: #000000;">&#41;</span>; <span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">final</span> List<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;</span> nombresPairs = <span style="color: #000000;">Arrays</span>.<span style="color: #000000;">asList</span><span style="color: #000000;">&#40;</span>0, <span style="color: #cc66cc;">2</span>, <span style="color: #cc66cc;">4</span>, <span style="color: #cc66cc;">6</span>, <span style="color: #cc66cc;">8</span><span style="color: #000000;">&#41;</span>; &nbsp; <span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">final</span> Predicate<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;</span> isNombrePair = <span style="color: #7F0055; font-weight: bold;">new</span> Predicate<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	<span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">boolean</span> apply<span style="color: #000000;">&#40;</span><span style="color: #000000;">Integer</span> number<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 		<span style="color: #7F0055; font-weight: bold;">return</span> number <span style="color: #000000;">%</span> <span style="color: #cc66cc;">2</span> == 0; 	<span style="color: #000000;">&#125;</span> <span style="color: #000000;">&#125;</span>; &nbsp; @Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> usingPredicates<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	<span style="color: #808080; font-style: italic;">// Tous les nombres sont pairs ?</span> 	assertFalse<span style="color: #000000;">&#40;</span>Iterables.<span style="color: #000000;">all</span><span style="color: #000000;">&#40;</span>nombres, isNombrePair<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>Iterables.<span style="color: #000000;">all</span><span style="color: #000000;">&#40;</span>nombresPairs, isNombrePair<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Au moins un des nombres est pair ?</span> 	assertTrue<span style="color: #000000;">&#40;</span>Iterables.<span style="color: #000000;">any</span><span style="color: #000000;">&#40;</span>nombres, isNombrePair<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>Iterables.<span style="color: #000000;">any</span><span style="color: #000000;">&#40;</span>nombresPairs, isNombrePair<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Filtrage et égalité</span> 	Iterable<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;</span> filteredNumbers = Iterables.<span style="color: #000000;">filter</span><span style="color: #000000;">&#40;</span>nombres, isNombrePair<span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>Iterables.<span style="color: #000000;">elementsEqual</span><span style="color: #000000;">&#40;</span>nombresPairs, filteredNumbers<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span> &nbsp; @Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> search<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	<span style="color: #808080; font-style: italic;">// Contains</span> 	assertFalse<span style="color: #000000;">&#40;</span>Iterables.<span style="color: #000000;">contains</span><span style="color: #000000;">&#40;</span>nombres, -<span style="color: #cc66cc;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>Iterables.<span style="color: #000000;">contains</span><span style="color: #000000;">&#40;</span>nombres, <span style="color: #cc66cc;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Find</span> 	<span style="color: #000000;">Integer</span> firstMatchingElement = Iterables.<span style="color: #000000;">find</span><span style="color: #000000;">&#40;</span>nombres, isNombrePair<span style="color: #000000;">&#41;</span>; 	assertNotNull<span style="color: #000000;">&#40;</span>firstMatchingElement<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span>0, firstMatchingElement.<span style="color: #000000;">intValue</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// IndexOf</span> 	<span style="color: #7F0055; font-weight: bold;">int</span> firstMatchingIndex = Iterables.<span style="color: #000000;">indexOf</span><span style="color: #000000;">&#40;</span>nombres, isNombrePair<span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span>0, firstMatchingIndex<span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span> &nbsp; @Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> iteration<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	List<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;</span> nombres = <span style="color: #000000;">Arrays</span>.<span style="color: #000000;"
>asList</span><span style="color: #000000;">&#40;</span>0, <span style="color: #cc66cc;">1</span>, <span style="color: #cc66cc;">2</span>, <span style="color: #cc66cc;">3</span>, <span style="color: #cc66cc;">4</span>, <span style="color: #cc66cc;">5</span>, <span style="color: #cc66cc;">6</span>, <span style="color: #cc66cc;">7</span>, <span style="color: #cc66cc;">8</span>, <span style="color: #cc66cc;">9</span><span style="color: #000000;">&#41;</span>; 	<span style="color: #7F0055; font-weight: bold;">int</span> limit = <span style="color: #cc66cc;">3</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Limited iteration</span> 	Iterable<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;</span> limited = Iterables.<span style="color: #000000;">limit</span><span style="color: #000000;">&#40;</span>nombres, limit<span style="color: #000000;">&#41;</span>; 	Iterator<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;</span> limitedIterator = limited.<span style="color: #000000;">iterator</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	<span style="color: #7F0055;font-weight: bold;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">int</span> i = 0; i <span style="color: #000000;">&lt;</span> limit; i++<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 		assertTrue<span style="color: #000000;">&#40;</span>limitedIterator.<span style="color: #000000;">hasNext</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 		limitedIterator.<span style="color: #000000;">next</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	<span style="color: #000000;">&#125;</span> 	assertFalse<span style="color: #000000;">&#40;</span>limitedIterator.<span style="color: #000000;">hasNext</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Unlimited iteration</span> 	Iterable<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;</span> cycling = Iterables.<span style="color: #000000;">cycle</span><span style="color: #000000;">&#40;</span>nombres<span style="color: #000000;">&#41;</span>; 	Iterator<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;</span> cyclingIterator = cycling.<span style="color: #000000;">iterator</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	<span style="color: #7F0055;font-weight: bold;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">int</span> i = 0; i <span style="color: #000000;">&lt;</span> <span style="color: #cc66cc;">10</span> <span style="color: #000000;">*</span> nombres.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; i++<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 		assertTrue<span style="color: #000000;">&#40;</span>cyclingIterator.<span style="color: #000000;">hasNext</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 		cyclingIterator.<span style="color: #000000;">next</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	<span style="color: #000000;">&#125;</span> <span style="color: #000000;">&#125;</span> &nbsp; @Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> size<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 	assertFalse<span style="color: #000000;">&#40;</span>Iterables.<span style="color: #000000;">isEmpty</span><span style="color: #000000;">&#40;</span>nombres<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span>nombres.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, Iterables.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span>nombres<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span></pre> <h3>Multi-collections</h3> <p>Guava fournit quelques nouvelles collections pratiques, comme <code>Multimap</code> et <code>Multiset</code>, ainsi que <code>BiMap</code>.</p> <h4>Multimap</h4> <p>Une <code>Multimap</code> associe plusieurs valeurs à chaque clé. Ces valeurs sont contenues dans une <code>List</code> ou un <code>Set</code>, créés automatiquement à la première insertion. <br /><br />
En tant que développeur, vous n'avez donc plus à vous soucier de l'existence ou de la création des collections contenant vos valeurs&nbsp;: il suffit d'appeler <code>put(K,V)</code> ou <code>remove(K,V)</code> comme d'habitude.</p> <p>Il existe deux familles de <code>Multimap</code>&nbsp;:</p> <ul> <li>Les <code>ListMultimap</code>, qui utilisent au choix une <code>LinkedList</code> (<code>LinkedListMultimap</code>) ou une <code>ArrayList</code> (<code>ArrayListMultimap</code>)pour stocker les valeurs.</li> <li>Les <code>SetMultimap</code>, qui associent à chaque clé un <code>Set</code> de valeurs&nbsp;: <code>HashMultimap</code>, <code>LinkedHashMultimap</code> et <code>TreeMultimap</code>.</li> </ul> <p>Chacune de ces classes est instanciée via une méthode <em>factory</em> appelée <code>create()</code>.</p> <pre class="java code java" style="font-family:inherit">@Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> listMultimap<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> &nbsp; 	ListMultimap<span style="color: #000000;">&lt;</span>Integer, Integer<span style="color: #000000;">&gt;</span> tablesMultiplication = LinkedListMultimap.<span style="color: #000000;">create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	<span style="color: #808080; font-style: italic;">// Existe aussi en version ArrayList :</span> 	<span style="color: #808080; font-style: italic;">// ListMultimap&lt;Integer, Integer&gt; tablesMultiplication = ArrayListMultimap.create();</span> &nbsp; 	<span style="color: #7F0055;font-weight: bold;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">int</span> table = 0; table <span style="color: #000000;">&lt;</span> <span style="color: #cc66cc;">10</span>; table++<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 		<span style="color: #7F0055;font-weight: bold;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">int</span> i = 0; i <span style="color: #000000;">&lt;</span> <span style="color: #cc66cc;">10</span>; i++<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> 			tablesMultiplication.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span>table, i <span style="color: #000000;">*</span> table<span style="color: #000000;">&#41;</span>; 		<span style="color: #000000;">&#125;</span> 	<span style="color: #000000;">&#125;</span> &nbsp; 	List<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;</span> tableDe2 = tablesMultiplication.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>tableDe2 <span style="color: #7F0055; font-weight: bold;">instanceof</span> <span style="color: #000000;">List</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">10</span>, tableDe2.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>tableDe2.<span style="color: #000000;">containsAll</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">Arrays</span>.<span style="color: #000000;">asList</span><span style="color: #000000;">&#40;</span>0, <span style="color: #cc66cc;">2</span>, <span style="color: #cc66cc;">4</span>, <span style="color: #cc66cc;">6</span>, <span style="color: #cc66cc;">8</span>, <span style="color: #cc66cc;">10</span>, <span style="color: #cc66cc;">12</span>, <span style="color: #cc66cc;">14</span>, <span style="color: #cc66cc;">16</span>, <span style="color: #cc66cc;">18</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Suppression de l'élément &quot;10&quot; dans la table de 2</span> 	tablesMultiplication.<span style="color: #000000;">remove</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">2</span>, <span style="color: #cc66cc;">10</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">9</span>, tableDe2.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>tableDe2.<span style="color: #000000;">containsAll</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">Arrays</span>.<span style="color: #000000;">asList</span><span style="color: #000000;">&#40;</span>0, <span style="color: #cc66cc;">2</span>, <span style="color: #cc66cc;">4</span>, <span style="color: #cc66cc;">6</span>, <span style="color: #cc66cc;">8</span>, <span style="color: #808080; font-style: italic;">/*10,*/</span> <span style="color: #cc66cc;">12</span>, <span style="color: #cc66cc;">14</span>, <span style="color: #cc66cc;">16</span>, <span style="color: #cc66cc;">18</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Transformation en simple Map</span> 	Map<span style="color: #000000;">&lt;</span>Integer, Collection<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;&gt;</span> map = tablesMultiplication.<span style="color: #000000;">asMap</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span> &nbsp; @Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> setMultimap<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> &nbsp; 	SetMultimap<span style="color: #000000;">&lt;</span>String, Integer<span style="color: #000000;">&gt;</span> caveAVins = HashMultimap.<span style="color: #000000;">create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	<span style="color: #808080; font-style: italic;">// Existe aussi en version LinkedHashMultimap et TreeMultimap :</span> 	<span style="color: #808080; font-style: italic;">// SetMultimap&lt;String, Integer&gt; caveAVins = LinkedHashMultimap.create();</span> 	<span style="color: #808080; font-style: italic;">// SetMultimap&lt;String, Integer&gt; caveAVins = TreeMultimap.create();</span> &nbsp; 	caveAVins.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Bordeaux&quot;</span>, <span style="color: #cc66cc;">1985</span><span style="color: #000000;">&#41;</span>; 	caveAVins.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Bordeaux&quot;</span>, <span style="color: #cc66cc;">1986</span><span style="color: #000000;">&#41;</span>; 	caveAVins.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Bordeaux&quot;</span>, <span style="color: #cc66cc;">1985</span><span style="color: #000000;">&#41;</span>; 	caveAVins.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Bordeaux&quot;</span>, <span style="color: #cc66cc;">1985</span><span style="color: #000000;">&#41;</span>; 	caveAVins.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Bordeaux&quot;</span>, <span
style="color: #cc66cc;">1990</span><span style="color: #000000;">&#41;</span>; &nbsp; 	Set<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;</span> bordeaux = caveAVins.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Bordeaux&quot;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>bordeaux <span style="color: #7F0055; font-weight: bold;">instanceof</span> <span style="color: #000000;">Set</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">3</span>, bordeaux.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>bordeaux.<span style="color: #000000;">containsAll</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">Arrays</span>.<span style="color: #000000;">asList</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">1985</span>, <span style="color: #cc66cc;">1986</span>, <span style="color: #cc66cc;">1990</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Suppression de 1996</span> 	bordeaux.<span style="color: #000000;">remove</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">1986</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">2</span>, bordeaux.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertTrue<span style="color: #000000;">&#40;</span>bordeaux.<span style="color: #000000;">containsAll</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">Arrays</span>.<span style="color: #000000;">asList</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">1985</span>, <span style="color: #808080; font-style: italic;">/*1986,*/</span> <span style="color: #cc66cc;">1990</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Transformation en simple Map</span> 	Map<span style="color: #000000;">&lt;</span>String, Collection<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;&gt;</span> map = caveAVins.<span style="color: #000000;">asMap</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span></pre> <h4>Multiset</h4> <p>"<code>Multiset</code>" est un nom un peu trompeur pour cette classe. En réalité, il s'agit plutôt d'un <em>bag</em>, c'est-à-dire une collection non ordonnée autorisant les doublons.<br /><br />
Cette collection a pour particularité de compter le nombre d'occurrences de chaque élément qui y est inséré. Elle est pratique pour collecter des statistiques sur la fréquence d'apparition des éléments au sein d'un ensemble.</p> <p>Plusieurs versions existent&nbsp;: <code>HashMultiset</code>, <code>LinkedHashMultiset</code> et <code>TreeMultiset</code>. Elles sont toutes instanciées via leur méthode <em>factory</em> <code>create()</code>.</p> <p>Enfin, il est possible de retransformer un <code>Multiset</code> en <code>Set</code> grâce à la méthode <code>elementSet()</code> (les doublons sont éliminés au passage).</p> <pre class="java code java" style="font-family:inherit">@Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> multiset<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> &nbsp; 	HashMultiset<span style="color: #000000;">&lt;</span>Integer<span style="color: #000000;">&gt;</span> ages = HashMultiset.<span style="color: #000000;">create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	<span style="color: #808080; font-style: italic;">// Existe également en version LinkedHashSet, TreeSet, et ConcurrentHashSet :</span> 	<span style="color: #808080; font-style: italic;">// HashMultiset&lt;Integer&gt; ages = LinkedHashMultiset.create();</span> 	<span style="color: #808080; font-style: italic;">// HashMultiset&lt;Integer&gt; ages = TreeMultiset.create();</span> 	<span style="color: #808080; font-style: italic;">// HashMultiset&lt;Integer&gt; ages = ConcurrentHashMultiset.create();</span> &nbsp; 	ages.<span style="color: #000000;">add</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">28</span><span style="color: #000000;">&#41;</span>; 	ages.<span style="color: #000000;">add</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">28</span><span style="color: #000000;">&#41;</span>; 	ages.<span style="color: #000000;">add</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">30</span>, <span style="color: #cc66cc;">3</span><span style="color: #000000;">&#41;</span>; <span style="color: #808080; font-style: italic;">// Ajouter 3 fois cet élément</span> 	ages.<span style="color: #000000;">add</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">31</span><span style="color: #000000;">&#41;</span>; 	ages.<span style="color: #000000;">add</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">32</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Attention, size() renvoie le nombre total d'éléments dans la collection</span> 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">7</span>, ages.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	<span style="color: #808080; font-style: italic;">// Pour obtenir la taille du Set, utiliser entrySet().size()</span> 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">4</span>, ages.<span style="color: #000000;">entrySet</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// comptage des occurrences</span> 	assertEquals<span style="color: #000000;">&#40;</span>0, ages.<span style="color: #000000;">count</span><span style="color: #000000;">&#40;</span>0<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">2</span>, ages.<span style="color: #000000;">count</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">28</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">3</span>, ages.<span style="color: #000000;">count</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">30</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">1</span>, ages.<span style="color: #000000;">count</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">31</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">1</span>, ages.<span style="color: #000000;">count</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">32</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span></pre> <h4>BiMap</h4> <p>Une <code>Bimap</code> est une <code>Map</code> bidirectionnelle&nbsp;: on peut interroger ses clés pour récupérer les valeurs associées, et également interroger ses valeurs pour retrouver les clés associées.<br /><br />
Pour que ce soit possible, les valeurs ne doivent évidemment pas comporter de doublons.</p> <p>La méthode <code>inverse()</code> d'une <code>Bimap</code> permet d'en obtenir une vue symétrique, où clés et valeurs sont inversées. On peut ainsi interroger la collection sur ses valeurs, pour récupérer les clés associées.</p> <pre class="java code java" style="font-family:inherit">@Test <span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> bimap<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span> &nbsp; 	HashBiMap<span style="color: #000000;">&lt;</span>String, Integer<span style="color: #000000;">&gt;</span> daltonsSizeByName = HashBiMap.<span style="color: #000000;">create</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	daltonsSizeByName.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Joe&quot;</span>, <span style="color: #cc66cc;">1</span><span style="color: #000000;">&#41;</span>; 	daltonsSizeByName.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Jack&quot;</span>, <span style="color: #cc66cc;">2</span><span style="color: #000000;">&#41;</span>; 	daltonsSizeByName.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;William&quot;</span>, <span style="color: #cc66cc;">3</span><span style="color: #000000;">&#41;</span>; 	daltonsSizeByName.<span style="color: #000000;">put</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Averell&quot;</span>, <span style="color: #cc66cc;">4</span><span style="color: #000000;">&#41;</span>; &nbsp; 	<span style="color: #808080; font-style: italic;">// Inverse map</span> 	BiMap<span style="color: #000000;">&lt;</span>Integer,String<span style="color: #000000;">&gt;</span> daltonsNameBySize = daltonsSizeByName.<span style="color: #000000;">inverse</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span>daltonsSizeByName.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, daltonsNameBySize.<span style="color: #000000;">size</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span>daltonsNameBySize.<span style="color: #000000;">keySet</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, daltonsSizeByName.<span style="color: #000000;">values</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span>daltonsNameBySize.<span style="color: #000000;">values</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, daltonsSizeByName.<span style="color: #000000;">keySet</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">1</span>, <span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">int</span><span style="color: #000000;">&#41;</span> daltonsSizeByName.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Joe&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; 	assertEquals<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Joe&quot;</span>, daltonsNameBySize.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>; &nbsp; <span style="color: #000000;">&#125;</span></pre> <h3>Conclusion</h3> <p>Grâce aux Fonctions et aux Prédicats, Guava introduit des éléments de programmation fonctionnelle dans Java, et permet de capturer des algorithmes dans des composants réutilisables.</p> <p>Si l'intérêt des méthodes <em>factory</em> dans les classes <code>Lists</code>, <code>Sets</code> etc. peut sembler limité depuis l'avènement de Java 7 et de la notation "en diamant", les autres méthodes fournies par ces classes rendent toujours bien service.</p> <p>Dans un troisière article, je vous présenterai certaines fonctionnalités intéressantes de Guava dans le domaine de la gestion des I/O et du multithreading. Stay tuned&nbsp;!</p>