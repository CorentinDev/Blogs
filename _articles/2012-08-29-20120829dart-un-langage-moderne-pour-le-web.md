---
ID: 447
post_title: Dart, un langage moderne pour le web
author: jvey
post_date: 2012-08-29 09:30:00
post_excerpt: |
  <p><img src="/public/Billet_0370/Dart-logo.png" alt="Logo Dart" style="display:block; margin:0 auto;" title="Logo Dart" /> <br />
  <br /></p> <p>Dart est un langage de programmation Open Source, lancé en octobre 2011 par Google. Contrairement à d’autres langages qui ont pu apparaître ces derniers temps, Dart n’a pas comme cible principale le développement serveur mais vise bel et bien à concurrencer Javascript dans nos navigateurs.</p> <p>Tout d’abord, de quoi est composé Dart&nbsp;? D’une spécification du langage, de librairies dont notamment dart:html pour manipuler le dom, dart:json pour interagir avec des objets json, dart:math, etc. Dart c’est aussi une machine virtuelle standalone pour s'exécuter en dehors d’un navigateur, un éditeur, basé sur l’IDE Eclipse, une version du navigateur chromium embarquant une vm dart, surnommé Dartium, et enfin un compilateur Dart vers Javascript.</p> <p>Dart fournit une VM standalone, afin de permettre de développer non seulement des applications tournant dans un navigateur mais des applications s'exécutant sur le serveur. On pourrait ainsi imaginer développer des applications entières dans un seul langage, ce qui est généralement apprécié par les développeurs (c.f. GWT).</p>
layout: post
permalink: http://blog.zenika-offres.com/?p=447
published: true
slide_template:
  - ""
---
<p><img src="/wp-content/uploads/2015/07/Dart-logo.png" alt="Logo Dart" style="display:block; margin:0 auto;" title="Logo Dart" /> <br />
<br /></p> <p>Dart est un langage de programmation Open Source, lancé en octobre 2011 par Google. Contrairement à d’autres langages qui ont pu apparaître ces derniers temps, Dart n’a pas comme cible principale le développement serveur mais vise bel et bien à concurrencer Javascript dans nos navigateurs.</p> <p>Tout d’abord, de quoi est composé Dart&nbsp;? D’une spécification du langage, de librairies dont notamment dart:html pour manipuler le dom, dart:json pour interagir avec des objets json, dart:math, etc. Dart c’est aussi une machine virtuelle standalone pour s'exécuter en dehors d’un navigateur, un éditeur, basé sur l’IDE Eclipse, une version du navigateur chromium embarquant une vm dart, surnommé Dartium, et enfin un compilateur Dart vers Javascript.</p> <p>Dart fournit une VM standalone, afin de permettre de développer non seulement des applications tournant dans un navigateur mais des applications s'exécutant sur le serveur. On pourrait ainsi imaginer développer des applications entières dans un seul langage, ce qui est généralement apprécié par les développeurs (c.f. GWT).</p>
<!--more-->
<p>Attention, Dart est encore une “technology preview”, il est donc susceptible de changer. Cependant, sa sortie précoce devrait permettre de recueillir le maximum de feedbacks de la communauté.</p> <h3>Les objectifs de Google avec Dart</h3> <p>Le premier objectif visé est de fournir des applications webs modernes (offline, html5...) sur l’ensemble des plateformes existantes (desktop, laptop, smartphones, tablettes...). Pour cibler toutes ces plateformes, Dart fournit un compilateur Dart vers Javascript, afin d'être compatible avec tous les navigateurs du marché, même ceux n'intégrant pas de VM Dart.</p> <p>Le développement web prend une place de plus en plus importante, les navigateurs sont de plus en plus en puissants et rapides et l'intégration à l’OS s'améliore (GPU, accès aux fonctionnalités natives...). La multiplication des smartphones incite également les développeurs d’applications mobiles à envisager le web, notamment pour réduire les coûts de développement de multiples applications natives.</p> <p>Partant de ce constat, Google considère donc que le développement web devrait être facilité, en s’appuyant notamment ici sur les faiblesses de Javascript. Dart vise à mieux structurer les programmes, permettre un meilleur outillage (ide, debug...), ainsi que faciliter le partage de code entre différents frameworks. Dart se veut un langage simple, facilement accessible à des développeurs de tous horizons, et arrive donc comme une alternative pour le développement web actuel, une option supplémentaire pour les développeurs.</p> <h3>Le langage Dart</h3> <p>Dart est un langage orienté objet, à base de classes, avec héritage simple, interfaces, génériques et permettant l'écriture de closures . Le typage est statique mais optionnel. Dart est mono-thread mais fournit un modèle de programmation pour gérer la concurrence, les Isolate. Voilà pour les lecteurs pressés.</p> <p>Pour les autres, je vais tout d'abord vous parler du typage dans Dart, qui peut surprendre au début, un typage optionnel, et nous développerons ensuite certaines fonctionnalités du langage.</p> <h4>Le typage optionnel</h4> <p>Avec Dart, vous pouvez écrire une application entière sans jamais définir un seul type pour vos variables. Au contraire, vous pouvez tout typer si vous le souhaitez. Le typage porte donc bien son nom, "optionnel". Ce qu'il faut bien avoir à l'esprit est que les types ne seront jamais vérifiés au runtime. il ne servent donc que pour la documentation, rendre le code plus facile à comprendre pour les développeurs, mais surtout pour les outils de développement, avoir des feedbacks d'erreur et de warning beaucoup plus rapides. Vos IDE pourront prendre en compte les types et vous afficher des messages explicites sans attendre la phase d’exécution. Pourquoi Google a-t-il fait ce choix original pour le typage&nbsp;? Pour permettre une adoption massive par le plus grand nombre de développeurs, qu'ils soient habitués au typage statique ou au typage dynamique, Dart leur paraîtra familier.</p> <p>Pour l'exemple, les deux méthodes suivantes sont strictement équivalentes.</p> <pre class="java code java" style="font-family:inherit">multiply<span style="color: #000000;">&#40;</span>x, factor<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>   <span style="color: #7F0055; font-weight: bold;">return</span> x <span style="color: #000000;">*</span> factor; <span style="color: #000000;">&#125;</span></pre> <pre class="java code java" style="font-family:inherit">multiply<span style="color: #000000;">&#40;</span>num x, num factor<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>   <span style="color: #7F0055; font-weight: bold;">return</span> x <span style="color: #000000;">*</span> factor; <span style="color: #000000;">&#125;</span></pre> <p>Et maintenant un peu de code afin de présenter certaines des fonctionnalités intéressantes de Dart.</p> <p>Note&nbsp;: La plupart des exemples qui suivent sont extraits de <a href="http://www.dartlang.org/docs/language-tour/">http://www.dartlang.org/docs/language-tour/</a></p> <h4>Codons&nbsp;!</h4> <h5>Les constructeurs nommés</h5> <p>Tout d'abord, prenons une classe Point classique avec un seul constructeur</p> <pre class="java code java" style="font-family:inherit"><span style="color: #7F0055; font-weight: bold;">class</span> <span style="color: #000000;">Point</span> <span style="color: #000000;">&#123;</span>   num x, y; &nbsp;   <span style="color: #808080; font-style: italic;">// Syntactic sugar for this.x = x and this.y = y</span>   <span style="color: #000000;">Point</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">this</span>.<span style="color: #000000;">x</span>, <span style="color: #7F0055; font-weight: bold;">this</span>.<span style="color: #000000;">y</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span></pre> <p>Notez la façon d'assigner les paramètres du constructeur aux variables d'instance.</p> <p>Dart permet de rajouter des constructeurs nommés. Ainsi vous pouvez avoir deux constructeurs avec la même signature mais différenciés par leur nom. Cela permet également de documenter chaque constructeur sur son utilisation.</p> <pre class="java code java" style="font-family:inherit"><span style="color: #7F0055; font-weight: bold;">class</span> <span style="color: #000000;">Point</span> <span style="color: #000000;">&#123;</span>   num x, y; &nbsp;   <span style="color: #808080; font-style: italic;">// Named constructor</span>   <span style="color: #000000;">Point</span>.<span style="color: #000000;">fromJson</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">Map</span> json<span style="color: #000000;">&#41;</span> : x = json<span style="color: #000000;">&#91;</span><span style="color: #888888;">'x'</span><span style="color: #000000;">&#93;</span>, y = json<span style="color: #000000;">&#91;</span><span style="color: #888888;">'y'</span><span style="color: #000000;">&#93;</span>; &nbsp;   <span style="color: #000000;">Point</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">this</span>.<span style="color: #000000;">x</span>, <span style="color: #7F0055; font-weight: bold;">this</span>.<span style="color: #000000;">y</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span></pre> <p>Dans cet exemple, on ajoute un constructeur nommé fromJson qui comme son nom l'indique va construire un point à partir d'une source Json, ici un objet Map. Et voici le code permettant d'appeler ce constructeur.</p> <pre class="java code java" style="font-family:inherit">var jsonData = JSON.<span style="color: #000000;">parse</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">'{&quot;x&quot;:1, &quot;y&quot;:2}'</span><span style="color: #000000;">&#41;</span>; var point = <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">Point</span>.<span style="color: #000000;">fromJson</span><span style="color: #000000;">&#40;</span>jsonData<span style="color: #000000;">&#41;</span>;</pre> <h5>Les parametres optionnels</h5> <p>Chaque constructeur et chaque méthode peuvent posséder un ou plusieurs paramètres dit optionnels. Les paramètres entre [ ] sont optionnels.</p> <p>dans l'exemple suivant, la méthode myMethod comporte deux paramètres obligatoires et un paramètre optionnel. On peut voir dans le <code>main</code> les différentes manières d'appeler cette méthode. Dans le cas où une méthode comporte plusieurs paramètres optionnels, il est possible de nommer explicitement les paramètres que l'on souhaite passer lors de l'appel, comme dans le troisième exemple de la méthode <code>main</code>.</p> <pre class="java code java" style="font-family:inherit"><span style="color: #000000;">String</span> myMethod<span style="color: #000000;">&#40;</span><span style="color: #000000;">String</span> param1, <span style="color: #000000;">Strin
g</span> param2, <span style="color: #000000;">&#91;</span><span style="color: #000000;">String</span> optionalParam<span style="color: #000000;">&#93;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>   var result = <span style="color: #888888;">&quot;$param1:$param2&quot;</span>;   <span style="color: #7F0055;font-weight: bold;">if</span> <span style="color: #000000;">&#40;</span>optionalParam <span style="color: #000000;">!</span>= <span style="color: #7F0055; font-weight: bold;">null</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>     result = <span style="color: #888888;">&quot;$result:$optionalParam&quot;</span>;   <span style="color: #000000;">&#125;</span>   print<span style="color: #000000;">&#40;</span>result<span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span> &nbsp; main<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#123;</span>   myMethod<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;a&quot;</span>, <span style="color: #888888;">&quot;b&quot;</span><span style="color: #000000;">&#41;</span>;                                 <span style="color: #808080; font-style: italic;">//prints a:b</span>   myMethod<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;a&quot;</span>, <span style="color: #888888;">&quot;b&quot;</span>, <span style="color: #888888;">&quot;c&quot;</span><span style="color: #000000;">&#41;</span>;                            <span style="color: #808080; font-style: italic;">//prints a:b:c</span>   myMethod<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;a&quot;</span>, <span style="color: #888888;">&quot;b&quot;</span>, optionalParam : <span style="color: #888888;">&quot;c&quot;</span><span style="color: #000000;">&#41;</span>;            <span style="color: #808080; font-style: italic;">//prints a:b:c</span> <span style="color: #000000;">&#125;</span></pre> <h5>Les closures</h5> <p>Tout comme en Javascript, avec Dart, une fonction est un objet. Il est donc possible de stocker une fonction dans une variable, de passer une fonction en paramètre d'une autre fonction... Voici un exemple classique d'utilisation des closures, qui nous permet également de voir la méthode forEach sur l'objet List. La méthode forEach prend en paramètre une fonction qui sera appliquée à chaque élément de la liste.</p> <pre class="java code java" style="font-family:inherit">list.<span style="color: #7F0055;font-weight: bold;">forEach</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#40;</span>element<span style="color: #000000;">&#41;</span> =<span style="color: #000000;">&gt;</span> print<span style="color: #000000;">&#40;</span>element<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</pre> <h5>String interpolation</h5> <p>Il est possible avec Dart de définir des valeurs directement à l'intérieur d'une chaîne de caractères à l'aide du symbole $, ce qui s'avère vraiment très pratique à l'usage. Dans les changements en vue de la milestone 1 de Dart, l'opérateur + sur les <code>String</code> a été enlevé (donc plus possible de faire <code>var s = "Hello "+"Julien"</code>. Pour faire cela, il faut soit passer par l'interpolation quand nos <code>String</code> sont des variables, soit utiliser la concaténation adjacente). Rien de mieux qu'un exemple&nbsp;:</p> <pre class="java code java" style="font-family:inherit">var name = <span style="color: #888888;">&quot;Julien&quot;</span>; print<span style="color: #000000;">&#40;</span><span style="color: #888888;">'Hello '</span><span style="color: #888888;">'Julien'</span><span style="color: #888888;">' !!'</span><span style="color: #000000;">&#41;</span>;  <span style="color: #808080; font-style: italic;">// prints : Hello Julien !!</span> print<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Hello $name&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #808080; font-style: italic;">// prints : Hello Julien</span> print<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Hello ${name.toUpperCase()}&quot;</span><span style="color: #000000;">&#41;</span>; <span style="color: #808080; font-style: italic;">// prints : Hello JULIEN</span></pre> <p><em>Attention, la concaténation de String adjacente ne fonctionne pas sur try.dartlang.org mais fonctionne correctement dans l’éditeur</em></p> <p>Voici donc un panel minimal des fonctionnalités de Dart. Pour un aperçu beaucoup plus complet du langage, je vous invite à regarder <a href="http://www.dartlang.org/docs/language-tour/">A Tour of the Dart Language</a>.</p> <h4>Les librairies</h4> <p>Dart fournit un ensemble de librairies complémentaires, l'ensemble des fonctionnalités est documentée dans <a href="http://www.dartlang.org/docs/library-tour/">A Tour of the Dart Librairies</a>. Je vais simplement présenter les plus importantes dans cette section</p> <h5>dart:core</h5> <p>Dart Core contient l'ensemble des classes et utilitaires de base pour la gestion des collections, des dates, des chaines de caractères, des nombres... cette librairie est importée par défaut dans chaque application Dart.</p> <h5>dart:html</h5> <p>La librairie html permet la manipulation du DOM. Par exemple, la recherche d'éléments du DOM de façon simplifiée (semblable à JQuery)</p> <pre class="java code java" style="font-family:inherit">#<span style="color: #a1a100;">import('dart:html');</span> &nbsp; var elem1 = query<span style="color: #000000;">&#40;</span><span style="color: #888888;">'#id'</span><span style="color: #000000;">&#41;</span>;               <span style="color: #808080; font-style: italic;">// Find an element by id.</span> var elem2 = query<span style="color: #000000;">&#40;</span><span style="color: #888888;">'.class'</span><span style="color: #000000;">&#41;</span>;            <span style="color: #808080; font-style: italic;">// Find an element by class.</span> var elems1 = queryAll<span style="color: #000000;">&#40;</span><span style="color: #888888;">'div'</span><span style="color: #000000;">&#41;</span>;           <span style="color: #808080; font-style: italic;">// Find all elements by tag.</span> var elems2 = queryAll<span style="color: #000000;">&#40;</span><span style="color: #888888;">'[data-role=&quot;button&quot;]'</span><span style="color: #000000;">&#41;</span>; <span style="color: #808080; font-style: italic;">// Find button widgets.</span></pre> <p>Il est bien évidemment possible de faire toutes les manipulations de DOM classiques&nbsp;: créer des éléments, ajouter des noeuds à des éléments, etc... L'exemple suivant montre la façon de gérer les évènements sur un élément html, ici, nous ajoutons un handler sur un click de myButton</p> <pre class="java code java" style="font-family:inherit">myButton.<span style="color: #000000;">on</span>.<span style="color: #000000;">click</span>.<span style="color: #000000;">add</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#40;</span>e<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span>   <span style="color: #808080; font-style: italic;">// When the button is clicked, it runs this code.</span>   submitData<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; <span style="color: #000000;">&#125;</span><span style="color: #000000;">&#41;</span>;</pre> <p>ou de façon plus concise</p> <pre class="java code java" style="font-family:inherit">myButton.<span style="color: #000000;">on</span>.<span style="color: #000000;">click</span>.<span style="color: #000000;">add</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#40;</span>e<span style="color: #000000;">&#41;</span> =<span style="color: #000000;">&gt;</span> submitData<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;
">&#41;</span>;</pre> <h5>dart:isolate</h5> <p>Les <code>Isolate</code> sont une partie importante de Dart. Il s'agit du modèle pour la programmation concurrente (Pour les interessés, ce modèle est inspiré d'Erlang). Tout code Dart est exécuté au sein d'un <code>Isolate</code>. Il est donc possible de créer d'autres <code>Isolate</code>, pour gérer la concurrence ou tout simplement pour exécuter du code d'une librairie tierce. Une chose importante à retenir, les <code>Isolate</code> ne partagent aucun état, aucun espace mémoire, leur seul moyen de communication est par passage de messages. Lors de la compilation en Javascript, ils sont compilés en WebWorkers HTML5.</p> <p>Après avoir découvert le langage, nous venons maintenant de voir quelques unes des librairies fournies par Dart. Nous allons maintenant nous intéresser aux différentes façons de faire tourner une application Dart.</p> <h3>Comment exécuter une application Dart</h3> <h4>Sur le serveur</h4> <p>Dart fournit une machine virtuelle standalone capable d'être lancée en ligne de commande.  Cette VM permet d'accéder aux fichiers, répertoires, gérer des sockets, lancer un serveur HTTP, un serveur websockets... Comme déjà mentionné, on peut ainsi imaginer dans le futur développer la partie serveur de notre application entièrement en Dart, et réutiliser le code pour la partie cliente.</p> <h4>Dans le navigateur, nativement</h4> <p>Les ingénieurs de Dart ont intégré dans un build spécial de Chromium une VM Dart. Cette version est communément appelée Dartium. Elle permet d'executer nativement une application Dart en appelant simplement le script depuis la page html ainsi&nbsp;:</p> <pre class="html code html" style="font-family:inherit"><span style="color: #009900;">&lt;<span style="color: #000000; font-weight: bold;">script</span> <span style="color: #000066;">type</span><span style="color: #66cc66;">=</span><span style="color: #ff0000;">&quot;application/dart&quot;</span> <span style="color: #000066;">src</span><span style="color: #66cc66;">=</span><span style="color: #ff0000;">&quot;app.dart&quot;</span>&gt;&lt;<span style="color: #66cc66;">/</span><span style="color: #000000; font-weight: bold;">script</span>&gt;</span></pre> <p>L'avantage de cette solution est de pouvoir débuguer directement dans votre navigateur.</p> <h4>Dans le navigateur, compilé en Javascript</h4> <p>Evidemment, tous les navigateurs du marché ne vont pas intégrer une VM Dart aussi rapidement que peut le faire l'équipe Chromium. C'est pourquoi une partie importante de Dart est la possibilité de compiler votre application en Javascript, sans aucune configuration,  et ainsi de l'exécuter sur n'importe quel navigateur moderne (tout comme peut le faire GWT ou CoffeeScript). Le compilateur permet de la même façon l'optimisation du code, l'élimination du code mort... Celui-ci est toujours en phase d'amélioration mais reste une priorité afin de faciliter l'adoption du langage.</p> <h3>Développer avec Dart</h3> <p>Comme Google ne fait généralement pas les choses à moitié, ils fournissent également un éditeur complet basé sur Eclipse, le Dart Editor. Cette éditeur arrive avec tout un tas de fonctionnalités, complétion du code, refactoring, debug dans l'IDE, compilation vers javascript...</p> <p>Et enfin pour vous aider à démarrer, plusieurs ressources utiles</p> <ul> <li><a href="api.dartlang.org">api.dartlang.org</a>&nbsp;: la description complète de l'API Dart</li> <li><a href="synonym.dartlang.org">synonym.dartlang.org</a>&nbsp;: un ensemble de pattern Javascript traduit en Dart</li> <li><a href="http://www.dartlang.org/docs/language-tour/">A Tour of the Dart Language</a>&nbsp;: La documentation du langage</li> <li><a href="http://www.dartlang.org/docs/library-tour/">A Tour of the Dart Librairies</a>&nbsp;: La documentation des librairies</li> <li><a href="try.dartlang.org">try.dartlang.org</a>&nbsp;: un éditeur en ligne qui permet d'écrire et d'exécuter du code Dart dans votre navigateur sans rien installer</li> </ul> <h3>Conclusion</h3> <p>Dart est encore une "technology preview", le langage et les librairies sont donc susceptibles de changer avant la première release. Certains points sont par exemple en cours de développement comme le support de la réflexion et d'autres encore en discussion comme l'ajout des mixin au language (voir <a href="http://news.dartlang.org/2012/08/darts-modest-proposal-for-mixins.html">cet article</a> de Gilad Bracha). La première version, Milestone 1 est en cours de finalisation.</p> <p>J’espère avec cet article vous avoir convaincu du potentiel de Dart. Google investit beaucoup dans ce nouveau langage, on retrouve parmi les créateurs du langage et les membres actuels de l’équipe certaines têtes connues (Joshua Bloch, Gilad Bracha, David Chandler...), on peut également voir le nombre de sessions Dart au dernier Google I/O, alors que le langage a moins d'un an. Enfin, la communauté Dart, déjà importante, ne cesse de grandir et de se diversifier, avec par un exemple un podcast nommé <a href="http://www.dartlang.org/dartisans/">Dartisan</a>, animé par Seth Ladd, qui permet de se tenir au courant des dernières nouveautés, ou encore <a href="https://plus.google.com/109866369054280216564">la page Google+</a> du langage. Enfin, pour les francophones, je vous conseille la page Google+ non-officielle mais très active <a href="http://gplus.to/dartlangfr">dartlangfr</a></p>