---
ID: 438
post_title: 'Grails 2.0 &#8211; Nouveautés et retours d&#039;expériences'
author: mboillod
post_date: 2011-12-16 08:35:00
post_excerpt: "<p>Moins attendu que Spring 3.1 mais pourtant tellement lié, <strong>Grails 2.0 est sorti hier</strong>.</p> <p>Mon équipe et moi même étions impatient car la sortie de cette version majeure était planifiée depuis plusieurs mois mais sans cesse retardée pour attendre la release finale (GA) de spring 3.1. Cela fait en effet déjà deux mois que je travaille sur la béta, puis les releases candidates, mais sortir un produit basé sur une RC, c'est pas sérieux.</p> <p>Développeur Grails depuis 3 ans, je vais vous détailler les nouveautés les plus marquantes de Grails 2.0 et de son écosystème en essayant d'aller un peu plus loin que ce qu'on peut trouver habituellement dans les RELEASES NOTES.</p>"
layout: post
permalink: http://blog.zenika-offres.com/?p=438
published: true
---
<p>Moins attendu que Spring 3.1 mais pourtant tellement lié, <strong>Grails 2.0 est sorti hier</strong>.</p> <p>Mon équipe et moi même étions impatient car la sortie de cette version majeure était planifiée depuis plusieurs mois mais sans cesse retardée pour attendre la release finale (GA) de spring 3.1. Cela fait en effet déjà deux mois que je travaille sur la béta, puis les releases candidates, mais sortir un produit basé sur une RC, c'est pas sérieux.</p> <p>Développeur Grails depuis 3 ans, je vais vous détailler les nouveautés les plus marquantes de Grails 2.0 et de son écosystème en essayant d'aller un peu plus loin que ce qu'on peut trouver habituellement dans les RELEASES NOTES.</p>
<!--more-->
<h3>Upgrade des librairies</h3> <p>On y échappe pas, c'est le cas à chaque version de Grails, les librairies utilisées sont toujours mises à jour et on a le droit maintenant à Groovy 1.8, Spring 3.1 (ça on sait), Hibernate 3.6, Serlvet 3.0...</p> <h3>Vers le développement continu</h3> <p>Pour ce qui est du développement, Grails 2.0 propose un meilleur rechargement à chaud de nos modifications et permet donc de travailler plus longtemps sans redémarrer l'application.</p> <p>Concrètement, les principales causes de redémarrage sont liés à des modifications des objets du domaine (le modèle de données), car même si elles sont généralement prises en compte à chaud, la reconstruction de la base de données vide les tables des données de test qui sont généralement ajoutées au lancement de l'application via la classe <code>Boostrap.groovy</code>.</p> <p>Petit astuce au passage, le <strong>plugin fixture</strong> permet de gérer de façon élégante les données de tests, que ce soit pour votre application en mode développement ou pour vos tests (unitaires, intégration, fonctionnel) - <a href="http://grails.org/plugin/fixtures" title="http://grails.org/plugin/fixtures">http://grails.org/plugin/fixtures</a></p> <h3>Du nouveau dans les ressources</h3> <h4>Utilisation de jquery</h4> <p>Un des fait marquant de la version 2.0 est l'intégration par défaut de <strong>jquery</strong> à la place de prototype, mais derrière tout cela se cache une refonte complète de la gestion des ressources.</p> <p>Le plugin <a href="http://grails.org/plugin/jquery-ui">jquery-ui</a> complète d'ailleurs très bien l'intégration de jquery dans votre application.</p> <h4>Nouveau plugin resource inclu dans Grails</h4> <p>Grails vient avec de <strong>nouvelles balises <code>&lt;r:&gt;</code> qui optimisent la gestion des resources</strong> (images, css, js, ..) en évitant les chargements multiples ou facilite la gestion du code javascript propre à chaque page.</p> <p>Par exemple la balise <code>&lt;r:script&gt;</code> ajoute par défaut le contenu javascript en fin de page HTML pour améliorer le temps de chargement dans les navigateurs.</p> <p><ins>Note:</ins> C'est d'ailleurs un principe qu'on retrouve partout dans Grails, souvent sans s'en rendre compte, celui de <strong>mettre en place les meilleurs pratiques</strong> à tous les niveaux de l'application.</p> <p>Pour finir sur les resources, ce nouveau système ouvre la voie à de nombreuses fonctionnalités telles que la compression des resources, la gestion de bundle, etc.</p> <h3>Du choix au niveau de la Persistance</h3> <h4>H2 à la place de HSQL</h4> <p>Petit changement mais qui a son importance, avec H2 embarquée, une application Grails en mode développement permet d'accéder automatiquement à la <strong>console d'administration de la base h2</strong> (affichage des tables, requêtes SQL, ...) en accédant simplement à l'url <a href="http://localhost:8080/application/dbconsole">http://localhost:8080/application/dbconsole</a>   <em>(Prêt à l'emploi !)</em></p> <h4>Des solutions avec GORM</h4> <p>Grails 2.0 (et son architecture interne basée elle même sur des plugins) permet de remplacer la solution de persistance classique (Hibernate) par d'autres solutions, telles que JPA, MyBatis et le monde NoSQL est loin d'être oublié avec Redis, MongoDb, Gemfire et bien d'autres.</p> <p>Et beaucoup de ces plugins sont supportés par SpringSource ce qui est un gage de qualité certain. En effet <a href="http://graemerocher.blogspot.com/">Graeme Rocher</a>, le tech leader de Grails est responsable également d'un projet ambitieux concernant le support de très nombreuses solutions de gestion de données. Parce que la liste est trop longue et que je vous laisse la découvrir par vous même, je ne vais pas vous la détailler, mais vous pouvez la consulter directement le github du projet <a href="https://github.com/SpringSource/grails-data-mapping">https://github.com/SpringSource/grails-data-mapping</a></p> <h4>Multi-datasource</h4> <p>Mieux encore, GORM, l'ORM de Grails permet maintenant d'<strong>utiliser plusieurs datasources très facilement</strong>. Il suffit de déclarer une ou plusieurs datasource supplémentaires dans le fichier <code>DataSource.groovy</code> et de préciser au niveau des domaines quel datasource utiliser&nbsp;:</p> <pre class="java code java" style="font-family:inherit"><span style="color: #7F0055; font-weight: bold;">class</span> Comment <span style="color: #000000;">&#123;</span>    <span style="color: #000000;">String</span> author    <span style="color: #000000;">String</span> comment &nbsp;    <span style="color: #7F0055; font-weight: bold;">static</span> mapping = <span style="color: #000000;">&#123;</span>       datasource <span style="color: #888888;">'social'</span>    <span style="color: #000000;">&#125;</span> <span style="color: #000000;">&#125;</span></pre> <p>On peut ainsi utiliser deux bases relationnelles ou mixer une base relationnelle avec une base NoSQL ou tout autre configuration.</p> <h3>La face cachée de l'Iceberg</h3> <p>Comme beaucoup de développeur passionné, j'aime regarder ce qui se passe à l'<strong>intérieur d'un framework</strong> pour comprendre comment cela fonctionne ou mieux, trouver des fonctionnalités non documentées.</p> <p>En regardant les classes de Grails, on remarque qu'il y a eu <strong>énormément de travail de refactoring</strong> depuis la version 1.3. Les raisons sont nombreuses mais en voici quelques une en vrac&nbsp;:</p> <ul> <li>améliorer l'architecture interne en plugin</li> <li>permettre de remplacer plus facilement un plugin par un autre et notamment tout ce qui concerne la persistance</li> <li>séparer clairement les responsabilités (binding, validation, persistance, ...)</li> <li>faciliter l'intégration dans les IDE</li> <li>parce que <strong>le refactoring c'est essentiel</strong> quand un projet grossi</li> </ul> <p>Un exemple qui caractérise bien cela est la classe <code>org.codehaus.groovy.grails.plugins.web.api.ControllersApi</code> qui regroupe toutes les méthodes ajoutés par Grails au niveau des controlleurs MVC.</p> <h3>Les plugins&nbsp;!</h3> <h4>Grails Market</h4> <p>On est encore loin des markets Android ou Apple, mais Grails dispose aujourd'hui de plus de 700 plugins disponibles dans le repository officiel, et on peut en trouver bien d'autres sur github notamment.</p> <p>Bonne nouvelle, les plugins officiellement maintenu par SpringSource sont déjà <strong>compatibles avec la version 2.0 de Grails</strong>. On retrouve donc le plugin spring-security-core et ses dépendances (ui, acl, OpenID, LDAP, ...), mais aussi les plugins de persistance cités ci-dessus (JPA, MongoDB, Redis, ...) et des plugins plus anciens mais toujours utiles (Quartz, WebService, Mail).</p> <h4>Cloud Ready</h4> <p>Grails n'est pas resté à l'écart de cette mouvance et les plugins <strong>Cloud Foundry Integration</strong> ou <strong>App Engine</strong> permettent de les déployer en un clic&nbsp;!</p> <p>Heroku vient d'ailleurs d'annoncer le support de Grails sur sa plateforme <a href="http://blog.heroku.com/archives/2011/12/15/grails/">http://blog.heroku.com/archives/2011/12/15/grails/</a></p> <h3>L'IDE</h3> <p><em>"Que serait un bon framework sans un bon IDE ?"</em> Personnellement, je pense que cet adage se rapproche beaucoup de celui-ci&nbsp;: <em>"Que serait un bon langage sans compilateur ?"</em></p> <p>Utilisateur depuis des années d'Eclipse, je ne vous parlerai que de STS, mais Grails est supporté également par IntelliJ et Netbeans.</p> <p>Depuis maintenant plus de trois ans, Springsource fourni beaucoup d'efforts pour <strong>améliorer</strong> sans cesse le <strong>support de Groovy et de Grails</strong> dans son IDE, SpringSource Tools Suite (STS).</p> <p>Outre le support de groovy, STS intègre des wizards pour l'utilisation des commandes Grails ou la gestion des plugins (installation, désinstallation, mise à niveau), Toujours plus étonnant, STS supporte également la complétion sur les fameux <strong>dynamicFinder</strong> de Grails qui permettent d'exécuter des requêtes SQL uniqueme
nt à partir du nom de la méthode. En voici un exemple issu de la doc officielle&nbsp;:</p> <pre class="java code java" style="font-family:inherit">def results = <span style="color: #000000;">Book</span>.<span style="color: #000000;">findAllByTitleIlike</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;%Hobbit%&quot;</span><span style="color: #000000;">&#41;</span></pre> <p>STS supporte également les DSL groovy et la <strong>complétion des tag Grails dans les GSP</strong>. Cette dernière fonctionnalité, basée sur une convention de nommage des commentaires au niveau des tags Groovy est extrêmement pratique et je vous encourage fortement à l'utiliser sur tous les tags que vous créerez dans vos projets ou plugins.</p> <h3>Mais encore</h3> <p>Au niveau des autres améliorations majeures, on trouve également&nbsp;:</p> <ul> <li>le support HTML 5 au niveau du scaffolding</li> <li>un nouvelle console pour l'exécution des commandes Grails</li> <li>une meilleure gestion des erreurs affichées dans le navigateur avec des informations de debug au niveau des GSP, controlleur, exception, ...</li> <li>une solution pour gérer les montées de version de la base de données <em>(que je ne préfère pas utiliser au profit d'un vrai outil de modélisation)</em></li> <li>des tests unitaires et d'intégration plus avancés et plusieurs solutions de tests fonctionnels</li> <li>une <strong>amélioration continue de la documentation</strong>, utile par exemple lorsqu'il s'agit d'installer un repository d'entreprise pour déployer et gérer vos plugins Grails</li> </ul> <h3>Au final</h3> <p>Certes, il est impossible d'être complet tant il y a de nouveautés. Je dirai plutôt <strong>d'améliorations</strong>, car venant de Grails 1.2 ou 1.3, on n'est pas dépaysé, <strong>tout est dans la continuité</strong>, et on en découvre un peu plus tous les jours.</p> <p>J'espère que cet aperçu vous a donné envie d'aller voir plus loin ce qui se cache derrière Grails 2.0.</p> <p>Vous trouverez plus de détail sur l'<a href="http://blog.springsource.org/2011/12/15/grails-2-0-released/">annonce officielle de sortie sur le blog de springsource</a> et également dans la documentation officielle de Grails.</p> <p>Bon développement et joyeuses fêtes de fin d'années.</p>