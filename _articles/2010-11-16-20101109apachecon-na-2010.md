---
ID: 289
post_title: >
  Gros plan sur la conférence ApacheCon
  NA 2010
author: ffornaciari
post_date: 2010-11-16 09:57:00
post_excerpt: |
  <p>Début novembre s'est tenue la 11ième édition de la conférence <a href="http://na.apachecon.com/c/acna2010/">ApacheCon North America 2010</a> à Atlanta (GA). Cet évènement incontournable dans le milieu de l'open-source a eu lieu dans un des hôtels les plus imposants de la ville. Se sont réunis des membres de la Fondation Apache, des commiters, des contributeurs ou simplement des utilisateurs désireux de connaître les dernières nouveautés. Les projets ou les technologies phares comme <a href="http://tomcat.apache.org/">Tomcat</a>, <a href="http://lucene.apache.org/java/docs/index.html">Lucene</a> ou <a href="http://en.wikipedia.org/wiki/NoSQL">NoSQL</a> ont  bien évidemment été présentés mais également les tous derniers projets Apache encore au stade d'incubation. <br /><br />
  En plus d'être sur place pendant les trois jours de la conférence, j'ai eu le plaisir de présenter un sujet autour de l'intégration OSGi/Flex.</p>
layout: post
permalink: http://blog.zenika-offres.com/?p=289
published: true
---
<p>Début novembre s'est tenue la 11ième édition de la conférence <a href="http://na.apachecon.com/c/acna2010/">ApacheCon North America 2010</a> à Atlanta (GA). Cet évènement incontournable dans le milieu de l'open-source a eu lieu dans un des hôtels les plus imposants de la ville. Se sont réunis des membres de la Fondation Apache, des commiters, des contributeurs ou simplement des utilisateurs désireux de connaître les dernières nouveautés. Les projets ou les technologies phares comme <a href="http://tomcat.apache.org/">Tomcat</a>, <a href="http://lucene.apache.org/java/docs/index.html">Lucene</a> ou <a href="http://en.wikipedia.org/wiki/NoSQL">NoSQL</a> ont  bien évidemment été présentés mais également les tous derniers projets Apache encore au stade d'incubation. <br /><br />
En plus d'être sur place pendant les trois jours de la conférence, j'ai eu le plaisir de présenter un sujet autour de l'intégration OSGi/Flex.</p>
<!--more-->
<h2>La fondation Apache en quelques mots</h2> <p><br />
Plus qu'une infrastructure hébergeant des projets open-source, l'<a href="http://www.apache.org/">ASF</a> (Apache Software Foundation) est une communauté de développeurs et d'utilisateurs partageant des valeurs communes. Le dénominateur entre tous ces projets est bien sûr la <a href="http://www.apache.org/licenses/">licence Apache</a> (Apache Software License). <br /><br />
En quelques chiffres, la Fondation compte 330 membres et plus de 2500 commiteurs. Les commiteurs participent aux développements des projets et à la rédaction de la documentation. Les membres sont eux mêmes des commiteurs qui ont un pouvoir décisionnel. Ils participent notamment aux élections permettant d'introduire de nouveaux commiteurs. <br /><br />
Il y a actuellement une centaine de projets open-source considérés comme «&nbsp;Apache Top-level Projects (TLP) ». Qui n'a jamais entendu parler d'<a href="http://httpd.apache.org/">Apache HTTP Server</a>, de <a href="http://tomcat.apache.org/">Tomcat</a>, de <a href="http://subversion.apache.org/">Subversion</a> ou encore de <a href="http://maven.apache.org/">Maven</a>?</p> <h2>Programme de la conférence</h2> <p><br />
Les présentations se sont succédées sur trois jours, avec pour chaque jour, plusieurs sessions dédiées à un projet ou une technologie particulière. Voici une partie des sujets qui ont été abordés tout au long de la conférence et auxquels j’ai pu assister.</p> <h4>NoSQL</h4> <p>Ce thème permet de se familiariser avec les bases de données distribuées <a href="http://cassandra.apache.org/">Cassandra</a> et <a href="http://hbase.apache.org/">HBase</a> (nouvellement TLP) qui permettent de mieux répondre à des problématiques de montée en charge et de réplication par rapport aux bases de données relationnelles. <br /><br />
A noter la présentation du projet Solandra comme étant la combinaison du moteur de recherche <a href="http://lucene.apache.org/solr/">Solr</a> et de <a href="http://cassandra.apache.org/">Cassandra</a>. Les bénéfices résultant d'une telle intégration sont la prise en charge de la réplication des indexes, de la gestion du fail-over et de la haute disponibilité. <br /><br />
Encore assez peu connue ou parfois considérée comme une tendance, la technologie <a href="http://en.wikipedia.org/wiki/NoSQL">NoSQL</a> est une vraie réalité avec des acteurs majeurs comme Google, Facebook ou encore Twitter pour ne citer qu'eux qui l'emploient pour stocker et analyser des millions d'informations en temps réel. Ce sont ces mêmes acteurs qui contribuent aux projets open-source.</p> <h4>Content Technologies</h4> <p>Ce thème introduit un certain nombre de projets ayant pour objectif de faciliter la structuration des données et leur accès. On peut citer la présentation du projet <a href="http://sling.apache.org/site/index.html">Apache Sling</a> qui est un framework web basé sur OSGi permettant d'organiser du contenu en s'appuyant sur la spécification <a href="http://jcp.org/en/jsr/detail?id=170">JCR</a> (Java Content Repository). La lecture ou l'insertion de données dans le dépôt se fait au travers d'une API REST. Par défaut, l'implémentation de la <a href="http://jcp.org/en/jsr/detail?id=170">JCR</a> qui est utilisée est <a href="http://jackrabbit.apache.org/">Apache Jackrabbit</a>. <br /><br />
Dans un tout autre registre, si vous cherchez à lire ou produire des documents Microsoft Office (Excel, Word ou PowerPoint), le projet <a href="http://poi.apache.org/">Apache POI</a> répond peut-être à votre besoin. L'équivalent pour les fichiers PDF s'appelle <a href="http://pdfbox.apache.org/">Apache PDFBox</a>.</p> <h4>Hadoop</h4> <p><a href="http://hadoop.apache.org/">Apache Hadoop</a> permet de développer des applications hautement disponibles, supportant le passage à l'échelle et le calcul distribué. Durant les présentations, quelques problématiques pouvant être traitées avec Hadoop ont été abordées.</p> <h4>Tuscany</h4> <p><a href="http://tuscany.apache.org/">Apache Tuscany</a> est une implémentation de la spécification <a href="http://en.wikipedia.org/wiki/Service_Component_Architecture">SCA</a> (Service Component Architecture). Le but de ce standard est de déléguer la gestion des communications entre les différents modules métiers d'une application ou entre plusieurs applications. L'application est ainsi découpée en plusieurs composants qui requièrent ou exportent des services. Le protocole utilisé pour lier les composants entre eux est spécifié dans la configuration (WS, JMS, REST, JSON, JCA, ...). Il est également possible de définir la qualité de service, de sécuriser les échanges ou encore de travailler dans un environnement transactionnel. <br /><br />
Dans la perspective de construire des applications qui gèrent nativement le Cloud, la notion de service est primordiale tout comme la possibilité de distribuer facilement l'application.</p> <h4>Mahout</h4> <p><a href="http://mahout.apache.org/">Apache Mahout</a> fait parti des «&nbsp;Apache TLP&nbsp;» et propose une bibliothèque extensible pour le «&nbsp;machine learning&nbsp;» (apprentissage automatique) à partir de gros volumes de données. La distribution des traitements sur des clusters, le classement et le filtrage basé sur des batches collaboratifs sont implémentés grâce au projet Apache Hadoop. Concrètement, Mahout permet de faire des suggestions à partir des habitudes des utilisateurs ou de grouper des documents de même sujet. Dès lors qu’un certain nombre de documents sont catégorisés, il est ensuite possible de classer d’autres documents sans sujet explicite en parcourant leur contenu.</p> <h4>Geronimo</h4> <p>S’agissant des sessions liées au serveur d'applications <a href="http://geronimo.apache.org/">Apache Geronimo</a>, l'une d'elle, donnée par Jarek Gawor, détaillait la version 3.0 du serveur qui s'appuie désormais sur un noyau OSGi, tout comme la majorité des serveurs d'applications open-source tels que <a href="http://jonas.ow2.org/">JOnAS 5</a>, <a href="https://glassfish.dev.java.net/">GlassFish 3</a>, etc. <br /><br />
Cette dernière version implémentera la plupart des spécifications OSGi Enterprise qui ont pour objectif d'offrir aux applications OSGi une palette de services techniques issus du monde JavaEE tels que les services de persistance, de transaction, de nommage (pont entre JNDI et le Service Registry d'OSGi), ou encore d'administration du conteneur OSGi via JMX. <br /><br />
Comme le cœur du serveur est basé sur OSGi, cela offre également la possibilité de faire cohabiter des applications JavaEE avec des applications OSGi, voire même d'exploiter des services OSGi au sein d'applications JavaEE. Il est donc possible de développer des applications d'entreprise à la fois modulaires, dynamiques et robustes.</p> <h4>Tomcat</h4> <p>Plusieurs présentations ont traité de la nouvelle version de <a href="http://tomcat.apache.org/">Tomcat</a>, dont celle de Tim Funk qui a présenté les principales nouveautés présentes dans Tomcat 7.</p> <ul> <li>Détection des fuites mémoires et prévention de plusieurs cas possibles (connexions JDBC, threads non stoppés, ressources jamais fermées, …). Cette solution est décrite comme non optimale mais est sensée faire gagner du temps aux développeurs en phase de développement.</li> <li>Possibilité de faire référence à des ressources statiques (sur le disque) depuis le contexte de l’application. Jusqu’à présent, cela nécessitait l’utilisation d’un serveur HTTP Apache qui rendait disponible les ressources du système. Désormais l’attribut <em>alias</em> de l’élément Context permet de décrire ce mapping.</li> <li>Facilité de développement avec le support des servlets 3.0 <ul> <li>Le fichier web.xml devient optionnel et peut être remplacé par des POJOs annotés</li> <li>Utilisation des Web fragments pour séparer les descripteurs de déploiement des bibliothèques embarquées dans le WAR (web-fragment.xml) du descripteur de déploiement de l'application web (web.xml).</li> <li>Extension de l’API ServletContext afin de définir programmatiquement des servlets ou des filtres.</li> <li>Traitement asynchrone des Servlets afin de ne pas rendre bloquant l’accès à certaines ressources telles qu’une base de données ou un Web service.</li> </ul></li> <li>Meilleur support du lanceur Tomcat embarqué</li> <li>Amélioration de la sécurité</li> </ul> <h2>OSGi</h2> <p><br />
Durant la dernière journée de la conférence, un slot était entièrement consacré à <a href="http://www.osgi.org/Main/HomePage">OSGi</a>.</p> <h4>Building complex and modular applications with OSGi and Flex</h4> <p>Ma présentation propose une architecture permettant de construire des applications riches et modulaires en intégrant les technologies <a href="http://www.osgi.org/Main/HomePage">OSGi</a> et <a href="http://www.adobe.com/products/flex/">Flex</a>. La mise en œuvre d’une telle solution comporte deux parties distinctes. <br /><br />
La première chose à étudier est le moyen par lequel l’application Flex (côté client) va communiquer  avec le backend OSGi. Flex fournit une API permettant d’accéder à des services distants, comme par exemple des Web services ou des services accessibles au travers du protocole <a href="http://en.wikipedia.org/wiki/Action_Message_Format">AMF</a> (protocole binaire initialement créé par Adobe et qui est devenu un standard). L’idée étant de rendre disponible les services OSGi à l’application Flex et également d’établir un pont entre les évènements Flex et OSGi. Concernant ce deuxième cas de figure, un évènement émis par un bundle OSGi doit pouvoir être reçu par un consommateur Flex et inversement. <br /><br />
Le support des communications entre OSGi et Flex est apporté par l’utilisation d’une brique logicielle tierce&nbsp;: <a href="http://www.arum.co.uk/amf3osgi.php">AMF3 for OSGi</a>. Ce projet rend possible l’exposition de services OSGi au travers du protocole AMF. Le pattern publish/subscribe est également pris en charge afin d’être capable d’émettre et de recevoir des messages sur un topic donné, à la fois côté client et côté serveur. <br /><br />
La seconde partie concerne la modularisation complète de l’application. Flex dispose d’une solution de modularisation d’applications&nbsp;: les modules. Ce sont des sous parties de l’application qui peuvent être chargées ou déchargées à chaud. Dans cette perspective, un bundle OSGi correspondant à l’application globale est nécessaire. L’interface graphique qu’il contient (fichier SWF) décrit le squelette de l’application. Il enregistre également un service OSGi retournant l’ensemble des modules Flex disponibles sur la plate-forme. A l’activation de ce bundle, l’ensemble des ressources qu’il contient sont publiées au travers du service HTTP. <br /><br />
Les modules Flex disponibles sont embarqués dans des bundles séparés et contiennent leur propre logique métier. Ils sont pris en charge par le bundle principal afin d’être enregistrés auprès du service HTTP. Une fois cette action réalisée, l’application Flex est notifiée du départ ou de l’arrivée d’un module afin de déclencher son chargement ou son déchargement. <br /><br />
Ma présentation se conclue par une démonstration d’un système de supervision. Un module permet de récupérer des informations générales sur la JVM, tandis que deux autres modules affichent la consommation CPU et mémoire de la JVM. Un dernier module affiche la liste des bundles du runtime OSGi. Chacun de ses modules enregistre des services OSGi qui sont accédés par le client Flex. <br /><br />
Je présenterai très prochainement ce sujet lors d'une <strong>conférence dans les locaux de <a href="http://www.zenika.com/?fg=50007">Zenika</a></strong>. En attendant, vous pouvez d'ores et déjà récupérer les <a href="/wp-content/uploads/2015/07/ApacheConNA2010-OSGi_Flex-Fornaciari.pdf">slides</a> de la présentation.</p> <h4>Managing an OSGi Framework with Apache Felix Web Console</h4> <p>Chaque conteneur OSGi est distribué avec son propre shell (ligne de commande) permettant d’administrer la plate-forme. Des initiatives comme le projet <a href="http://felix.apache.org/site/apache-felix-gogo.html">Apache Felix Gogo</a> implémente la RFC 147, un standard visant à homogénéifier les commandes d’administration. <br /><br />
Felix Meschberger a présenté le projet <a href="http://felix.apache.org/site/apache-felix-web-console.html">Apache Felix Web Console</a> qui a pour but de fournir une console d’administration web extensible. Elle permet de visualiser l’ensemble des bundles et services de la plate-forme, d’agir sur leur état, d’installer de nouveaux bundles à partir de l’OBR (OSGi Bundle Repository), de créer des configurations, etc. A cet ensemble de fonctionnalités existantes, il est également possible de créer ses propres modules d’administration qui apparaitront comme de nouveaux onglets. <br /><br />
Parmi les fonctionnalités intéressantes, il y a la gestion i18n, la possibilité d’extraire la configuration courante sous forme d’une archive ou encore la personnalisation du style et le bandeau de l’application.</p> <h4>OSGi Design Patterns and Best Practices</h4> <p>Une présentation particulièrement intéressante a été faite par Marcel Offermans sur les bonnes pratiques de développement d’applications OSGi. Voici quelques unes des recommandations qu’il est bon d’avoir en mémoire. <br /><br />
Bien que l’utilisation d’OSGi apporte une réelle architecture modulaire, il faut faire attention à ne pas tomber dans l’exagération. Pour minimiser la complexité, il est préconisé de réduire les dépendances, de limiter chaque bundle à une partie de l’application qui pourra évoluer indépendamment des autres, quitte à embarquer les bibliothèques dans les bundles qui les utilisent si elles ne sont pas partagées. Il est fortement recommandé de versionner tous les packages exportés. La politique de numérotation des versions est également très importante car elle détermine le degré de compatibilité entre chaque version. <br /><br />
Depuis la version 4.2 de la spécification OSGi (Launcher API), une section décrit l’instanciation et le démarrage du framework à partir d’une configuration afin de ne pas dépendre directement de l’implémentation sous-jacente. Lors du démarrage, il est déconseillé de se baser sur l’ordre des bundles et ne pas hésiter à tester un ordre aléatoire. La suppression du cache du framework à chaque redémarrage est également une mauvaise pratique car elle peut masquer des dysfonctionnements de l’application et on perd le bénéfice du temps de création du cache ainsi que l’état dans lequel on se trouvait avant d’arrêter le framework. <br /><br />
La notion de service est également importante car elle permet de découpler les modules entre eux. L’interface doit être pensée pour pouvoir coller autant que possible aux futures implémentations. De plus, la gestion des dépendances de services devrait toujours être prise en charge par des frameworks à composant (iPOJO, SCR, Blueprint, …). <br /><br />
Cette présentation s’est terminée par un aperçu de quelques design patterns qui facilitent la conception d’applications modulaires comme par exemple le <em>Whiteboard Pattern</em> («&nbsp;don’t call us, we call you ») ou le <em>Null Object Pattern</em> qui permet d’éviter de conditionner son code en fonction de la disponibilité ou non de certaines dépendances.</p> <h2>Conclusion</h2> <p><br />
Pour aller plus loin, vous pouvez consulter le <a href="http://us.apachecon.com/c/acna2010/schedule/grid">programme complet</a> de la conférence ApacheCon NA 2010 et également récupérer l'intégralité des slides sous forme d'une <a href="http://na.apachecon.com/downloads/acna_2011_slides.zip">archive</a>. <br /><br />
La conférence s'est donc achevée avec un grand nombre de présentations intéressantes, souvent données par les leaders des projets eux-mêmes. Je suis toujours autant étonné par les synergies qui existent entre les projets Apache. Ces derniers privilégient l'intégration avec d'autres projets de la Fondation ce qui profite à tous les projets et accentue les collaborations et les contributions. C'est probablement une des raisons pour laquelle les projets Apache sont si populaires.</p>