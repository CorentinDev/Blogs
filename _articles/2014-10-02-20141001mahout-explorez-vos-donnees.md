---
ID: 504
post_title: 'Mahout: explorez vos données (en plus de les stocker)'
author: jbaylon
post_date: 2014-10-02 11:00:00
post_excerpt: "<p>Apache Mahout est un nouveau projet (version 0.9 au moment où on rédige ce post) de data-mining. Le but de l'article est de vous présenter les techniques de data-mining, puis ce que Mahout propose.</p>"
layout: post
permalink: http://blog.zenika-offres.com/?p=504
published: true
slide_template:
  - ""
---
<p>Apache Mahout est un nouveau projet (version 0.9 au moment où on rédige ce post) de data-mining. Le but de l'article est de vous présenter les techniques de data-mining, puis ce que Mahout propose.</p>
<!--more-->
<h3>Ce que le data-mining permet</h3> <p>En résumé, la problématique est d'extraire un peu de connaissance de beaucoup de données, et ceci de manière la plus automatisée possible. Par exemple, votre site de e-commerce vous suggère des articles en fonction de vos achats précédents, ou votre banque a détecté des opérations suspectes sur votre compte. L'exploration de données, donc, permet de répondre aux familles de problèmes suivants&nbsp;:</p> <p><img src="/wp-content/uploads/2015/07/dm_overview_blog.jpg" alt="dm_overview_blog.jpg" style="display:block; margin:0 auto;" /></p> <p>La <strong>recherche d’éléments anormaux</strong>&nbsp;: vous avez un compte bancaire, vous réalisez chaque semaine des opérations et la banque ne s’y oppose pas. Un jour, vous décidez de vous offrir un voyage à Hawaï, et l’ordre passe. La banque estime que ces opérations sont normales, même si c’est la première fois que vous voyagez. En revanche, un retrait de 15000€ en Russie sera considéré comme anormal, et donc vous recevrez un appel. La recherche d’éléments anormaux porte exactement sur ce genre de problématique&nbsp;: ce qui est normal, même nouveau, et ce qui nécessite une vérification pour comprendre ou une action pour protéger.</p> <p>La <strong>description de classes et de concepts</strong>&nbsp;: On se donne des classes à l’avance, et on aimerait savoir classer une donnée non encore «&nbsp;étiquetée », ce qui est un problème de caractérisation. La caractérisation consiste à établir ce qui forme l’unité d’une classe. Par exemple, une banque peut lister les clients qui ne sont jamais à découvert, et chercher à comprendre ce qui les distingue intrinsèquement des autres clients. La discrimination porte sur la comparaison entre plusieurs classes, pour établir les différences fondamentales entre ces groupes. La différence avec la caractérisation est qu’on discrimine plusieurs classes et que l’étude ne porte pas sur les caractéristiques propres à une classe en particulier.</p> <p>La <strong>recherche de liens</strong> consiste à essayer d’expliciter et de synthétiser des règles liant les variables qu’on analyse. Par exemple, expliquer la performance passée d’un indice boursier par la situation économique du secteur. Ainsi, la recherche de motifs fréquents et la recherche de règles d’association consistent à analyser des groupes de données pour isoler celles qui reviennent fréquemment ensemble. Les sites de e-commerce sont friands de ce genre de liens pour les conseils d’achats. La recherche de corrélations vise à produire un modèle plus simple mais plus approximatif d’un ensemble de données. Par exemple, la corrélation linéaire cherche à trouver une fonction linéaire qui approche «&nbsp;au mieux&nbsp;» des données en deux dimensions.</p> <p>L’<strong>analyse prédictive</strong> part de classes connues et essaie de prédire le comportement ou les caractéristiques de nouvelles données. Ainsi, l’interpolation vise à prévoir le comportement futur d’une courbe (de ventes, de cours, de taux, de…) en fonction de situations passées. L’apprentissage constitue l’autre grande branche de l’analyse prédictive. L’apprentissage supervisé consiste à entrainer la machine sur un jeu de tests et sur des classes connues. Elle trouve une série de règles qui, appliquées à de nouvelles données, permettront de classer celles-ci dans la classe la plus vraisemblable. L’apprentissage non supervisé ne part pas de classes connues, celles-ci sont inférées en fonction de données. Contrairement au clustering (recherche de groupes non préalablement connus), le but est de classer de nouveaux éléments à partir de ce qu’on a compris sur les anciens.</p> <p>Et enfin, le <strong>clustering</strong>, de son nom français <strong>regroupement</strong>, vise à grouper des données par vraisemblance, sans que l’on ait fourni des classes à l’avance. Et là, vous allez hurler: mais comment est-ce possible?! C'est à dire, comment peut-on classer des données sans connaitre les groupes à l'avance? Il y a plusieurs algorithmes, nous allons présenter celui des K-Moyennes. Sans mathématiques, parce qu'on aime les défis. Le principe consiste à avoir initialement autant de groupes que de données. A chaque étape de l'algorithme, on essaie de trouver des données similaires suivant une certaine métrique, et on fusionne des groupes si les données sont assez proches. Au final, il ne reste que quelques grands groupes, tous avec une forte cohésion interne (des caractéristiques proches), et une faible ressemblance avec les données des autres groupes. Les grands groupes sont ceux cherchés, et on renvoie les groupes, avec pour chacun ses membres.</p> <h4>Alors, il y a le bon modèle, et le mauvais modèle. Le bon modèle...</h4> <p>Dans tous les cas, l'efficacité de la solution se mesure suivant plusieurs axes:</p> <ul> <li>la solution trouvée doit évidemment être <strong>valide</strong>. Elle peut cependant paraître contradictoire avec ce que le business peut savoir. Elle doit être <strong>nouvelle</strong>, et apporter de la <strong>connaissance</strong>, donc elle doit être pertinente.</li> <li>viser une connaissance complète est vain, parce que l’algorithme peut générer des milliers de règles. Les corrélations les plus folles peuvent être trouvées. Il y a donc une différence entre la synchronicité et la corrélation. Il peut pleuvoir chaque fois que vous mettez une cravate verte, mais c'est un hasard.</li> <li>la solution doit être suffisamment simple pour être <strong>utilisable par des humains</strong>, mais avoir un <strong>taux d'erreur le plus bas possible</strong>. Ce compromis se comprend bien, par exemple, avec l'application d'une régression linéaire. Si les données sont fortement corrélées, l'interpolation linéaire est pertinente. Sinon, le calcul reste possible, mais le taux d'erreur sera trop élevé pour que le modèle soit utilisable. Une interpolation polynomiale sera peut être envisagée: elle est plus complexe, mais peut réduire le taux d'erreur.</li> <li>la solution devrait être <strong>peu sensible au choix des données initiales</strong>. C'est une question de représentativité de l'échantillon initial sur les problèmes d'apprentissage. Là aussi, il s'agit d'une question de compromis entre la taille des données initiales et la possibilité de trouver des liens.</li> </ul> <h3>Ce que Mahout offre</h3> <p>Apache Mahout implémente quatre familles d’algorithmes et un outil de traitement des données. Tout est résumé dans ce schéma&nbsp;:</p> <p><img src="/wp-content/uploads/2015/07/m_content.png" alt="m_content.png" style="display:block; margin:0 auto;" /></p> <p>Mahout applique des outils de data-mining à des <strong>vecteurs</strong>, c’est-à-dire, fondamentalement, des listes de nombres réels. Les données peuvent être distribuées, et Mahout s’interface avec Hadoop. D’autres sources comme un fichier sont tout à fait possibles par ailleurs. L’outil dispose également d’un <strong>parser de texte</strong> pour avoir une représentation numérique. Ceci réalisé, on peut faire face à un problème simple&nbsp;: au sein des vecteurs, on peut avoir des composantes qui sont liées les unes aux autres. Elles n’apportent fondamentalement pas de nouvelle information puisqu’elles répliquent celle d’autres composantes. On applique alors des algorithmes de <strong>réduction de dimension</strong>, dont un des buts est de supprimer les composantes qui sont fortement liées à d’autres. Par exemple, on peut passer d’un problème à 20 dimensions à un, plus simple, portant sur 4 ou 5 dimensions beaucoup plus pertinentes et non liées entre elles. Et on raisonne en général mieux en 4 dimensions qu’en 20. On a, à ce stade, des données «&nbsp;propres »,  et on peut commencer à utiliser les algorithmes de data-mining fournis par Mahout&nbsp;:</p> <ol> <li>Fabriquer des vecteurs depuis les sources de données</li> <li>Réduire les dimensions pour avoir des vecteurs c
oncis et pertinents</li> <li>Appliquer les algorithmes de data-mining</li> </ol> <h4>Quelques algorithmes proposés par Mahout (et leur but)</h4> <p>Evidemment, on ne peut pas ici rentrer dans tous les détails de l’utilisation de la logique floue chez Mahout. Mais, voici un premier aperçu de ce que la version 0.9 propose&nbsp;:</p> <h5>Recommandations&nbsp;:</h5> <p>Pour proposer aux clients ce qui serait le plus susceptible de les intéresser, Mahout propose deux grandes familles de techniques&nbsp;:</p> <ul> <li>Recommandations par <strong>comparaison</strong> avec les autres utilisateurs, ou recommandations en comparant les éléments achetés ensemble (donc, du point de vue du produit). Par exemple, si un groupe d’utilisateurs a de nombreux produits en commun avec vous, il est probable que vous achetiez ce que vous n’avez pas mais que le groupe a déjà consommé.</li> <li><strong>La factorisation de matrices</strong>&nbsp;: l’idée, malgré un nom un peu déconcertant, reste simple&nbsp;: la matrice a en lignes les utilisateurs, et en colonnes les produits. On a donc les préférences de chaque client, et les valeurs de la matrice en mesurent l’intensité. Ces matrices se composent pour extrapoler ce que vous pourriez aimer.</li> </ul> <h5>Regroupement&nbsp;:</h5> <p>Un problème que rencontre la presse, ou les moteurs de recherche. Dans un texte, on peut avoir des thèmes communs, comme Agilité et Zenika, Gayet et Hollande, etc. Le regroupement peut aider à guider un utilisateur sur des articles qui peuvent l’intéresser au vu de ce que cette personne a déjà lu. Evidemment, la machine apprend les corrélations, personne n’aurait le temps de saisir manuellement toutes les combinaisons pertinentes. Mahout propose plusieurs algorithmes de clustering, tous basés, sur les techniques par k-moyennes et variantes dont la base vous a déjà été présentée plus haut. Une variante se base sur la logique floue. Au lieu de postuler qu’un élément appartient à un groupe et un seul, on attribue à chaque couple (élément, groupe) un pourcentage d’appartenance. De la même manière que personne n’est grand ou petit dans l’absolu, l’élément Tony Parker, par exemple, aura un degré d’appartenance au groupe «&nbsp;grand&nbsp;» élevé.</p> <h5>Classification&nbsp;:</h5> <p>Mahout propose des techniques assez variées, basées sur&nbsp;:</p> <ul> <li>Les <strong>réseaux de neurones</strong>, qui ont l’avantage de donner de très bons résultats. Inconvénient&nbsp;: on ne peut absolument pas comprendre les règles de classification en l’état. On doit faire confiance à l’outil. Plus exactement, c’est encore un domaine de recherche, mais il existe des algorithmes (bien au-delà de ce qu’on peut expliquer dans cet article) pour extraire des règles depuis un réseau de neurones.</li> <li>Les <strong>régressions</strong>&nbsp;: souvent efficace, simple. Un classique.</li> <li>Les <strong>algorithmes basés sur les probabilités</strong>&nbsp;: Bayes et Markov, donc. La <strong>formule de Bayes</strong> a trait aux probabilités du type&nbsp;: «&nbsp;A sachant que B s’est réalisé ». Par exemple, la probabilité que vous achetiez une poussette si vous avez un enfant, etc. Les gros volumes de données sont alors très utiles pour mesurer les probabilités conditionnelles, puisque sur un grand nombre d’éléments, une probabilité est un ratio&nbsp;: probabilité qu’un client achète une poussette = nombre de clients ayant acheté une poussette divisé par le nombre de clients. Les <strong>modèles de Markov</strong> poussent plus loin encore l’idée de probabilité conditionnelle. On peut prédire le comportement statistique moyen d’un client en fonction des actions passées au fil du temps. C’est la base théorique des modèles d’évaluation des ratings des clients en finance (Moody, Fitch, Standard and Poors).</li> </ul> <h4>Mahout et le Map-Reduce</h4> <p>Au tout début fut <strong>Lucene</strong>, d’Apache. En 2008, le projet Mahout vit le jour pour isoler les fonctionnalités d’exploration de données du projet Lucene. Une autre propriété forte du projet était de parfaitement s’interfacer avec Hadoop, d’où l’existence de beaucoup d’algorithmes basés sur Map-Reduce. Mais, revirement de situation en avril 2014&nbsp;: Map-Reduce ne sera plus utilisé sur les nouvelles fonctionnalités, au profit de <strong>SPARK</strong>, plus rapide et plus intuitif. Le site officiel annonce également l’utilisation d’un <strong>DSL basé sur SCALA</strong>.</p> <h3>Conclusion</h3> <p>Nous aimerions faire passer deux idées dans cet article&nbsp;:</p> <ol> <li>A présent que les solutions de stockage permettent de sauver de gros volumes, il nous parait évident qu’on peut l’utiliser, en <strong>extraire de la connaissance business</strong>. Ce qui, mécaniquement, met en avant l’exploration de données dont c’est exactement le but.</li> <li><strong>Le data-mining n’est pas seulement l’affaire de data-scientists</strong>. Mahout s’inscrit dans cette lignée&nbsp;: un outil dédié, couplé à Hadoop, pour les principales fonctionnalités dont la communauté a besoin&nbsp;: recommandations, classification, regroupement.</li> </ol> <p>Et si vous voulez en savoir plus:</p> <p>SPARK et Mahout: <strong>pourquoi</strong>: <a href="http://www.lemondeinformatique.fr/actualites/lire-la-fondation-apache-reveille-hadoop-avec-spark-57639.html" hreflang="fr" title="SPARK et Mahout"></a></p> <p>Rien de mieux que le <strong>site officiel</strong> <a href="https://mahout.apache.org" hreflang="en" title="Le site officiel"></a></p> <p>Et un livre: <strong>Mahout in action</strong>, <em>Sean Owen, Robin Anil, Ted Dunning, Ellen Friedman</em> chez Manning</p>