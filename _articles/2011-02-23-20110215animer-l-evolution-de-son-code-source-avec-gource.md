---
ID: 174
post_title: 'Animer l&#039;évolution de son code source avec Gource'
author: Alexandre Garnier
post_date: 2011-02-23 01:02:00
post_excerpt: "<p>La plupart des projets sont maintenant gérés avec des systèmes de contrôle de version (VCS) tels que SVN ou Git.<br />Pour voir la construction de ces projets, le seul outil offert par ces VCS est l'historique via la commande log.<br />C'est bien pratique mais pas très fun et compréhensible pour des non techniques...</p> <p>C'est là que Gource entre en scène&nbsp;!</p>"
layout: post
permalink: http://blog.zenika-offres.com/?p=174
published: true
---
<p>La plupart des projets sont maintenant gérés avec des systèmes de contrôle de version (VCS) tels que SVN ou Git.<br />Pour voir la construction de ces projets, le seul outil offert par ces VCS est l'historique via la commande log.<br />C'est bien pratique mais pas très fun et compréhensible pour des non techniques...</p> <p>C'est là que Gource entre en scène&nbsp;!</p>
<!--more-->
<h2>Présentation</h2> <p><a href="http://code.google.com/p/gource/">Gource</a> est un outil permettant de gérer une vidéo de l'évolution du code source d'un projet géré par un VCS.<br />Il gère nativement&nbsp;:</p> <ul> <li><a href="http://git-scm.com/">Git</a></li> <li><a href="http://bazaar.canonical.com/en/">Bazaar</a></li> <li><a href="http://mercurial.selenic.com/">Mercurial</a></li> <li><a href="http://subversion.apache.org/">Subversion</a> (depuis la dernière version de Gource)</li> </ul> <p>Mais il peut fonctionner avec tout autre type de VCS à condition de faire un petit effort de normalisation des informations de l'historique (l'utilisation avec CVS est par exemple <a href="http://code.google.com/p/gource/wiki/CVS">documentée</a>)</p> <p>Gource va en fait extraire l'historique du projet depuis le VCS et faire une animation de l'évolution du code sous la forme d'un arbre représentant l'arborescence de fichier qui va évoluer dans le temps via des modifications par les contributeurs au projet.</p> <h2>Exemples</h2> <p>Puisqu'une vidéo est plus claire qu'un long discours, voilà des exemples de l'évolution du code source des 3 principaux DVCS actuels (Git, Bazaar et Mercurial)&nbsp;:</p> <dl> <dt><strong>Git</strong></dt> <dd><iframe width="560" height="315" src="https://www.youtube.com/embed/62dmVJDmlaw?vq=hd720" frameborder="0" allowfullscreen></iframe></dd> <dd><a href="http://youtu.be/62dmVJDmlaw">"Git in 1min with Gource" sur Youtube</a></dd> <dt><strong>Bazaar</strong></dt> <dd><iframe width="560" height="315" src="https://www.youtube.com/embed/2KQdoapWNFI?vq=hd720" frameborder="0" allowfullscreen></iframe></dd> <dd><a href="http://youtu.be/2KQdoapWNFI">"Bazaar in 1min with Gource" sur Youtube</a></dd> <dd>On remarque ici l'utilisation de <a href="https://launchpad.net/pqm/">Patch Queue Manager</a> qui réduit les contributeurs à un seul.</dd> <dt><strong>Mercurial</strong></dt> <dd><iframe width="560" height="315" src="https://www.youtube.com/embed/Py4v6wRvFE0?vq=hd720" frameborder="0" allowfullscreen></iframe></dd> <dd><a href="http://youtu.be/Py4v6wRvFE0">"Mercurial in 1min with Gource" sur Youtube</a></dd> </dl> <h2>Installation</h2> <p>Pour utiliser Gource, il suffit de l'installer.</p> <p>Sous Ubuntu, il existe par exemple un package gource que vous pouvez installer via <code>sudo apt-get install gource</code>. </p> <p>Pour Windows, il suffit de décompresser l'archive et d'utiliser l'exécutable <code>gource.exe</code>.</p> <h2>Utilisation</h2> <h3>En vitesse</h3> <p>Pour l'utiliser, rien de plus simple&nbsp;: il suffit de le lancer depuis la racine de votre projet&nbsp;:</p> <pre>$ cd myProject<br />$ gource</pre> <p>Une fenêtre va s'ouvrir et l'évolution de votre code source va se rejouer devant vos yeux.</p> <h3>En détail</h3> <p>Gource est ensuite très paramétrable. Parmi les paramètres utiles&nbsp;:</p> <ul> <li><code>-a, --auto-skip-seconds SECONDS</code>&nbsp;: permet de sauter les période d'inactivité de plus de SECONDS secondes</li> <li><code>-s, --seconds-per-day SECONDS</code>&nbsp;: permet de régler la vitesse de l'animation</li> <li><code>--user-image-dir DIRECTORY</code>&nbsp;: permet de définir des avatars pour chaque utilisateur&nbsp;: Gource utilisera comme avatar l'image DIRECTORY/zigarn.jpg pour l'utilisateur zigarn par exemple</li> <li><code>--default-user-image IMAGE</code>&nbsp;: permet de définir un avatar par défaut si l'option précédente n'est pas utilisée ou qu'il n'y a pas d'image du nom de l'utilisateur (Attention&nbsp;: il faut préciser le chemin complet, pas juste relatif à DIRECTORY de l'option précédente)</li> </ul> <p>Il existe un grand nombre de paramètres permettant de modifier l'apparence de l'animation en jouant sur l'effet de halo, l'affichage de certaines informations, le mouvement de la caméra, ...<br />Tous ces paramètres sont bien documentés via <code>gource --help</code> ou la page de manuel.</p> <h3>Export vidéo</h3> <p>Gource permet d'exporter l'animation sous la forme d'une séquence d'images au format PPM via l'option <code>-o, --output-ppm-stream</code>.<br />Ces images peuvent ensuite être combinées en une vidéo avec un encodeur vidéo tel que <code>ffmpeg</code>.</p> <p>Un exemple d'utilisation sous Linux pour un export en FLV (parfait pour un upload sur Youtube) pourra être le suivant :</p> <pre>gource --stop-at-end -s 0.05 --hide filenames,dirnames --date-format "%d/%m/%Y" -1280x720 --disable-progress --output-ppm-stream - | ffmpeg -y -b 3000K -r 30 -f image2pipe -vcodec ppm -i - -vcodec flv video-gource.flv</pre> <p>La <a href="http://code.google.com/p/gource/wiki/Videos">documentation officielle</a> donne aussi un exemple pour Windows et tout un tas de vidéos pour différents projets.</p> <h2>Conclusion</h2> Voilà, vous avez maintenant un outil vous permettant de visualiser l'évolution de votre projet et de communiquer facilement dessus.<br />Et puis, il faut l'avouer, c'est joli !<br /><br />Enfin, pour approfondir, dans le même principe mais un peu moins compréhensible visuellement, il y a <a href="http://code.google.com/p/codeswarm/">code_swarm</a>.<br /><br />