---
ID: 60
post_title: 'GWT Data Binding (3/3) : Présentation de la problématique'
author: pqueinnec
post_date: 2007-07-11 14:58:00
post_excerpt: "<p>Dans ce dernier article, nous verrons comment générer dynamiquemt une classe, et comment l'utiliser dans notre projet GWT.</p>"
layout: post
permalink: http://blog.zenika-offres.com/?p=60
published: true
---
<p>Dans ce dernier article, nous verrons comment générer dynamiquemt une classe, et comment l'utiliser dans notre projet GWT.</p>
<!--more-->
<h3>Utiliser un Generator maison</h3> <p>Quand on utilise <code>GWT.create(Classe.class)</code>, GWT utilise le générateur par défaut qui renvoie le nom de la classe. Pour spécifier à GWT d’utiliser un autre générateur, il faut ajouter ces lignes dans le fichier de configuration XML du module.</p> <pre class="xml code xml" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;generate-with</span> <span style="color: #000066;">class</span>=”com.zenika.tutorial.rebind.WrapperGenerator”<span style="color: #000000; font-weight: bold;">&gt;</span></span> </div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;when-type-assignable</span> <span style="color: #000066;">class</span>=”com.zenika.tutorial.gwt.client.BusinessObject”<span style="color: #000000; font-weight: bold;">/&gt;</span></span> </div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;/generate-with<span style="color: #000000; font-weight: bold;">&gt;</span></span></span></div></li></ol></pre> <p>Cette partie de code indique à GWT d’utiliser <code>WrapperGenerator</code> pour tout appel d’objet implémentant l’interface <code>BusinessObject</code>. L’interface <code>BusinessObject</code> est vide et ne sert qu’à identifier les classes pour l’appel de <code>WrapperGenerator</code>. En ce sens, la technique que nous présentons est légèrement instrusive.</p> <p>La classe <code>WrapperGenerator</code> étend la classe abstraite <code>Generator</code> de GWT (contenu dans gwt-dev-windows.jar) et se trouve par convention dans un package <code>.rebind</code> en dehors du module GWT. Ceci est normal étant donné que cette classe n’est pas amenée à être compilée ou à fournir un service RPC.</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #808080; font-style: italic;">/**</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #808080; font-style: italic;">&nbsp;* Méthode appelé lors de la séquence de Deferred Binding initié par l’appel GWT.create(). Renvoie le nom de la classe à instancier.</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #808080; font-style: italic;">&nbsp;*/</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">class</span> WrapperGenerator <span style="color: #7F0055; font-weight: bold;">extends</span> Generator <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">&nbsp;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #000000;">String</span> generate<span style="color: #000000;">&#40;</span>TreeLogger logger, GeneratorContext context, <span style="color: #000000;">String</span> typeClass<span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> UnableToCompleteException <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		WrapperCreator binder = <span style="color: #7F0055; font-weight: bold;">new</span> WrapperCreator<span style="color: #000000;">&#40;</span>logger, context, typeClass<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">String</span> className = binder.<span style="color: #000000;">createWrapper</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">return</span> className;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <p>La méthode generate prend en paramètre&nbsp;:</p> <ul> <li><code>TreeLogger</code> qui sert à loguer les messages</li> <li><code>GeneratorContext</code> qui gère les méta-données</li> <li><code>typeClass</code> qui est le nom de la classe passée en paramètre de GWT.create</li> </ul> <p>Et elle renvoie le nom de la classe à instancier. Ici, nous voulons qu’elle renvoie <code>PersonneWrapper</code> au lieu de <code>Personne</code>. Cette classe <code>PersonneWrapper</code> n’existe pas encore et sera créée dynamiquement à partir de la classe Personne par la classe <code>WrapperCreator</code>.</p> <h3>Générer une classe dynamiquement</h3> <p>La dernière étape est la création du wrapper avec la classe <code>WrapperCreator</code>. Nous allons décomposer son fonctionnement.</p> <p>Les paramètres de la méthode generate sont récupérés dans le constructeur. L’objet <code>TypeOracle</code> extrait du <code>GeneratorContext</code> est une Classe de Gwt qui permet d’accéder aux informations (nom de la classe, méthodes, paramètres de méthodes, etc.) de la classe passée en paramètre de la méthode <code>GWT.create()</code> (ici la classe <code>Personne</code>) de manière similaire à la réflexion java.</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">public</span> WrapperCreator<span style="color: #000000;">&#40;</span>TreeLogger logger, GeneratorContext context, <span style="color: #000000;">String</span> typeName<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">this</span>.<span style="color: #000000;">logger</span> = logger;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">this</span>.<span style="color: #000000;">context</span> = context;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: norm
al; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">this</span>.<span style="color: #000000;">typeName</span> = typeName;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">this</span>.<span style="color: #000000;">typeOracle</span> = context.<span style="color: #000000;">getTypeOracle</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <p>Ensuite la méthode <code>createWrapper()</code> est appelée par <code>WrapperGenerator</code>. Celle-ci récupère dans l’oracle le nom de la classe demandée et appelle la méthode <code>getSourceWriter()</code>.</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #000000;">String</span> createWrapper<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		JClassType classType = typeOracle.<span style="color: #000000;">getType</span><span style="color: #000000;">&#40;</span>typeName<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">        SourceWriter source = getSourceWriter<span style="color: #000000;">&#40;</span>classType<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">public</span> SourceWriter getSourceWriter<span style="color: #000000;">&#40;</span>JClassType classType<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">String</span> packageName = classType.<span style="color: #000000;">getPackage</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">getName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">String</span> simpleName = classType.<span style="color: #000000;">getSimpleSourceName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> + <span style="color: #888888;">&quot;Wrapper&quot;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	ClassSourceFileComposerFactory composer = <span style="color: #7F0055; font-weight: bold;">new</span> ClassSourceFileComposerFactory<span style="color: #000000;">&#40;</span>packageName, simpleName<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	composer.<span style="color: #000000;">addImplementedInterface</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;com.zenika.tutorial.gwt.client.Wrapper&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">PrintWriter</span> printWriter = context.<span style="color: #000000;">tryCreate</span><span style="color: #000000;">&#40;</span>logger, packageName, simpleName<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055;font-weight: bold;">if</span> <span style="color: #000000;">&#40;</span>printWriter == <span style="color: #7F0055; font-weight: bold;">null</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">return</span> <span style="color: #7F0055; font-weight: bold;">null</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span> <span style="color: #7F0055;font-weight: bold;">else</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		SourceWriter sw = composer.<span style="color: #000000;">createSourceWriter</span><span style="color: #000000;">&#40;</span>context, printWriter<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">return</span> sw;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <p>Le <code>SourceWriter</code> gère le flux textuel associé à la définition de la classe à générer. Il fonctionne comme un <code>FileWriter</code> sauf qu’il gère en plus l’indentation. Le <code>SourceWriter</code> renvoyé contient la déclaration du package, du nom de la classe et de l’interface à implémenter. <br />
Il ne reste plus qu’à écrire le code de la classe. Pour cela, on se sert de l’oracle pour générer les méthodes <code>getAttribute()</code> et <code>setAttribute()</code> en fonction des propriétés de l’objet <code>Personne</code>. Voici la partie de code qui crée la méthode <code>getAttribute()</code> (le code complet de la classe est disponible en téléchargement ).</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> getSourceWriter<span style="color: #000000;">&#40;</span>JClassType classType<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	JMethod<span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> methods = classType.<span style="color: #000000;">getMethods</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055;font-weight: bold;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">int</span> i = 0; i <span style="color: #000000;">&lt;</span> methods.<span style="color: #000000;">length</span>; i++<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">String</span> methodName = methods<span style="color: #000000;">&#91;</span>i<span style="color: #000000;">&#93;</span>.<span style="color: #000000;">getName</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		JParameter<span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> methodParameters = methods<span style="color: #000000;">&#91;</span>i<span style="color: #000000;">&#93;</span>.<span style="color: #000000;">getParameters</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		JType returnType = methods<span style="color: #000000;">&#91;</span>i<span style="color: #000000;">&#93;</span>.<span style="color: #000000;">getReturnType</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055;font-weight: bold;">if</span> <span style="color: #000000;">&#40;</span>methodName.<span style="color: #000000;">startsWith</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;get&quot;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&amp;</span> methodParameters.<span style="color: #000000;">length</span> == 0<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">			source.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;if (attr.equals(<span style="color: #000099; font-weight: bold;">&quot;</span>&quot;</span> + methodName.<span style="color: #000000;">substring</span><span style="color: #000000;">&#40;</span><span style="color: #cc66cc;">3</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">toLowerCase</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> + <span style="color: #888888;">&quot;<span style="color: #000099; font-weight: bold;">&quot;</span>)) {&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">			source.<span style="color: #000000;">indent</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">			source.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;return content.&quot;</span> + methodName + <span style="color: #888888;">&quot;();&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">			source.<span style="color: #000000;">outdent</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">			source.<span style="color: #000000;">print</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;} else &quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	source.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;{&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	source.<span style="color: #000000;">indent</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	source.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;return null;&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	source.<span style="color: #000000;">outdent</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	source.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;}&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-
weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <h3>Utiliser le wrapper</h3> <p>Maintenant pour utiliser le wrapper il vous suffit de taper ceci&nbsp;:</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">Wrapper wrapper = <span style="color: #000000;">&#40;</span>Wrapper<span style="color: #000000;">&#41;</span> GWT.<span style="color: #000000;">create</span><span style="color: #000000;">&#40;</span>Personne.<span style="color: #7F0055; font-weight: bold;">class</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">wrapper.<span style="color: #000000;">setContent</span><span style="color: #000000;">&#40;</span>personne<span style="color: #000000;">&#41;</span>;</div></li></ol></pre> <p>Et vous pouvez accéder aux données contenues dans personne avec la fonction getAttribute de wrapper (par exemple, getAttribute(”nom”)).</p> <p>Voici un exemple d’utilistaion concrète du Wrapper:</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #808080; font-style: italic;">// Création du modèle, un pojo simple normalement récupéré par un service RPC GWT</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">final</span> Personne personne = <span style="color: #7F0055; font-weight: bold;">new</span> Personne<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Robert&quot;</span>, <span style="color: #888888;">&quot;Charlebois&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #808080; font-style: italic;">// Création du wrapper du modèle pour pouvoir binder (c’est à dire le lier à l’interface)</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">Wrapper wrapper = <span style="color: #000000;">&#40;</span>Wrapper<span style="color: #000000;">&#41;</span> GWT.<span style="color: #000000;">create</span><span style="color: #000000;">&#40;</span>Personne.<span style="color: #7F0055; font-weight: bold;">class</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #808080; font-style: italic;">// wrappe le modèle</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">wrapper.<span style="color: #000000;">setContent</span><span style="color: #000000;">&#40;</span>personne<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #808080; font-style: italic;">// on bind le nom et le prenom avec deux champs de saisis</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">RootPanel.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">add</span><span style="color: #000000;">&#40;</span>Binder.<span style="color: #000000;">bind</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">new</span> TextBox<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, wrapper, <span style="color: #888888;">&quot;prenom&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">RootPanel.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">add</span><span style="color: #000000;">&#40;</span>Binder.<span style="color: #000000;">bind</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">new</span> TextBox<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>, wrapper, <span style="color: #888888;">&quot;nom&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">Button</span> button = <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">Button</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Inspecter les nouvelles valeurs du modele&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">button.<span style="color: #000000;">addClickListener</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">new</span> ClickListener<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">public</span> <span style="color: #7F0055; font-weight: bold;">void</span> onClick<span style="color: #000000;">&#40;</span>Widget sender<span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #808080; font-style: italic;">// on teste pour voir si l’IHM a bien répercuté les nouvelles valeurs sur le modèle.</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">Window</span>.<span style="color: #000000;">alert</span><span style="color: #000000;">&#40;</span>personne.<span style="color: #000000;">getPrenom</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span> + <span style="color: #888888;">&quot; &quot;</span> + personne.<span style="color: #000000;">getNom</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">&nbsp;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weigh
t: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">RootPanel.<span style="color: #000000;">get</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">add</span><span style="color: #000000;">&#40;</span>button<span style="color: #000000;">&#41;</span>;</div></li></ol></pre> <h3>Pour la suite</h3> <p>Nous avons mis à votre disposition en annexe un fichier zip contenant les codes sources du générateur de wrapper et un example de binding de données.</p> <p>Je tiens particulièrement à remercier Ray Cromwell qui sur son blog <a href="http://timepedia.blogspot.com/">Timepedia</a> a été une des premières personnes à documenter le <code>Generator</code>.</p> <p>Ce tutorial est une mise en bouche vers un tutorial plus complet axé lui-aussi sur le data binding. Nous verrons notamment comment créer une classe <code>Bind</code> qui prendra en charge la création du wrapper de manière complètement générique et la création dynamique de validator.</p> <p>Pour toutes questions, n’hésitez pas à me contacter à cette adresse&nbsp;: pierre.queinnec@zenika.com</p>