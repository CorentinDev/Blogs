---
ID: 163
post_title: Remote access API et Hudson
author: Grégory Boissinot
post_date: 2009-02-22 15:26:00
post_excerpt: '<p><a href="https://hudson.dev.java.net/">Hudson</a> est un serveur d’intégration continue très riche. Parmi ses fonctionnalités, il expose l’ensemble des opérions de l’utilisateur par API. Dans un style REST, l’utilisateur va ainsi très facilement pouvoir réaliser les opérations CRUD sur un projet Hudson (nommée job Hudson), déclencher un build ou même récupérer le résultat des différents builds. Ce mécanisme est très puissant mais souvent inexploité par les utilisateurs de Hudson.</p>'
layout: post
permalink: http://blog.zenika-offres.com/?p=163
published: true
---
<p><a href="https://hudson.dev.java.net/">Hudson</a> est un serveur d’intégration continue très riche. Parmi ses fonctionnalités, il expose l’ensemble des opérions de l’utilisateur par API. Dans un style REST, l’utilisateur va ainsi très facilement pouvoir réaliser les opérations CRUD sur un projet Hudson (nommée job Hudson), déclencher un build ou même récupérer le résultat des différents builds. Ce mécanisme est très puissant mais souvent inexploité par les utilisateurs de Hudson.</p>
<!--more-->
<p>Pour connaître les opérations disponibles, il vous suffit de rajouter le path ‘api’ à votre URL Hudson dans le contexte courant comme</p> <ul> <li>http://localhost:8090/hudson/api/</li> <li>http://localhost:80980/hudson/job/test-gradle/api/</li> <li>http://localhost:8090/hudson/job/test-gradle/17/api/</li> </ul> <p>Ci-dessous une suite d'exemple d’interactions, avec une implémentation Java basée sur la librairie <a href="http://hc.apache.org/httpclient-3.x/">Jakarta Commons HttpClient</a>.</p> <h4>Pour s’authentifier</h4> <p>Utilisation de la ressource "<strong>hudsonBaseURL/j_acegi_security_check</strong>"</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">private</span> HttpClient authenticate<span style="color: #000000;">&#40;</span><span style="color: #000000;">String</span> hudsonBaseURL<span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> <span style="color: #000000;">IOException</span>, HttpException <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	HttpClient client = <span style="color: #7F0055; font-weight: bold;">new</span> HttpClient<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	PostMethod postMethodAuth = <span style="color: #7F0055; font-weight: bold;">new</span> PostMethod<span style="color: #000000;">&#40;</span>hudsonBaseURL + <span style="color: #888888;">&quot;/j_acegi_security_check&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">NameValuePair</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> postData = <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">NameValuePair</span><span style="color: #000000;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #000000;">&#93;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	postData<span style="color: #000000;">&#91;</span>0<span style="color: #000000;">&#93;</span> = <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">NameValuePair</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;j_username&quot;</span>, <span style="color: #888888;">&quot;gboissinot&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	postData<span style="color: #000000;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #000000;">&#93;</span> = <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">NameValuePair</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;j_password&quot;</span>, <span style="color: #888888;">&quot;zenika&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	postData<span style="color: #000000;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #000000;">&#93;</span> = <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">NameValuePair</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Login&quot;</span>, <span style="color: #888888;">&quot;login&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	postMethodAuth.<span style="color: #000000;">addParameters</span><span style="color: #000000;">&#40;</span>postData<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">int</span> status= client.<span style="color: #000000;">executeMethod</span><span style="color: #000000;">&#40;</span>postMethodAuth<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">System</span>.<span style="color: #000000;">out</span>.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span>status + <span style="color: #888888;">&quot;<span style="color: #000099; font-weight: bold;">n</span>&quot;</span>+ postMethodAuth.<span style="color: #000000;">getResponseBodyAsString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;			</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span> <span style="color: #7F0055; font-weight: bold;">finally</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		postMethodAuth.<span style="color: #000000;">releaseConnection</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">return</span> client;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <h4>Pour valider une URL Hudson</h4> <p>Vérification de la présence de l’entête HTTP <strong>"X-Hudson"</strong></p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">boolean</span> isHudsonURL <span style="color: #000000;">&#40;</span><span style="color: #000000;">String</span> hudsonBaseURL<span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> <span style="color: #000000;">IOException</span>, HttpException <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: nor
mal; margin:0; padding:0; background:inherit;">	HttpClient client=  <span style="color: #7F0055; font-weight: bold;">new</span> HttpClient<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	GetMethod getMethod = <span style="color: #7F0055; font-weight: bold;">new</span> GetMethod<span style="color: #000000;">&#40;</span>hudsonBaseURL<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">boolean</span> isHudsonURL=<span style="color: #7F0055; font-weight: bold;">false</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">int</span> status = client.<span style="color: #000000;">executeMethod</span><span style="color: #000000;">&#40;</span>getMethod<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">System</span>.<span style="color: #000000;">out</span>.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span>status + <span style="color: #888888;">&quot;<span style="color: #000099; font-weight: bold;">n</span>&quot;</span>+ getMethod.<span style="color: #000000;">getResponseBodyAsString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		isHudsonURL=getMethod.<span style="color: #000000;">getResponseHeader</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;X-Hudson&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">!</span>=<span style="color: #7F0055; font-weight: bold;">null</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span> <span style="color: #7F0055; font-weight: bold;">finally</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		getMethod.<span style="color: #000000;">releaseConnection</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">return</span> isHudsonURL;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <h4>Pour créer un job Hudson</h4> <p>Envoie du fichier de configuration du job <strong>config.xml</strong> à la ressource <strong>hudsonBaseURL/createItem</strong> avec le paramètre <strong>name=jobName</strong></p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">void</span> put<span style="color: #000000;">&#40;</span>HttpClient client, <span style="color: #000000;">String</span> hudsonBaseURL,<span style="color: #000000;">String</span> jobName, <span style="color: #000000;">File</span> configFile<span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> <span style="color: #000000;">IOException</span>, HttpException <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	PostMethod postMethod = <span style="color: #7F0055; font-weight: bold;">new</span> PostMethod<span style="color: #000000;">&#40;</span>hudsonBaseURL+ <span style="color: #888888;">&quot;/createItem?name=&quot;</span> + jobName<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	postMethod.<span style="color: #000000;">setRequestHeader</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Content-type&quot;</span>,<span style="color: #888888;">&quot;application/xml; charset=ISO-8859-1&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	postMethod.<span style="color: #000000;">setRequestBody</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">FileInputStream</span><span style="color: #000000;">&#40;</span>configFile<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	postMethod.<span style="color: #000000;">setDoAuthentication</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">true</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">int</span> status = client.<span style="color: #000000;">executeMethod</span><span style="color: #000000;">&#40;</span>postMethod<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">System</span>.<span style="color: #000000;">out</span>.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span>status + <span style="color: #888888;">&quot;<span style="color: #000099; font-weight: bold;">n</span>&quot;</span>+ postMethod.<span style="color: #000000;">getResponseBodyAsString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; paddin
g:0; background:inherit;">	<span style="color: #000000;">&#125;</span> <span style="color: #7F0055; font-weight: bold;">finally</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		postMethod.<span style="color: #000000;">releaseConnection</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <h4>Pour mettre à jour un job Hudson</h4> <p>Envoie à la ressource <strong>hudsonBaseURL/job/jobName/config.xml</strong> d'un nouveau fichier de configuration <strong>config.xml</strong></p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">void</span> update<span style="color: #000000;">&#40;</span>HttpClient client, <span style="color: #000000;">String</span> hudsonBaseURL,<span style="color: #000000;">String</span> jobName, <span style="color: #000000;">File</span> updateFile<span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> <span style="color: #000000;">IOException</span>, HttpException <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	PostMethod postMethod = <span style="color: #7F0055; font-weight: bold;">new</span> PostMethod<span style="color: #000000;">&#40;</span>hudsonBaseURL + <span style="color: #888888;">&quot;/job/&quot;</span>+ jobName + <span style="color: #888888;">&quot;/config.xml&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	postMethod.<span style="color: #000000;">setRequestHeader</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Content-type&quot;</span>,<span style="color: #888888;">&quot;text/xml; charset=ISO-8859-1&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	postMethod.<span style="color: #000000;">setRequestBody</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">FileInputStream</span><span style="color: #000000;">&#40;</span>updateFile<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">int</span> status = client.<span style="color: #000000;">executeMethod</span><span style="color: #000000;">&#40;</span>postMethod<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">System</span>.<span style="color: #000000;">out</span>.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span>status + <span style="color: #888888;">&quot;<span style="color: #000099; font-weight: bold;">n</span>&quot;</span>+ postMethod.<span style="color: #000000;">getResponseBodyAsString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span> <span style="color: #7F0055; font-weight: bold;">finally</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		postMethod.<span style="color: #000000;">releaseConnection</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <h4>Pour copier un job Hudson</h4> <p>Envoie d’une requête POST à la ressource <strong>hudsonBaseURL/createItem</strong> avec 3 paramètres <strong>name=newJobName, mode=copy et from=originJobName</strong></p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">void</span> copy<span style="color: #000000;">&#40;</span>HttpClient client, <span style="color: #000000;">String</span> hudsonBaseURL,<span style="color: #000000;">String</span> originJobName, <span style="color: #000000;">String</span> newJobName<span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> <span style="color: #000000;">IOException</span>, HttpException <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	PostMethod postMethod = <span style="color: #7F0055; font-weight: bold;">new</span> PostMethod<span style="color: #000000;">&#40;</span>hudsonBaseURL + <span style="color: #888888;">&quot;/createItem&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">NameValuePair</span> n1 = <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">NameValuePair</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;name&quot;</span>, newJobName<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">NameValuePair</span> n2 = <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">NameValuePair</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;mode&quot;</span>, <span style="color: #888888;">&quot;copy&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;
"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">NameValuePair</span> n3 = <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">NameValuePair</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;from&quot;</span>, originJobName<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	postMethod.<span style="color: #000000;">setQueryString</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">NameValuePair</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> <span style="color: #000000;">&#123;</span> n1, n2, n3 <span style="color: #000000;">&#125;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	postMethod.<span style="color: #000000;">setRequestHeader</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Content-type&quot;</span>,<span style="color: #888888;">&quot;text/plain; charset=ISO-8859-1&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">int</span> status = client.<span style="color: #000000;">executeMethod</span><span style="color: #000000;">&#40;</span>postMethod<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">System</span>.<span style="color: #000000;">out</span>.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span>status + <span style="color: #888888;">&quot;<span style="color: #000099; font-weight: bold;">n</span>&quot;</span>+ postMethod.<span style="color: #000000;">getResponseBodyAsString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span> <span style="color: #7F0055; font-weight: bold;">finally</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		postMethod.<span style="color: #000000;">releaseConnection</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <h4>Pour supprimer un job Hudson</h4> <p>Envoie d’une requête POST à la ressource  <strong>hudsonBaseURL/job/jobName/doDelete</strong></p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">void</span> delete<span style="color: #000000;">&#40;</span>HttpClient client, <span style="color: #000000;">String</span> hudsonBaseURL, <span style="color: #000000;">String</span> jobName<span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> <span style="color: #000000;">IOException</span>, HttpException <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	PostMethod postMethod = <span style="color: #7F0055; font-weight: bold;">new</span> PostMethod<span style="color: #000000;">&#40;</span>hudsonBaseURL + <span style="color: #888888;">&quot;/job/&quot;</span>+ jobName + <span style="color: #888888;">&quot;/doDelete&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">int</span> status = client.<span style="color: #000000;">executeMethod</span><span style="color: #000000;">&#40;</span>postMethod<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">System</span>.<span style="color: #000000;">out</span>.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span>status + <span style="color: #888888;">&quot;<span style="color: #000099; font-weight: bold;">n</span>&quot;</span>+ postMethod.<span style="color: #000000;">getResponseBodyAsString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span> <span style="color: #7F0055; font-weight: bold;">finally</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		postMethod.<span style="color: #000000;">releaseConnection</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <h4>Pour activer et désactiver un job Hudson</h4> <p>Envoie de requêtes POST aux ressources  <strong>hudsonBaseURL/job/jobName/enable</strong> et <strong>hudsonBaseURL/job/jobName/disable</strong></p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">void</span> enable<span style="color: #000000;">&#40;</span>HttpClien
t client, <span style="color: #000000;">String</span> hudsonBaseURL,<span style="color: #000000;">String</span> jobName<span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> <span style="color: #000000;">IOException</span>, HttpException <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	PostMethod postMethod = <span style="color: #7F0055; font-weight: bold;">new</span> PostMethod<span style="color: #000000;">&#40;</span>hudsonBaseURL + <span style="color: #888888;">&quot;/job/&quot;</span>+ jobName + <span style="color: #888888;">&quot;/enable&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">int</span> status = client.<span style="color: #000000;">executeMethod</span><span style="color: #000000;">&#40;</span>postMethod<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">System</span>.<span style="color: #000000;">out</span>.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span>status + <span style="color: #888888;">&quot;<span style="color: #000099; font-weight: bold;">n</span>&quot;</span>+ postMethod.<span style="color: #000000;">getResponseBodyAsString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span> <span style="color: #7F0055; font-weight: bold;">finally</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		postMethod.<span style="color: #000000;">releaseConnection</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">&nbsp;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">void</span> disable<span style="color: #000000;">&#40;</span>HttpClient client, <span style="color: #000000;">String</span> hudsonBaseURL, <span style="color: #000000;">String</span> jobName<span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> <span style="color: #000000;">IOException</span>, HttpException <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	PostMethod postMethod = <span style="color: #7F0055; font-weight: bold;">new</span> PostMethod<span style="color: #000000;">&#40;</span>hudsonBaseURL + <span style="color: #888888;">&quot;/job/&quot;</span>+ jobName + <span style="color: #888888;">&quot;/disable&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">int</span> status = client.<span style="color: #000000;">executeMethod</span><span style="color: #000000;">&#40;</span>postMethod<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">System</span>.<span style="color: #000000;">out</span>.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span>status + <span style="color: #888888;">&quot;<span style="color: #000099; font-weight: bold;">n</span>&quot;</span>+ postMethod.<span style="color: #000000;">getResponseBodyAsString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span> <span style="color: #7F0055; font-weight: bold;">finally</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		postMethod.<span style="color: #000000;">releaseConnection</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <h4>Pour récupérer le fichier de configuration config.xml d’un job Hudson</h4> <p>Récupérer la réponse d’une requête à la ressource <strong>hudsonBaseURL/job/jobName/config.xml</strong></p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">void</span> fetch<span style="color: #000000;">&#40;</span>HttpClient client, <span style="color: #000000;">String</span> hudsonBaseURL, <span style="color: #000000;">String</span> jobName<span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> <span style="color: #000000;">IOException</span>, HttpException <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	GetMethod getMethod = <span style="color: #7F0055; font-weight: bold;">new</span> GetMethod<span style="color: #000000;">&#40;</span>hudsonBaseURL + <span style="color: #888888;">&quot;/job/&quot;</span> + jobName+ <span style="color: #88
8888;">&quot;/config.xml&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">int</span> returnCode = client.<span style="color: #000000;">executeMethod</span><span style="color: #000000;">&#40;</span>getMethod<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">System</span>.<span style="color: #000000;">out</span>.<span style="color: #000000;">print</span><span style="color: #000000;">&#40;</span>returnCode<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">byte</span><span style="color: #000000;">&#91;</span><span style="color: #000000;">&#93;</span> response = getMethod.<span style="color: #000000;">getResponseBody</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">System</span>.<span style="color: #000000;">out</span>.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span><span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">String</span><span style="color: #000000;">&#40;</span>response<span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span> <span style="color: #7F0055; font-weight: bold;">finally</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		getMethod.<span style="color: #000000;">releaseConnection</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <h4>Pour lancer le build d’un job</h4> <p>Invoquer la ressource <strong>hudsonBaseURL/job/jobName/build</strong></p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">void</span> launchBuild<span style="color: #000000;">&#40;</span>HttpClient client, <span style="color: #000000;">String</span> hudsonBaseURL, <span style="color: #000000;">String</span> jobName<span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> <span style="color: #000000;">IOException</span>, HttpException <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	GetMethod getMethod = <span style="color: #7F0055; font-weight: bold;">new</span> GetMethod<span style="color: #000000;">&#40;</span>hudsonBaseURL + <span style="color: #888888;">&quot;/job/&quot;</span>+ jobName+ <span style="color: #888888;">&quot;/build&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">int</span> status = client.<span style="color: #000000;">executeMethod</span><span style="color: #000000;">&#40;</span>getMethod<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">System</span>.<span style="color: #000000;">out</span>.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span>status + <span style="color: #888888;">&quot;<span style="color: #000099; font-weight: bold;">n</span>&quot;</span>+ getMethod.<span style="color: #000000;">getResponseBodyAsString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span> <span style="color: #7F0055; font-weight: bold;">finally</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		getMethod.<span style="color: #000000;">releaseConnection</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <h4>Pour lancer le build d’un job avec des paramètres</h4> <p>Invoquer la ressource <strong>hudsonBaseURL/job/jobName/buildWithParameters</strong> avec les paramètres du job</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">void</span> launchBuildWithParameters<span style="color: #000000;">&#40;</span>HttpClient client, <span style="color: #000000;">String</span> hudsonBaseURL, <span style="color: #000000;">String</span> jobName<span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> <span style="color: #000000;">IOException</span>, HttpException <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	GetMethod getMethod = <span style="color: #7F0055; font-weight: bold;">new</span> GetMethod<span style="color: #000000;">&#40;</span>hudsonBaseURL + <span style="color: #8888
88;">&quot;/job/&quot;</span>+ jobName+ <span style="color: #888888;">&quot;/buildWithParameters?param1=value1&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">int</span> status = client.<span style="color: #000000;">executeMethod</span><span style="color: #000000;">&#40;</span>getMethod<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">System</span>.<span style="color: #000000;">out</span>.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span>status + <span style="color: #888888;">&quot;<span style="color: #000099; font-weight: bold;">n</span>&quot;</span>+ getMethod.<span style="color: #000000;">getResponseBodyAsString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span> <span style="color: #7F0055; font-weight: bold;">finally</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		getMethod.<span style="color: #000000;">releaseConnection</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <h4>Pour récupérer la date du dernier succès d’un job</h4> <p>Invoquer la ressource <strong>hudsonBaseURL/job/jobName/lastSuccessfulBuild/buildTimestamp</strong> avec le paramètre format contenant comme valeur le pattern de la date désiré selon l’API <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/text/SimpleDateFormat.html">SimpleDateFormat</a></p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">void</span> lastSuccessfulBuild<span style="color: #000000;">&#40;</span>HttpClient client, <span style="color: #000000;">String</span> hudsonBaseURL, <span style="color: #000000;">String</span> jobName<span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> <span style="color: #000000;">IOException</span>, HttpException <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	GetMethod getMethod = <span style="color: #7F0055; font-weight: bold;">new</span> GetMethod<span style="color: #000000;">&#40;</span>hudsonBaseURL + <span style="color: #888888;">&quot;/job/&quot;</span>+ jobName+ <span style="color: #888888;">&quot;/lastSuccessfulBuild/buildTimestamp?format=dd/MM/yyyy&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">try</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #7F0055; font-weight: bold;">int</span> status = client.<span style="color: #000000;">executeMethod</span><span style="color: #000000;">&#40;</span>getMethod<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">System</span>.<span style="color: #000000;">out</span>.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span>status + <span style="color: #888888;">&quot;<span style="color: #000099; font-weight: bold;">n</span>&quot;</span>+ getMethod.<span style="color: #000000;">getResponseBodyAsString</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span> <span style="color: #7F0055; font-weight: bold;">finally</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		getMethod.<span style="color: #000000;">releaseConnection</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <h4>Pour récupérer le status de l’ensemble des jobs d’un dashboard Hudson</h4> <p>Invoquer la ressource <strong>hudsonBaseURL/api/xml</strong> et traiter le résultat</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">private</span> <span style="color: #7F0055; font-weight: bold;">void</span> read<span style="color: #000000;">&#40;</span><span style="color: #000000;">String</span> hudsonBaseURL<span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">throws</span> <span style="color: #000000;">IOException</span>, HttpException,DocumentException <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">URL</span> url = <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">URL</span><span style="color: #000000;">&#40;</span>hudsonBaseURL + <span style="color: #888888;">&quot;/api/xml&quot;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">Document</span> dom = <span style="color: #7F0055; font-weight: bold;">new</span> SAXReader<span style="color: #000000;">&#40;</span><span style="c
olor: #000000;">&#41;</span>.<span style="color: #000000;">read</span><span style="color: #000000;">&#40;</span>url<span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055;font-weight: bold;">for</span> <span style="color: #000000;">&#40;</span><span style="color: #000000;">Element</span> job : <span style="color: #000000;">&#40;</span>List<span style="color: #000000;">&lt;</span>Element<span style="color: #000000;">&gt;</span><span style="color: #000000;">&#41;</span> dom.<span style="color: #000000;">getRootElement</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>.<span style="color: #000000;">elements</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;job&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span> <span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">		<span style="color: #000000;">System</span>.<span style="color: #000000;">out</span>.<span style="color: #000000;">println</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">String</span>.<span style="color: #000000;">format</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;Name:%s<span style="color: #000099; font-weight: bold;">t</span>Status:%s&quot;</span>, job.<span style="color: #000000;">elementText</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;name&quot;</span><span style="color: #000000;">&#41;</span>, job.<span style="color: #000000;">elementText</span><span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;color&quot;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span><span style="color: #000000;">&#41;</span>;</div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #000000;">&#125;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <p>La capacité de piloter Hudson par API est très utile dans de nombreuses situations, comme dans la création d’un installateur de projets démonstrateurs ou d'un système d'orchestration qui piloterait un ensemble de jobs Hudson.</p> <p>Pour avoir plus d’informations sur cette fonctionnalité, veuillez consulter <a href="http://wiki.hudson-ci.org/display/HUDSON/Remote+access+API">la section Renote Access API</a> du wiki de Hudson.</p>