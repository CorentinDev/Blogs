---
ID: 67
post_title: 'Java : @SuppressWarnings démystifié'
author: ocroisier
post_date: 2009-01-29 17:50:00
post_excerpt: |
  <p>L'annotation <code>@SuppressWarnings</code> permet de signaler au compilateur que l'on a conscience de réaliser une opération risquée, et qu'il peut donc arrêter de signaler un éventuel problème. Si l'annotation est standard, ses valeurs sont en revanche dépendantes du compilateur (d'après la <a href="http://java.sun.com/docs/books/jls/third_edition/html/interfaces.html#9.6.1.5">JLS §9.6.1.5</a>, seule "<code>unchecked</code>" est standard), car ils n'ont pas tous les mêmes capacités d'analyse statique du code.</p>
layout: post
permalink: http://blog.zenika-offres.com/?p=67
published: true
---
<p>L'annotation <code>@SuppressWarnings</code> permet de signaler au compilateur que l'on a conscience de réaliser une opération risquée, et qu'il peut donc arrêter de signaler un éventuel problème. Si l'annotation est standard, ses valeurs sont en revanche dépendantes du compilateur (d'après la <a href="http://java.sun.com/docs/books/jls/third_edition/html/interfaces.html#9.6.1.5">JLS §9.6.1.5</a>, seule "<code>unchecked</code>" est standard), car ils n'ont pas tous les mêmes capacités d'analyse statique du code.</p>
<!--more-->
<p>L'annotation <code>@SuppressWarnings</code> possède la définition suivante&nbsp;:</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">@Target<span style="color: #000000;">&#40;</span>value=<span style="color: #000000;">&#123;</span>TYPE,FIELD,METHOD,PARAMETER,CONSTRUCTOR,LOCAL_VARIABLE<span style="color: #000000;">&#125;</span><span style="color: #000000;">&#41;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">@Retention<span style="color: #000000;">&#40;</span>value=SOURCE<span style="color: #000000;">&#41;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">public</span> @<span style="color: #7F0055; font-weight: bold;">interface</span> SuppressWarnings</div></li></ol></pre> <p>On voit qu'elle peut s'appliquer aux classes, à leurs méthodes et propriétés, et même aux variables locales et aux paramètres de méthodes.</p> <p>On l'utilise comme ceci&nbsp;:</p> <pre class="java code java" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">@SuppressWarnings<span style="color: #000000;">&#40;</span><span style="color: #888888;">&quot;unchecked&quot;</span><span style="color: #000000;">&#41;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #7F0055; font-weight: bold;">public</span> List<span style="color: #000000;">&lt;</span>User<span style="color: #000000;">&gt;</span> getUsers<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#123;</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #808080; font-style: italic;">// Cast non vérifié</span></div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">	<span style="color: #7F0055; font-weight: bold;">return</span> <span style="color: #000000;">&#40;</span>List<span style="color: #000000;">&lt;</span>User<span style="color: #000000;">&gt;</span><span style="color: #000000;">&#41;</span> <span style="color: #7F0055; font-weight: bold;">new</span> <span style="color: #000000;">ArrayList</span><span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>; </div></li><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;"><span style="color: #000000;">&#125;</span></div></li></ol></pre> <p>Voyons maintenant les valeurs supportées par javac et Eclipse.</p> <h4>Javac</h4> <p>Avec le compilateur standard de Sun, version 1.6.0_11,  on peut obtenir les valeurs supportées à l'aide de la commande&nbsp;:</p> <pre class="bash code bash" style="font-family:inherit"><ol><li style="font-weight: normal;"><div style="font-family: monospace; font-weight: normal; font-style: normal; margin:0; padding:0; background:inherit;">javac <span style="color: #660033;">-X</span></div></li></ol></pre> <p>Ce qui donne&nbsp;:</p> <ul> <li><code>all</code>&nbsp;: tous les warnings</li> <li><code>cast</code>&nbsp;: les casts hasardeux</li> <li><code>deprecation</code>&nbsp;: utilisation de classes et méthodes obsolètes</li> <li><code>divzero</code>&nbsp;: possible division par zéro</li> <li><code>empty</code>&nbsp;: ?</li> <li><code>unchecked</code>&nbsp;: conversions entre types paramétrés et types bruts</li> <li><code>fallthrough</code>&nbsp;: possible oubli d'un "break" dans un bloc "case"</li> <li><code>path</code>&nbsp;: ?</li> <li><code>serial</code>&nbsp;: oubli du SerialVersionUid dans une classe déclarée Serializable</li> <li><code>finally</code>&nbsp;: le bloc finally ne se termine pas correctement (lancement d'une exception par exemple)</li> <li><code>overrides</code>&nbsp;: ?</li> </ul> <h4>Eclipse</h4> <p>Eclipse, qui possède son propre compilateur interne, fournit dans sa documentation <a href="http://help.eclipse.org/ganymede/topic/org.eclipse.jdt.doc.isv/guide/jdt_api_compile.htm">la liste des valeurs qu'il reconnaît</a> (je vous laisse l'explication originale en anglais)&nbsp;:</p> <ul> <li><code>all</code>&nbsp;: to suppress all warnings</li> <li><code>boxing</code>&nbsp;: to suppress warnings relative to boxing/unboxing operations</li> <li><code>cast</code>&nbsp;: to suppress warnings relative to cast operations</li> <li><code>dep-ann</code>&nbsp;: to suppress warnings relative to deprecated annotation</li> <li><code>deprecation</code>&nbsp;: to suppress warnings relative to deprecation</li> <li><code>fallthrough</code>&nbsp;: to suppress warnings relative to missing breaks in switch statements</li> <li><code>finally</code>&nbsp;: to suppress warnings relative to finally block that don't return</li> <li><code>hiding</code>&nbsp;: to suppress warnings relative to locals that hide variable</li> <li><code>incomplete-switch</code>&nbsp;: to suppress warnings relative to missing entries in a switch statement (enum case)</li> <li><code>nls</code>&nbsp;: to suppress warnings relative to non-nls string literals</li> <li><code>null</code>&nbsp;: to suppress warnings relative to null analysis</li> <li><code>restriction</code>&nbsp;: to suppress warnings relative to usage of discouraged or forbidden references</li> <li><code>serial</code>&nbsp;: to suppress warnings relative to missing serialVersionUID field for a serializable class</li> <li><code>static-access</code>&nbsp;: to suppress warnings relative to incorrect static access</li> <li><code>synthetic-access</code>&nbsp;: to suppress warnings relative to unoptimized access from inner classes</li> <li><code>unchecked</code>&nbsp;: to suppress warnings relative to unchecked operations</li> <li><code>unqualified-field-access</code>&nbsp;: to suppress warnings relative to field access unqualified</li> <li><code>unused</code>&nbsp;: to suppress warnings relative to unused code</li> </ul> <h4>Du bon usage de @SuppressWarnings</h4> <p>Attention, la plupart du temps, le compilateur fait de son mieux pour vour prévenir d'erreurs de programmation pouvant mener à des bugs difficiles à détecter et corriger. Ne désactivez donc pas les alertes à moins de réellement savoir ce que vous faites&nbsp;!</p> <p>Par exemple, il est fréquent d'oublier le champ <code>SerialVersionUID</code> dans les classes sérialisables. Eclipse le signale, et c'est agaçant&nbsp;; de nombreux développeurs désactivent donc cet avertissement. Pourtant, il est plus prudent de le prendre en considération, afin d'éviter des problèmes d'incompatibilité entre différentes versions d'une même classe lors d'opérations réseau par exemple.</p> <p>Si toutefois vous êtes certain de vouloir ignorer un warning, documentez votre choix. Les équipes de maintenance vous en seront reconnaissantes&nbsp;!</p>