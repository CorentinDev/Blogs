---
ID: 469
post_title: Pourquoi pas ReactJS ?
author: Nicolas Cuillery
post_date: 2015-02-04 13:40:00
post_excerpt: |
  <p>A l'heure actuelle, AngularJS s'impose comme la référence des frameworks web. Son approche "full-stack" (c'est à dire qui contient tout le nécessaire pour construire une application <a href="http://fr.wikipedia.org/wiki/Application_web_monopage">single-page</a> ou "SPA") séduit et son architecture présente de vraies bonnes idées (modularité, injection de dépendance, ...). La <a href="http://www.zenika.com/formation-angularjs.html">formation Zenika</a> marche d'ailleurs très fort. Le framework s'appuie sur sa communauté et son écosystème de librairies dont certaines sont devenues incontournables (UI-router, UI-Bootstrap, angular-translate, etc.). Mais au-delà de l'écosystème AngularJS, il y a celui du Javascript, plus vaste encore et dans lequel se trouve le produit d'un autre géant du web&nbsp;: ReactJS.</p>
layout: post
permalink: http://blog.zenika-offres.com/?p=469
published: true
slide_template:
  - ""
---
<p>A l'heure actuelle, AngularJS s'impose comme la référence des frameworks web. Son approche "full-stack" (c'est à dire qui contient tout le nécessaire pour construire une application <a href="http://fr.wikipedia.org/wiki/Application_web_monopage">single-page</a> ou "SPA") séduit et son architecture présente de vraies bonnes idées (modularité, injection de dépendance, ...). La <a href="http://www.zenika.com/formation-angularjs.html">formation Zenika</a> marche d'ailleurs très fort. Le framework s'appuie sur sa communauté et son écosystème de librairies dont certaines sont devenues incontournables (UI-router, UI-Bootstrap, angular-translate, etc.). Mais au-delà de l'écosystème AngularJS, il y a celui du Javascript, plus vaste encore et dans lequel se trouve le produit d'un autre géant du web&nbsp;: ReactJS.</p>
<!--more-->
<h5>Une autre typologie de projet</h5> <p>AngularJS est très orienté application de gestion, c'est à dire des écrans de liste/détail, pour faire du CRUD sur des entités métier. Des pans entiers du framework sont dédiés à cet usage (support REST, formulaire avec système de validation, filtres i18n) et il est, de fait, très performant dans ce type de projet.</p> <p>A l'opposé des applications de gestion, sur l'échelle de l'esthétisme et de la "séduction graphique", on va trouver des sites purement visuels (un site vitrine d'une marque de luxe par exemple) où on va privilégier des technos comme Flash.</p> <p>React se place exactement entre les deux, c'est à dire sur des projets exigeant à la fois un rendu visuel agréable et un design épuré laissant la place aux actions de l'utilisateur. Ah, comme Facebook ou Instagram par exemple&nbsp;? Oui, <a href="http://facebook.github.io/react/docs/why-react.html">c'est normal</a>.</p> <h5>Un framework orienté Composant&nbsp;?</h5> <p>React n'est pas un framework full-stack, ce n'est d'ailleurs pas un framework (officiellement du moins)&nbsp;: c'est une bibliothèque orientée Composant. Il est très rapide de s'en convaincre&nbsp;: en arrivant sur la <a href="http://facebook.github.io/react/">page d'accueil</a> ("Just the UI") ou voyant le nom des <a href="http://facebook.github.io/react/docs/component-specs.html#lifecycle-methods">méthodes de l'API</a>. Ainsi, si React doit être comparé à AngularJS, ça doit être uniquement à la partie composant d'AngularJS&nbsp;: les directives.</p> <p>Or de l'aveu même de l'équipe AngularJS, l'API des directives n'est pas évidente et leur utilisation peu intuitive. La communauté se souvient de la série de slides à ng-Europe annonçant la mort de certains composants dans AngularJS 2.0. Le <em>Directive Definition Object</em> en faisait partie&nbsp;:</p> <p><img src="/wp-content/uploads/2015/07/rip_ddo_s.png" alt="rip_ddo_s.png" style="display:block; margin:0 auto;" /></p> <p>L'API de React, elle, va à l'essentiel et peut être résumée en quelques lignes. Dans un composant on va trouver notamment&nbsp;:</p> <ul> <li>Un état,</li> <li>Des propriétés d'initialisation,</li> <li>Une méthode <code>render</code> chargée du rendu du composant, appelée pour chaque changement de l'état (fonctionnement rappelant un peu les <code>states</code> apparus en Flex 4 pour ceux qui s'en souviennent),</li> <li>Des méthodes liées au cycle de vie du composant (<code>componentWillMount</code>, <code>componentDidUpdate</code>, etc.).</li> </ul> <p>L'état peut être assimilé au scope de la directive AngularJS à ceci près qu'à une modification de l'état correspond un et un seul appel à <code>render</code> (pas de boucle de digestion) et le binding est unidirectionnel (de l'état vers la vue).</p> <p>Pour faciliter la réutilisation de composant, React rend possible la définition d'un contrat d'interface. Imaginons l'équivalent React de la directive <a href="https://docs.angularjs.org/api/ng/directive/ngPluralize">ngPluralize</a> d'AngularJS. Un tel composant se déclarerait comme suit&nbsp;:</p> <pre class="javascript code javascript" style="font-family:inherit"><span style="color: #003366; font-weight: bold;">var</span> emailMessages <span style="color: #339933;">=</span> <span style="color: #009900;">&#123;</span>   <span style="color: #3366CC;">'0'</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">'Aucun email'</span><span style="color: #339933;">,</span>   <span style="color: #3366CC;">'1'</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">'1 email'</span><span style="color: #339933;">,</span>   <span style="color: #3366CC;">'other'</span><span style="color: #339933;">:</span> <span style="color: #3366CC;">'{} emails'</span> <span style="color: #009900;">&#125;</span></pre> <pre class="xml code xml" style="font-family:inherit"><span style="color: #009900;"><span style="color: #000000; font-weight: bold;">&lt;Pluralize</span> <span style="color: #000066;">count</span>=<span style="color: #66cc66;">&#123;</span>nbEmail<span style="color: #66cc66;">&#125;</span> <span style="color: #000066;">values</span>=<span style="color: #66cc66;">&#123;</span>emailMessages<span style="color: #66cc66;">&#125;</span> <span style="color: #000000; font-weight: bold;">/&gt;</span></span></pre> <p>Les attributs <code>count</code> et <code>values</code> sont les propriétés du composant Pluralize. Ce dernier ne peut pas fonctionner si elles ne sont pas correctement définies. Ainsi dans la déclaration du composant, on va pouvoir ajouter la clé suivante&nbsp;:</p> <pre class="javascript code javascript" style="font-family:inherit">propTypes<span style="color: #339933;">:</span> <span style="color: #009900;">&#123;</span>   count<span style="color: #339933;">:</span> React.<span style="color: #660066;">PropTypes</span>.<span style="color: #660066;">number</span>.<span style="color: #660066;">isRequired</span>   values<span style="color: #339933;">:</span> React.<span style="color: #660066;">PropTypes</span>.<span style="color: #660066;">shape</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#123;</span>     <span style="color: #3366CC;">'0'</span><span style="color: #339933;">:</span> React.<span style="color: #660066;">PropTypes</span>.<span style="color: #660066;">string</span><span style="color: #339933;">,</span>     <span style="color: #3366CC;">'1'</span><span style="color: #339933;">:</span> React.<span style="color: #660066;">PropTypes</span>.<span style="color: #660066;">string</span><span style="color: #339933;">,</span>     <span style="color: #3366CC;">'other'</span><span style="color: #339933;">:</span> React.<span style="color: #660066;">PropTypes</span>.<span style="color: #660066;">string</span>   <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">isRequired</span> <span style="color: #009900;">&#125;</span></pre> <p>Grâce à ce contrat d'interface, le développeur reçoit un message explicite dans sa console en cas de mauvaise utilisation du composant&nbsp;:</p> <blockquote><p>Required prop 'count' was not specified in 'Pluralize'.</p></blockquote> <p>Message qu'il ne verra même plus lorsque les IDE se baseront sur les propTypes pour fournir une puissante auto-complétion&nbsp;!</p> <h5>Une autre manière de coder</h5> <p>Depuis des années prévaut le principe de séparation des responsabilités entre la vue déclarative en HTML et la logique impérative en Javascript. AngularJS respecte ce principe puisque les templates sont en HTML (et encore, les templates ne sont pas logic-less).</p> <p>React prend le contre-pied en proposant une manière d'écrire du code déclaratif (type HTML) directement dans le retour de la méthode <code>render</code>. Le "langage" qui en résulte est le <a href="http://facebook.github.io/jsx/">JSX</a>. Il nécessite une compilation en Javascript pour être compréhensible par les moteurs d'exécution Javascript (navigateurs ou NodeJS). Voici une déclaration (simpliste) du composant Pluralize évoqué ci-dessus en JSX&nbsp;:</p> <pre class="javascript code javascript" style="font-family:inherit"><span style="color: #003366; font-weight: bold;">var</span> CommentBox <span style="color: #339933;">=</span> React.<span style="color: #660066;">createClass</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#123;</span> &nbsp;   propTypes<span style="color: #339933;">:</span> <span style="color: #009900;">&#123;</span>     count<span style="color: #339933;">:</span> React.<span style="color: #660066;">PropTypes</span>.<span style="color: #660066;">number</span>.<span style="color: #660066;">isRequired</span>     values<span style="color: #339933;">:</span> React.<span style="color: #660066;">PropTypes</span>.<span style="color: #660066;">shape</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#123;</span>       <span style="color: #3366CC;">'0'</span><span style="color: #339933;">:</span> React.<span style="color
: #660066;">PropTypes</span>.<span style="color: #660066;">string</span><span style="color: #339933;">,</span>       <span style="color: #3366CC;">'1'</span><span style="color: #339933;">:</span> React.<span style="color: #660066;">PropTypes</span>.<span style="color: #660066;">string</span><span style="color: #339933;">,</span>       <span style="color: #3366CC;">'other'</span><span style="color: #339933;">:</span> React.<span style="color: #660066;">PropTypes</span>.<span style="color: #660066;">string</span>     <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span>.<span style="color: #660066;">isRequired</span>   <span style="color: #009900;">&#125;</span><span style="color: #339933;">,</span> &nbsp;   render<span style="color: #339933;">:</span> <span style="color: #003366; font-weight: bold;">function</span><span style="color: #009900;">&#40;</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>     <span style="color: #003366; font-weight: bold;">var</span> value <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">props</span>.<span style="color: #660066;">values</span><span style="color: #009900;">&#91;</span><span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">props</span>.<span style="color: #660066;">count</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>     <span style="color: #000066; font-weight: bold;">if</span><span style="color: #009900;">&#40;</span><span style="color: #339933;">!</span>value<span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span>       value <span style="color: #339933;">=</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #660066;">props</span>.<span style="color: #660066;">values</span><span style="color: #009900;">&#91;</span><span style="color: #3366CC;">'other'</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>     <span style="color: #009900;">&#125;</span>     <span style="color: #006600; font-style: italic;">// Notez le retour en simili-HTML</span>     <span style="color: #000066; font-weight: bold;">return</span> <span style="color: #009900;">&#40;</span><span style="color: #339933;">&lt;</span>span<span style="color: #339933;">&gt;</span><span style="color: #009900;">&#123;</span>value<span style="color: #009900;">&#125;</span><span style="color: #339933;">&lt;/</span>span<span style="color: #339933;">&gt;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>   <span style="color: #009900;">&#125;</span> &nbsp; <span style="color: #009900;">&#125;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre> <p>C'est assez surprenant au premier abord mais ça devient naturel au fur et à mesure qu'on rentre dans la logique "Composant". C'est agréable de ne plus basculer sans cesse entre les 2 fichiers HTML et JS. Tellement agréable qu'il est finalement dommage que les styles ne suivent pas cette logique (le "CSSX" n'existe pas !).</p> <p>Les fichiers JSX peuvent rester clairs et concis grâce à l'utilisation de <a href="http://facebook.github.io/react/docs/reusable-components.html#mixins">mixins</a> et les tests se retrouvent facilités par cette unification (pas l'intégration HTML/CSS par contre !).</p> <h5>Avec quoi je fais ma SPA&nbsp;?</h5> <p>C'est vrai qu'un simple bibliothèque orientée Composant ne suffit pas à faire une application single-page. C'est pourquoi les créateurs de React poussent l'utilisation de <a href="http://facebook.github.io/flux/">Flux</a>, un design pattern alternatif au modèle MVC, privilégiant un workflow unidirectionnel plus adapté à une logique Composant.</p> <p>On entend souvent dire qu'il y a des grosses lacunes dans React comme l'absence de support des appels AJAX. Il est clair que la jeunesse de cette technologie se fait parfois ressentir et certaines librairies / outils n'ont pas le niveau de maturité de leur homologue AngularJS, comme le <a href="https://github.com/rackt/react-router">routeur</a> ou le <a href="http://facebook.github.io/jest/">lanceur de test</a>.</p> <p>Il faut savoir toutefois que React s'inscrit très bien dans une application découpée en module CommonJS et servie au navigateur via un bundle construit par <a href="http://browserify.org/">Browserify</a> ou <a href="http://webpack.github.io/">webpack</a>. Dans le cas du support AJAX, il est possible d'inclure des modules npm offrant une compatibilité navigateur tel que <a href="https://github.com/visionmedia/superagent">superagent</a> ou <a href="https://www.npmjs.com/package/http-browserify">http-browerify</a> pour bénéficier d'un support AJAX complet et mature.</p> <p>A l'inverse, React est capable d'effectuer le rendu d'un composant dans NodeJS. Cela signifie qu'une page de l'application peut être pré-rendue coté serveur et envoyée au navigateur avec le contenu. La page n'est plus une coquille vide mais contient réellement le contenu dans le code source, avec tous les bénéfices que cela peut avoir pour le SEO&nbsp;: c'est l'approche <a href="http://isomorphic.net/">isomorphique</a>.</p> <h5>Conclusion</h5> <p>React a de bons atouts pour trouver sa place dans les frameworks Web. En tant que développeur de composant AngularJS (<a href="https://github.com/ncuillery/angular-breadcrumb">angular-breadcrumb</a>), j'ai senti un vrai vent de fraîcheur en utilisant React. C'est une bibliothèque orientée Composant et là-dessus il tient ses promesses&nbsp;: puissant et plaisant à coder. Il peut être la base d'une vraie stack de développement d'application front.</p>